(function(){"use strict";var nn=Array.isArray,fi=Array.prototype.indexOf,Tr=Array.prototype.includes,an=Array.from,di=Object.defineProperty,ur=Object.getOwnPropertyDescriptor,ba=Object.getOwnPropertyDescriptors,vi=Object.prototype,_i=Array.prototype,jn=Object.getPrototypeOf,ya=Object.isExtensible;const pi=()=>{};function hi(e){return e()}function Dn(e){for(var t=0;t<e.length;t++)e[t]()}function wa(){var e,t,r=new Promise((a,s)=>{e=a,t=s});return{promise:r,resolve:e,reject:t}}const xe=2,jr=4,Dr=8,Sa=1<<24,Pt=16,dt=32,fr=64,zn=128,Ze=512,me=1024,Re=2048,Xe=4096,qe=8192,Ct=16384,dr=32768,$r=65536,xa=1<<17,ka=1<<18,Nr=1<<19,Ea=1<<20,At=1<<25,vr=65536,Jn=1<<21,Vn=1<<22,Wt=1<<23,It=Symbol("$state"),gi=Symbol("legacy props"),_r=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Bn(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function mi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function bi(e,t,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function yi(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function wi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Si(e){throw new Error("https://svelte.dev/e/effect_orphan")}function xi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ki(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ei(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ti(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function $i(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ni(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Ri=1,Pi=2,Ta=4,Ci=8,Ai=16,Ii=1,Mi=2,Li=4,Oi=8,Fi=16,ji=1,Di=2,ke=Symbol(),$a="http://www.w3.org/1999/xhtml";function zi(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Ji(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Na(e){return e===this.v}function Vi(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ra(e){return!Vi(e,this.v)}let Rr=!1,Tu=!1;function Bi(){Rr=!0}let oe=null;function Pr(e){oe=e}function Mt(e,t=!1,r){oe={p:oe,i:!1,c:null,e:null,s:e,x:null,l:Rr&&!t?{s:null,u:null,$:[]}:null}}function Lt(e){var t=oe,r=t.e;if(r!==null){t.e=null;for(var a of r)Za(a)}return e!==void 0&&(t.x=e),t.i=!0,oe=t.p,e??{}}function zr(){return!Rr||oe!==null&&oe.l===null}let pr=[];function Pa(){var e=pr;pr=[],Dn(e)}function Ot(e){if(pr.length===0&&!Jr){var t=pr;queueMicrotask(()=>{t===pr&&Pa()})}pr.push(e)}function qi(){for(;pr.length>0;)Pa()}function Ca(e){var t=te;if(t===null)return Y.f|=Wt,e;if((t.f&dr)===0&&(t.f&jr)===0)throw e;Gt(e,t)}function Gt(e,t){for(;t!==null;){if((t.f&zn)!==0){if((t.f&dr)===0)throw e;try{t.b.error(e);return}catch(r){e=r}}t=t.parent}throw e}const Ui=-7169;function le(e,t){e.f=e.f&Ui|t}function qn(e){(e.f&Ze)!==0||e.deps===null?le(e,me):le(e,Xe)}function Aa(e){if(e!==null)for(const t of e)(t.f&xe)===0||(t.f&vr)===0||(t.f^=vr,Aa(t.deps))}function Ia(e,t,r){(e.f&Re)!==0?t.add(e):(e.f&Xe)!==0&&r.add(e),Aa(e.deps),le(e,me)}const sn=new Set;let ee=null,on=null,vt=null,je=[],ln=null,Un=!1,Jr=!1;class Kt{current=new Map;previous=new Map;#t=new Set;#o=new Set;#e=0;#i=0;#n=null;#s=new Set;#r=new Set;#a=new Map;is_fork=!1;#l=!1;#u(){return this.is_fork||this.#i>0}skip_effect(t){this.#a.has(t)||this.#a.set(t,{d:[],m:[]})}unskip_effect(t){var r=this.#a.get(t);if(r){this.#a.delete(t);for(var a of r.d)le(a,Re),_t(a);for(a of r.m)le(a,Xe),_t(a)}}process(t){je=[],this.apply();var r=[],a=[];for(const s of t)this.#c(s,r,a);if(this.#u()){this.#f(a),this.#f(r);for(const[s,i]of this.#a)ja(s,i)}else{for(const s of this.#t)s();this.#t.clear(),this.#e===0&&this.#v(),on=this,ee=null,La(a),La(r),this.#s.clear(),this.#r.clear(),on=null,this.#n?.resolve()}vt=null}#c(t,r,a){t.f^=me;for(var s=t.first;s!==null;){var i=s.f,f=(i&(dt|fr))!==0,l=f&&(i&me)!==0,c=l||(i&qe)!==0||this.#a.has(s);if(!c&&s.fn!==null){f?s.f^=me:(i&jr)!==0?r.push(s):Mr(s)&&((i&Pt)!==0&&this.#r.add(s),yr(s));var v=s.first;if(v!==null){s=v;continue}}for(;s!==null;){var h=s.next;if(h!==null){s=h;break}s=s.parent}}}#f(t){for(var r=0;r<t.length;r+=1)Ia(t[r],this.#s,this.#r)}capture(t,r){r!==ke&&!this.previous.has(t)&&this.previous.set(t,r),(t.f&Wt)===0&&(this.current.set(t,t.v),vt?.set(t,t.v))}activate(){ee=this,this.apply()}deactivate(){ee===this&&(ee=null,vt=null)}flush(){if(this.activate(),je.length>0){if(Ma(),ee!==null&&ee!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#o)t(this);this.#o.clear()}#v(){if(sn.size>1){this.previous.clear();var t=vt,r=!0;for(const s of sn){if(s===this){r=!1;continue}const i=[];for(const[l,c]of this.current){if(s.current.has(l))if(r&&c!==s.current.get(l))s.current.set(l,c);else continue;i.push(l)}if(i.length===0)continue;const f=[...s.current.keys()].filter(l=>!this.current.has(l));if(f.length>0){var a=je;je=[];const l=new Set,c=new Map;for(const v of i)Oa(v,f,l,c);if(je.length>0){ee=s,s.apply();for(const v of je)s.#c(v,[],[]);s.deactivate()}je=a}}ee=null,vt=t}this.#a.clear(),sn.delete(this)}increment(t){this.#e+=1,t&&(this.#i+=1)}decrement(t){this.#e-=1,t&&(this.#i-=1),!this.#l&&(this.#l=!0,Ot(()=>{this.#l=!1,this.#u()?je.length>0&&this.flush():this.revive()}))}revive(){for(const t of this.#s)this.#r.delete(t),le(t,Re),_t(t);for(const t of this.#r)le(t,Xe),_t(t);this.flush()}oncommit(t){this.#t.add(t)}ondiscard(t){this.#o.add(t)}settled(){return(this.#n??=wa()).promise}static ensure(){if(ee===null){const t=ee=new Kt;sn.add(ee),Jr||Ot(()=>{ee===t&&t.flush()})}return ee}apply(){}}function Hi(e){var t=Jr;Jr=!0;try{for(var r;;){if(qi(),je.length===0&&(ee?.flush(),je.length===0))return ln=null,r;Ma()}}finally{Jr=t}}function Ma(){Un=!0;var e=null;try{for(var t=0;je.length>0;){var r=Kt.ensure();if(t++>1e3){var a,s;Wi()}r.process(je),Qt.clear()}}finally{je=[],Un=!1,ln=null}}function Wi(){try{xi()}catch(e){Gt(e,ln)}}let Ft=null;function La(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var a=e[r++];if((a.f&(Ct|qe))===0&&Mr(a)&&(Ft=new Set,yr(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&ts(a),Ft?.size>0)){Qt.clear();for(const s of Ft){if((s.f&(Ct|qe))!==0)continue;const i=[s];let f=s.parent;for(;f!==null;)Ft.has(f)&&(Ft.delete(f),i.push(f)),f=f.parent;for(let l=i.length-1;l>=0;l--){const c=i[l];(c.f&(Ct|qe))===0&&yr(c)}}Ft.clear()}}Ft=null}}function Oa(e,t,r,a){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const s of e.reactions){const i=s.f;(i&xe)!==0?Oa(s,t,r,a):(i&(Vn|Pt))!==0&&(i&Re)===0&&Fa(s,t,a)&&(le(s,Re),_t(s))}}function Fa(e,t,r){const a=r.get(e);if(a!==void 0)return a;if(e.deps!==null)for(const s of e.deps){if(Tr.call(t,s))return!0;if((s.f&xe)!==0&&Fa(s,t,r))return r.set(s,!0),!0}return r.set(e,!1),!1}function _t(e){var t=ln=e,r=t.b;if(r?.is_pending&&(e.f&(jr|Dr|Sa))!==0&&(e.f&dr)===0){r.defer_effect(e);return}for(;t.parent!==null;){t=t.parent;var a=t.f;if(Un&&t===te&&(a&Pt)!==0&&(a&ka)===0&&(a&dr)!==0)return;if((a&(fr|dt))!==0){if((a&me)===0)return;t.f^=me}}je.push(t)}function ja(e,t){if(!((e.f&dt)!==0&&(e.f&me)!==0)){(e.f&Re)!==0?t.d.push(e):(e.f&Xe)!==0&&t.m.push(e),le(e,me);for(var r=e.first;r!==null;)ja(r,t),r=r.next}}function Gi(e){let t=0,r=hr(0),a;return()=>{Kn()&&(n(r),qr(()=>(t===0&&(a=y(()=>e(()=>Vr(r)))),t+=1,()=>{Ot(()=>{t-=1,t===0&&(a?.(),a=void 0,Vr(r))})})))}}var Ki=$r|Nr;function Qi(e,t,r,a){new Yi(e,t,r,a)}class Yi{parent;is_pending=!1;transform_error;#t;#o=null;#e;#i;#n;#s=null;#r=null;#a=null;#l=null;#u=0;#c=0;#f=!1;#v=new Set;#_=new Set;#d=null;#b=Gi(()=>(this.#d=hr(this.#u),()=>{this.#d=null}));constructor(t,r,a,s){this.#t=t,this.#e=r,this.#i=i=>{var f=te;f.b=this,f.f|=zn,a(i)},this.parent=te.b,this.transform_error=s??this.parent?.transform_error??(i=>i),this.#n=Yn(()=>{this.#g()},Ki)}#y(){try{this.#s=et(()=>this.#i(this.#t))}catch(t){this.error(t)}}#w(t){const r=this.#e.failed;r&&(this.#a=et(()=>{r(this.#t,()=>t,()=>()=>{})}))}#S(){const t=this.#e.pending;t&&(this.is_pending=!0,this.#r=et(()=>t(this.#t)),Ot(()=>{var r=this.#l=document.createDocumentFragment(),a=jt();r.append(a),this.#s=this.#h(()=>(Kt.ensure(),et(()=>this.#i(a)))),this.#c===0&&(this.#t.before(r),this.#l=null,gr(this.#r,()=>{this.#r=null}),this.#p())}))}#g(){try{if(this.is_pending=this.has_pending_snippet(),this.#c=0,this.#u=0,this.#s=et(()=>{this.#i(this.#t)}),this.#c>0){var t=this.#l=document.createDocumentFragment();as(this.#s,t);const r=this.#e.pending;this.#r=et(()=>r(this.#t))}else this.#p()}catch(r){this.error(r)}}#p(){this.is_pending=!1;for(const t of this.#v)le(t,Re),_t(t);for(const t of this.#_)le(t,Xe),_t(t);this.#v.clear(),this.#_.clear()}defer_effect(t){Ia(t,this.#v,this.#_)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#h(t){var r=te,a=Y,s=oe;xt(this.#n),tt(this.#n),Pr(this.#n.ctx);try{return t()}catch(i){return Ca(i),null}finally{xt(r),tt(a),Pr(s)}}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#c+=t,this.#c===0&&(this.#p(),this.#r&&gr(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null))}update_pending_count(t){this.#m(t),this.#u+=t,!(!this.#d||this.#f)&&(this.#f=!0,Ot(()=>{this.#f=!1,this.#d&&Cr(this.#d,this.#u)}))}get_effect_pending(){return this.#b(),n(this.#d)}error(t){var r=this.#e.onerror;let a=this.#e.failed;if(!r&&!a)throw t;this.#s&&(ze(this.#s),this.#s=null),this.#r&&(ze(this.#r),this.#r=null),this.#a&&(ze(this.#a),this.#a=null);var s=!1,i=!1;const f=()=>{if(s){Ji();return}s=!0,i&&Ni(),this.#a!==null&&gr(this.#a,()=>{this.#a=null}),this.#h(()=>{Kt.ensure(),this.#g()})},l=c=>{try{i=!0,r?.(c,f),i=!1}catch(v){Gt(v,this.#n&&this.#n.parent)}a&&(this.#a=this.#h(()=>{Kt.ensure();try{return et(()=>{var v=te;v.b=this,v.f|=zn,a(this.#t,()=>c,()=>f)})}catch(v){return Gt(v,this.#n.parent),null}}))};Ot(()=>{var c;try{c=this.transform_error(t)}catch(v){Gt(v,this.#n&&this.#n.parent);return}c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(l,v=>Gt(v,this.#n&&this.#n.parent)):l(c)})}}function Zi(e,t,r,a){const s=zr()?cn:De;var i=e.filter(w=>!w.settled);if(r.length===0&&i.length===0){a(t.map(s));return}var f=te,l=Xi(),c=i.length===1?i[0].promise:i.length>1?Promise.all(i.map(w=>w.promise)):null;function v(w){l();try{a(w)}catch(g){(f.f&Ct)===0&&Gt(g,f)}Hn()}if(r.length===0){c.then(()=>v(t.map(s)));return}function h(){l(),Promise.all(r.map(w=>to(w))).then(w=>v([...t.map(s),...w])).catch(w=>Gt(w,f))}c?c.then(h):h()}function Xi(){var e=te,t=Y,r=oe,a=ee;return function(i=!0){xt(e),tt(t),Pr(r),i&&a?.activate()}}function Hn(e=!0){xt(null),tt(null),Pr(null),e&&ee?.deactivate()}function eo(){var e=te.b,t=ee,r=e.is_rendered();return e.update_pending_count(1),t.increment(r),()=>{e.update_pending_count(-1),t.decrement(r)}}function cn(e){var t=xe|Re,r=Y!==null&&(Y.f&xe)!==0?Y:null;return te!==null&&(te.f|=Nr),{ctx:oe,deps:null,effects:null,equals:Na,f:t,fn:e,reactions:null,rv:0,v:ke,wv:0,parent:r??te,ac:null}}function to(e,t,r){te===null&&mi();var s=void 0,i=hr(ke),f=!Y,l=new Map;return po(()=>{var c=wa();s=c.promise;try{Promise.resolve(e()).then(c.resolve,c.reject).finally(Hn)}catch(g){c.reject(g),Hn()}var v=ee;if(f){var h=eo();l.get(v)?.reject(_r),l.delete(v),l.set(v,c)}const w=(g,k=void 0)=>{if(v.activate(),k)k!==_r&&(i.f|=Wt,Cr(i,k));else{(i.f&Wt)!==0&&(i.f^=Wt),Cr(i,g);for(const[S,R]of l){if(l.delete(S),S===v)break;R.reject(_r)}}h&&h()};c.promise.then(w,g=>w(null,g||"unknown"))}),dn(()=>{for(const c of l.values())c.reject(_r)}),new Promise(c=>{function v(h){function w(){h===s?c(i):v(s)}h.then(w,w)}v(s)})}function De(e){const t=cn(e);return t.equals=Ra,t}function ro(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)ze(t[r])}}function no(e){for(var t=e.parent;t!==null;){if((t.f&xe)===0)return(t.f&Ct)===0?t:null;t=t.parent}return null}function Wn(e){var t,r=te;xt(no(e));try{e.f&=~vr,ro(e),t=us(e)}finally{xt(r)}return t}function Da(e){var t=Wn(e);if(!e.equals(t)&&(e.wv=ls(),(!ee?.is_fork||e.deps===null)&&(e.v=t,e.deps===null))){le(e,me);return}Zt||(vt!==null?(Kn()||ee?.is_fork)&&vt.set(e,t):qn(e))}function ao(e){if(e.effects!==null)for(const t of e.effects)(t.teardown||t.ac)&&(t.teardown?.(),t.ac?.abort(_r),t.teardown=pi,t.ac=null,Ur(t,0),Zn(t))}function za(e){if(e.effects!==null)for(const t of e.effects)t.teardown&&yr(t)}let Gn=new Set;const Qt=new Map;let Ja=!1;function hr(e,t){var r={f:0,v:e,reactions:null,equals:Na,rv:0,wv:0};return r}function Yt(e,t){const r=hr(e);return mo(r),r}function N(e,t=!1,r=!0){const a=hr(e);return t||(a.equals=Ra),Rr&&r&&oe!==null&&oe.l!==null&&(oe.l.s??=[]).push(a),a}function yt(e,t){return u(e,y(()=>n(e))),t}function u(e,t,r=!1){Y!==null&&(!pt||(Y.f&xa)!==0)&&zr()&&(Y.f&(xe|Pt|Vn|xa))!==0&&(rt===null||!Tr.call(rt,e))&&$i();let a=r?Ar(t):t;return Cr(e,a)}function Cr(e,t){if(!e.equals(t)){var r=e.v;Zt?Qt.set(e,t):Qt.set(e,r),e.v=t;var a=Kt.ensure();if(a.capture(e,r),(e.f&xe)!==0){const s=e;(e.f&Re)!==0&&Wn(s),qn(s)}e.wv=ls(),Va(e,Re),zr()&&te!==null&&(te.f&me)!==0&&(te.f&(dt|fr))===0&&(nt===null?bo([e]):nt.push(e)),!a.is_fork&&Gn.size>0&&!Ja&&so()}return t}function so(){Ja=!1;for(const e of Gn)(e.f&me)!==0&&le(e,Xe),Mr(e)&&yr(e);Gn.clear()}function Vr(e){u(e,e.v+1)}function Va(e,t){var r=e.reactions;if(r!==null)for(var a=zr(),s=r.length,i=0;i<s;i++){var f=r[i],l=f.f;if(!(!a&&f===te)){var c=(l&Re)===0;if(c&&le(f,t),(l&xe)!==0){var v=f;vt?.delete(v),(l&vr)===0&&(l&Ze&&(f.f|=vr),Va(v,Xe))}else c&&((l&Pt)!==0&&Ft!==null&&Ft.add(f),_t(f))}}}function Ar(e){if(typeof e!="object"||e===null||It in e)return e;const t=jn(e);if(t!==vi&&t!==_i)return e;var r=new Map,a=nn(e),s=Yt(0),i=br,f=l=>{if(br===i)return l();var c=Y,v=br;tt(null),os(i);var h=l();return tt(c),os(v),h};return a&&r.set("length",Yt(e.length)),new Proxy(e,{defineProperty(l,c,v){(!("value"in v)||v.configurable===!1||v.enumerable===!1||v.writable===!1)&&Ei();var h=r.get(c);return h===void 0?f(()=>{var w=Yt(v.value);return r.set(c,w),w}):u(h,v.value,!0),!0},deleteProperty(l,c){var v=r.get(c);if(v===void 0){if(c in l){const h=f(()=>Yt(ke));r.set(c,h),Vr(s)}}else u(v,ke),Vr(s);return!0},get(l,c,v){if(c===It)return e;var h=r.get(c),w=c in l;if(h===void 0&&(!w||ur(l,c)?.writable)&&(h=f(()=>{var k=Ar(w?l[c]:ke),S=Yt(k);return S}),r.set(c,h)),h!==void 0){var g=n(h);return g===ke?void 0:g}return Reflect.get(l,c,v)},getOwnPropertyDescriptor(l,c){var v=Reflect.getOwnPropertyDescriptor(l,c);if(v&&"value"in v){var h=r.get(c);h&&(v.value=n(h))}else if(v===void 0){var w=r.get(c),g=w?.v;if(w!==void 0&&g!==ke)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return v},has(l,c){if(c===It)return!0;var v=r.get(c),h=v!==void 0&&v.v!==ke||Reflect.has(l,c);if(v!==void 0||te!==null&&(!h||ur(l,c)?.writable)){v===void 0&&(v=f(()=>{var g=h?Ar(l[c]):ke,k=Yt(g);return k}),r.set(c,v));var w=n(v);if(w===ke)return!1}return h},set(l,c,v,h){var w=r.get(c),g=c in l;if(a&&c==="length")for(var k=v;k<w.v;k+=1){var S=r.get(k+"");S!==void 0?u(S,ke):k in l&&(S=f(()=>Yt(ke)),r.set(k+"",S))}if(w===void 0)(!g||ur(l,c)?.writable)&&(w=f(()=>Yt(void 0)),u(w,Ar(v)),r.set(c,w));else{g=w.v!==ke;var R=f(()=>Ar(v));u(w,R)}var b=Reflect.getOwnPropertyDescriptor(l,c);if(b?.set&&b.set.call(h,v),!g){if(a&&typeof c=="string"){var T=r.get("length"),U=Number(c);Number.isInteger(U)&&U>=T.v&&u(T,U+1)}Vr(s)}return!0},ownKeys(l){n(s);var c=Reflect.ownKeys(l).filter(w=>{var g=r.get(w);return g===void 0||g.v!==ke});for(var[v,h]of r)h.v!==ke&&!(v in l)&&c.push(v);return c},setPrototypeOf(){Ti()}})}function Ba(e){try{if(e!==null&&typeof e=="object"&&It in e)return e[It]}catch{}return e}function io(e,t){return Object.is(Ba(e),Ba(t))}var qa,Ua,Ha,Wa;function oo(){if(qa===void 0){qa=window,Ua=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;Ha=ur(t,"firstChild").get,Wa=ur(t,"nextSibling").get,ya(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),ya(r)&&(r.__t=void 0)}}function jt(e=""){return document.createTextNode(e)}function un(e){return Ha.call(e)}function Br(e){return Wa.call(e)}function d(e,t){return un(e)}function Ue(e,t=!1){{var r=un(e);return r instanceof Comment&&r.data===""?Br(r):r}}function p(e,t=1,r=!1){let a=e;for(;t--;)a=Br(a);return a}function lo(e){e.textContent=""}function Ga(){return!1}function co(e,t,r){return document.createElementNS($a,e,void 0)}let Ka=!1;function uo(){Ka||(Ka=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function fn(e){var t=Y,r=te;tt(null),xt(null);try{return e()}finally{tt(t),xt(r)}}function Qa(e,t,r,a=r){e.addEventListener(t,()=>fn(r));const s=e.__on_r;s?e.__on_r=()=>{s(),a(!0)}:e.__on_r=()=>a(!0),uo()}function Ya(e){te===null&&(Y===null&&Si(),wi()),Zt&&yi()}function fo(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function wt(e,t,r){var a=te;a!==null&&(a.f&qe)!==0&&(e|=qe);var s={ctx:oe,deps:null,nodes:null,f:e|Re|Ze,first:null,fn:t,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{yr(s)}catch(l){throw ze(s),l}else t!==null&&_t(s);var i=s;if(r&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&Nr)===0&&(i=i.first,(e&Pt)!==0&&(e&$r)!==0&&i!==null&&(i.f|=$r)),i!==null&&(i.parent=a,a!==null&&fo(i,a),Y!==null&&(Y.f&xe)!==0&&(e&fr)===0)){var f=Y;(f.effects??=[]).push(i)}return s}function Kn(){return Y!==null&&!pt}function dn(e){const t=wt(Dr,null,!1);return le(t,me),t.teardown=e,t}function Qn(e){Ya();var t=te.f,r=!Y&&(t&dt)!==0&&(t&dr)===0;if(r){var a=oe;(a.e??=[]).push(e)}else return Za(e)}function Za(e){return wt(jr|Ea,e,!1)}function vo(e){return Ya(),wt(Dr|Ea,e,!0)}function _o(e){Kt.ensure();const t=wt(fr|Nr,e,!0);return(r={})=>new Promise(a=>{r.outro?gr(t,()=>{ze(t),a(void 0)}):(ze(t),a(void 0))})}function Xa(e){return wt(jr,e,!1)}function St(e,t){var r=oe,a={effect:null,ran:!1,deps:e};r.l.$.push(a),a.effect=qr(()=>{e(),!a.ran&&(a.ran=!0,y(t))})}function Ir(){var e=oe;qr(()=>{for(var t of e.l.$){t.deps();var r=t.effect;(r.f&me)!==0&&r.deps!==null&&le(r,Xe),Mr(r)&&yr(r),t.ran=!1}})}function po(e){return wt(Vn|Nr,e,!0)}function qr(e,t=0){return wt(Dr|t,e,!0)}function Q(e,t=[],r=[],a=[]){Zi(a,t,r,s=>{wt(Dr,()=>e(...s.map(n)),!0)})}function Yn(e,t=0){var r=wt(Pt|t,e,!0);return r}function et(e){return wt(dt|Nr,e,!0)}function es(e){var t=e.teardown;if(t!==null){const r=Zt,a=Y;ss(!0),tt(null);try{t.call(null)}finally{ss(r),tt(a)}}}function Zn(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const s=r.ac;s!==null&&fn(()=>{s.abort(_r)});var a=r.next;(r.f&fr)!==0?r.parent=null:ze(r,t),r=a}}function ho(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&dt)===0&&ze(t),t=r}}function ze(e,t=!0){var r=!1;(t||(e.f&ka)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(go(e.nodes.start,e.nodes.end),r=!0),Zn(e,t&&!r),Ur(e,0),le(e,Ct);var a=e.nodes&&e.nodes.t;if(a!==null)for(const i of a)i.stop();es(e);var s=e.parent;s!==null&&s.first!==null&&ts(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function go(e,t){for(;e!==null;){var r=e===t?null:Br(e);e.remove(),e=r}}function ts(e){var t=e.parent,r=e.prev,a=e.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),t!==null&&(t.first===e&&(t.first=a),t.last===e&&(t.last=r))}function gr(e,t,r=!0){var a=[];rs(e,a,!0);var s=()=>{r&&ze(e),t&&t()},i=a.length;if(i>0){var f=()=>--i||s();for(var l of a)l.out(f)}else s()}function rs(e,t,r){if((e.f&qe)===0){e.f^=qe;var a=e.nodes&&e.nodes.t;if(a!==null)for(const l of a)(l.is_global||r)&&t.push(l);for(var s=e.first;s!==null;){var i=s.next,f=(s.f&$r)!==0||(s.f&dt)!==0&&(e.f&Pt)!==0;rs(s,t,f?r:!1),s=i}}}function Xn(e){ns(e,!0)}function ns(e,t){if((e.f&qe)!==0){e.f^=qe,(e.f&me)===0&&(le(e,Re),_t(e));for(var r=e.first;r!==null;){var a=r.next,s=(r.f&$r)!==0||(r.f&dt)!==0;ns(r,s?t:!1),r=a}var i=e.nodes&&e.nodes.t;if(i!==null)for(const f of i)(f.is_global||t)&&f.in()}}function as(e,t){if(e.nodes)for(var r=e.nodes.start,a=e.nodes.end;r!==null;){var s=r===a?null:Br(r);t.append(r),r=s}}let vn=!1,Zt=!1;function ss(e){Zt=e}let Y=null,pt=!1;function tt(e){Y=e}let te=null;function xt(e){te=e}let rt=null;function mo(e){Y!==null&&(rt===null?rt=[e]:rt.push(e))}let Je=null,He=0,nt=null;function bo(e){nt=e}let is=1,mr=0,br=mr;function os(e){br=e}function ls(){return++is}function Mr(e){var t=e.f;if((t&Re)!==0)return!0;if(t&xe&&(e.f&=~vr),(t&Xe)!==0){for(var r=e.deps,a=r.length,s=0;s<a;s++){var i=r[s];if(Mr(i)&&Da(i),i.wv>e.wv)return!0}(t&Ze)!==0&&vt===null&&le(e,me)}return!1}function cs(e,t,r=!0){var a=e.reactions;if(a!==null&&!(rt!==null&&Tr.call(rt,e)))for(var s=0;s<a.length;s++){var i=a[s];(i.f&xe)!==0?cs(i,t,!1):t===i&&(r?le(i,Re):(i.f&me)!==0&&le(i,Xe),_t(i))}}function us(e){var t=Je,r=He,a=nt,s=Y,i=rt,f=oe,l=pt,c=br,v=e.f;Je=null,He=0,nt=null,Y=(v&(dt|fr))===0?e:null,rt=null,Pr(e.ctx),pt=!1,br=++mr,e.ac!==null&&(fn(()=>{e.ac.abort(_r)}),e.ac=null);try{e.f|=Jn;var h=e.fn,w=h();e.f|=dr;var g=e.deps,k=ee?.is_fork;if(Je!==null){var S;if(k||Ur(e,He),g!==null&&He>0)for(g.length=He+Je.length,S=0;S<Je.length;S++)g[He+S]=Je[S];else e.deps=g=Je;if(Kn()&&(e.f&Ze)!==0)for(S=He;S<g.length;S++)(g[S].reactions??=[]).push(e)}else!k&&g!==null&&He<g.length&&(Ur(e,He),g.length=He);if(zr()&&nt!==null&&!pt&&g!==null&&(e.f&(xe|Xe|Re))===0)for(S=0;S<nt.length;S++)cs(nt[S],e);if(s!==null&&s!==e){if(mr++,s.deps!==null)for(let R=0;R<r;R+=1)s.deps[R].rv=mr;if(t!==null)for(const R of t)R.rv=mr;nt!==null&&(a===null?a=nt:a.push(...nt))}return(e.f&Wt)!==0&&(e.f^=Wt),w}catch(R){return Ca(R)}finally{e.f^=Jn,Je=t,He=r,nt=a,Y=s,rt=i,Pr(f),pt=l,br=c}}function yo(e,t){let r=t.reactions;if(r!==null){var a=fi.call(r,e);if(a!==-1){var s=r.length-1;s===0?r=t.reactions=null:(r[a]=r[s],r.pop())}}if(r===null&&(t.f&xe)!==0&&(Je===null||!Tr.call(Je,t))){var i=t;(i.f&Ze)!==0&&(i.f^=Ze,i.f&=~vr),qn(i),ao(i),Ur(i,0)}}function Ur(e,t){var r=e.deps;if(r!==null)for(var a=t;a<r.length;a++)yo(e,r[a])}function yr(e){var t=e.f;if((t&Ct)===0){le(e,me);var r=te,a=vn;te=e,vn=!0;try{(t&(Pt|Sa))!==0?ho(e):Zn(e),es(e);var s=us(e);e.teardown=typeof s=="function"?s:null,e.wv=is;var i}finally{vn=a,te=r}}}async function wo(){await Promise.resolve(),Hi()}function n(e){var t=e.f,r=(t&xe)!==0;if(Y!==null&&!pt){var a=te!==null&&(te.f&Ct)!==0;if(!a&&(rt===null||!Tr.call(rt,e))){var s=Y.deps;if((Y.f&Jn)!==0)e.rv<mr&&(e.rv=mr,Je===null&&s!==null&&s[He]===e?He++:Je===null?Je=[e]:Je.push(e));else{(Y.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[Y]:Tr.call(i,Y)||i.push(Y)}}}if(Zt&&Qt.has(e))return Qt.get(e);if(r){var f=e;if(Zt){var l=f.v;return((f.f&me)===0&&f.reactions!==null||ds(f))&&(l=Wn(f)),Qt.set(f,l),l}var c=(f.f&Ze)===0&&!pt&&Y!==null&&(vn||(Y.f&Ze)!==0),v=(f.f&dr)===0;Mr(f)&&(c&&(f.f|=Ze),Da(f)),c&&!v&&(za(f),fs(f))}if(vt?.has(e))return vt.get(e);if((e.f&Wt)!==0)throw e.v;return e.v}function fs(e){if(e.f|=Ze,e.deps!==null)for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&xe)!==0&&(t.f&Ze)===0&&(za(t),fs(t))}function ds(e){if(e.v===ke)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Qt.has(t)||(t.f&xe)!==0&&ds(t))return!0;return!1}function y(e){var t=pt;try{return pt=!0,e()}finally{pt=t}}function re(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(It in e)ea(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&It in r&&ea(r)}}}function ea(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let a in e)try{ea(e[a],t)}catch{}const r=jn(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const a=ba(r);for(let s in a){const i=a[s].get;if(i)try{i.call(e)}catch{}}}}}const So=["touchstart","touchmove"];function xo(e){return So.includes(e)}const _n=Symbol("events"),ko=new Set,vs=new Set;function Eo(e,t,r,a={}){function s(i){if(a.capture||ta.call(t,i),!i.cancelBubble)return fn(()=>r?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Ot(()=>{t.addEventListener(e,s,a)}):t.addEventListener(e,s,a),s}function se(e,t,r,a,s){var i={capture:a,passive:s},f=Eo(e,t,r,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&dn(()=>{t.removeEventListener(e,f,i)})}let _s=null;function ta(e){var t=this,r=t.ownerDocument,a=e.type,s=e.composedPath?.()||[],i=s[0]||e.target;_s=e;var f=0,l=_s===e&&e[_n];if(l){var c=s.indexOf(l);if(c!==-1&&(t===document||t===window)){e[_n]=t;return}var v=s.indexOf(t);if(v===-1)return;c<=v&&(f=c)}if(i=s[f]||e.target,i!==t){di(e,"currentTarget",{configurable:!0,get(){return i||r}});var h=Y,w=te;tt(null),xt(null);try{for(var g,k=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var R=i[_n]?.[a];R!=null&&(!i.disabled||e.target===i)&&R.call(i,e)}catch(b){g?k.push(b):g=b}if(e.cancelBubble||S===t||S===null)break;i=S}if(g){for(let b of k)queueMicrotask(()=>{throw b});throw g}}finally{e[_n]=t,delete e.currentTarget,tt(h),xt(w)}}}const To=globalThis?.window?.trustedTypes&&globalThis.window.trustedTypes.createPolicy("svelte-trusted-html",{createHTML:e=>e});function $o(e){return To?.createHTML(e)??e}function No(e){var t=co("template");return t.innerHTML=$o(e.replaceAll("<!>","<!---->")),t.content}function pn(e,t){var r=te;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function V(e,t){var r=(t&ji)!==0,a=(t&Di)!==0,s,i=!e.startsWith("<!>");return()=>{s===void 0&&(s=No(i?e:"<!>"+e),r||(s=un(s)));var f=a||Ua?document.importNode(s,!0):s.cloneNode(!0);if(r){var l=un(f),c=f.lastChild;pn(l,c)}else pn(f,f);return f}}function Ro(e=""){{var t=jt(e+"");return pn(t,t),t}}function at(){var e=document.createDocumentFragment(),t=document.createComment(""),r=jt();return e.append(t,r),pn(t,r),e}function A(e,t){e!==null&&e.before(t)}function E(e,t){var r=t==null?"":typeof t=="object"?`${t}`:t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=`${r}`)}function Po(e,t){return Co(e,t)}const hn=new Map;function Co(e,{target:t,anchor:r,props:a={},events:s,context:i,intro:f=!0,transformError:l}){oo();var c=void 0,v=_o(()=>{var h=r??t.appendChild(jt());Qi(h,{pending:()=>{}},k=>{Mt({});var S=oe;i&&(S.c=i),s&&(a.$$events=s),c=e(k,a)||{},Lt()},l);var w=new Set,g=k=>{for(var S=0;S<k.length;S++){var R=k[S];if(!w.has(R)){w.add(R);var b=xo(R);for(const C of[t,document]){var T=hn.get(C);T===void 0&&(T=new Map,hn.set(C,T));var U=T.get(R);U===void 0?(C.addEventListener(R,ta,{passive:b}),T.set(R,1)):T.set(R,U+1)}}}};return g(an(ko)),vs.add(g),()=>{for(var k of w)for(const b of[t,document]){var S=hn.get(b),R=S.get(k);--R==0?(b.removeEventListener(k,ta),S.delete(k),S.size===0&&hn.delete(b)):S.set(k,R)}vs.delete(g),h!==r&&h.parentNode?.removeChild(h)}});return Ao.set(c,v),c}let Ao=new WeakMap;class Io{anchor;#t=new Map;#o=new Map;#e=new Map;#i=new Set;#n=!0;constructor(t,r=!0){this.anchor=t,this.#n=r}#s=()=>{var t=ee;if(this.#t.has(t)){var r=this.#t.get(t),a=this.#o.get(r);if(a)Xn(a),this.#i.delete(r);else{var s=this.#e.get(r);s&&(this.#o.set(r,s.effect),this.#e.delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),a=s.effect)}for(const[i,f]of this.#t){if(this.#t.delete(i),i===t)break;const l=this.#e.get(f);l&&(ze(l.effect),this.#e.delete(f))}for(const[i,f]of this.#o){if(i===r||this.#i.has(i))continue;const l=()=>{if(Array.from(this.#t.values()).includes(i)){var v=document.createDocumentFragment();as(f,v),v.append(jt()),this.#e.set(i,{effect:f,fragment:v})}else ze(f);this.#i.delete(i),this.#o.delete(i)};this.#n||!a?(this.#i.add(i),gr(f,l,!1)):l()}}};#r=t=>{this.#t.delete(t);const r=Array.from(this.#t.values());for(const[a,s]of this.#e)r.includes(a)||(ze(s.effect),this.#e.delete(a))};ensure(t,r){var a=ee,s=Ga();if(r&&!this.#o.has(t)&&!this.#e.has(t))if(s){var i=document.createDocumentFragment(),f=jt();i.append(f),this.#e.set(t,{effect:et(()=>r(f)),fragment:i})}else this.#o.set(t,et(()=>r(this.anchor)));if(this.#t.set(a,t),s){for(const[l,c]of this.#o)l===t?a.unskip_effect(c):a.skip_effect(c);for(const[l,c]of this.#e)l===t?a.unskip_effect(c.effect):a.skip_effect(c.effect);a.oncommit(this.#s),a.ondiscard(this.#r)}else this.#s()}}function ce(e,t,r=!1){var a=new Io(e),s=r?$r:0;function i(f,l){a.ensure(f,l)}Yn(()=>{var f=!1;t((l,c=0)=>{f=!0,i(c,l)}),f||i(!1,null)},s)}function st(e,t){return t}function Mo(e,t,r){for(var a=[],s=t.length,i,f=t.length,l=0;l<s;l++){let w=t[l];gr(w,()=>{if(i){if(i.pending.delete(w),i.done.add(w),i.pending.size===0){var g=e.outrogroups;ra(an(i.done)),g.delete(i),g.size===0&&(e.outrogroups=null)}}else f-=1},!1)}if(f===0){var c=a.length===0&&r!==null;if(c){var v=r,h=v.parentNode;lo(h),h.append(v),e.items.clear()}ra(t,!c)}else i={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(i)}function ra(e,t=!0){for(var r=0;r<e.length;r++)ze(e[r],t)}var ps;function it(e,t,r,a,s,i=null){var f=e,l=new Map,c=(t&Ta)!==0;if(c){var v=e;f=v.appendChild(jt())}var h=null,w=De(()=>{var T=r();return nn(T)?T:T==null?[]:an(T)}),g,k=!0;function S(){b.fallback=h,Lo(b,g,f,t,a),h!==null&&(g.length===0?(h.f&At)===0?Xn(h):(h.f^=At,Wr(h,null,f)):gr(h,()=>{h=null}))}var R=Yn(()=>{g=n(w);for(var T=g.length,U=new Set,C=ee,O=Ga(),z=0;z<T;z+=1){var M=g[z],B=a(M,z),F=k?null:l.get(B);F?(F.v&&Cr(F.v,M),F.i&&Cr(F.i,z),O&&C.unskip_effect(F.e)):(F=Oo(l,k?f:ps??=jt(),M,B,z,s,t,r),k||(F.e.f|=At),l.set(B,F)),U.add(B)}if(T===0&&i&&!h&&(k?h=et(()=>i(f)):(h=et(()=>i(ps??=jt())),h.f|=At)),T>U.size&&bi(),!k)if(O){for(const[ie,H]of l)U.has(ie)||C.skip_effect(H.e);C.oncommit(S),C.ondiscard(()=>{})}else S();n(w)}),b={effect:R,items:l,outrogroups:null,fallback:h};k=!1}function Hr(e){for(;e!==null&&(e.f&dt)===0;)e=e.next;return e}function Lo(e,t,r,a,s){var i=(a&Ci)!==0,f=t.length,l=e.items,c=Hr(e.effect.first),v,h=null,w,g=[],k=[],S,R,b,T;if(i)for(T=0;T<f;T+=1)S=t[T],R=s(S,T),b=l.get(R).e,(b.f&At)===0&&(b.nodes?.a?.measure(),(w??=new Set).add(b));for(T=0;T<f;T+=1){if(S=t[T],R=s(S,T),b=l.get(R).e,e.outrogroups!==null)for(const H of e.outrogroups)H.pending.delete(b),H.done.delete(b);if((b.f&At)!==0)if(b.f^=At,b===c)Wr(b,null,r);else{var U=h?h.next:c;b===e.effect.last&&(e.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),Xt(e,h,b),Xt(e,b,U),Wr(b,U,r),h=b,g=[],k=[],c=Hr(h.next);continue}if((b.f&qe)!==0&&(Xn(b),i&&(b.nodes?.a?.unfix(),(w??=new Set).delete(b))),b!==c){if(v!==void 0&&v.has(b)){if(g.length<k.length){var C=k[0],O;h=C.prev;var z=g[0],M=g[g.length-1];for(O=0;O<g.length;O+=1)Wr(g[O],C,r);for(O=0;O<k.length;O+=1)v.delete(k[O]);Xt(e,z.prev,M.next),Xt(e,h,z),Xt(e,M,C),c=C,h=M,T-=1,g=[],k=[]}else v.delete(b),Wr(b,c,r),Xt(e,b.prev,b.next),Xt(e,b,h===null?e.effect.first:h.next),Xt(e,h,b),h=b;continue}for(g=[],k=[];c!==null&&c!==b;)(v??=new Set).add(c),k.push(c),c=Hr(c.next);if(c===null)continue}(b.f&At)===0&&g.push(b),h=b,c=Hr(b.next)}if(e.outrogroups!==null){for(const H of e.outrogroups)H.pending.size===0&&(ra(an(H.done)),e.outrogroups?.delete(H));e.outrogroups.size===0&&(e.outrogroups=null)}if(c!==null||v!==void 0){var B=[];if(v!==void 0)for(b of v)(b.f&qe)===0&&B.push(b);for(;c!==null;)(c.f&qe)===0&&c!==e.fallback&&B.push(c),c=Hr(c.next);var F=B.length;if(F>0){var ie=(a&Ta)!==0&&f===0?r:null;if(i){for(T=0;T<F;T+=1)B[T].nodes?.a?.measure();for(T=0;T<F;T+=1)B[T].nodes?.a?.fix()}Mo(e,B,ie)}}i&&Ot(()=>{if(w!==void 0)for(b of w)b.nodes?.a?.apply()})}function Oo(e,t,r,a,s,i,f,l){var c=(f&Ri)!==0?(f&Ai)===0?N(r,!1,!1):hr(r):null,v=(f&Pi)!==0?hr(s):null;return{v:c,i:v,e:et(()=>(i(t,c??r,v??s,l),()=>{e.delete(a)}))}}function Wr(e,t,r){if(e.nodes)for(var a=e.nodes.start,s=e.nodes.end,i=t&&(t.f&At)===0?t.nodes.start:r;a!==null;){var f=Br(a);if(i.before(a),a===s)return;a=f}}function Xt(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function hs(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=hs(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function Fo(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=hs(e))&&(a&&(a+=" "),a+=t);return a}function gs(e){return typeof e=="object"?Fo(e):e??""}function jo(e,t,r){var a=e==null?"":""+e;return a===""?null:a}function Do(e,t){return e==null?null:String(e)}function ot(e,t,r,a,s,i){var f=e.__className;if(f!==r||f===void 0){var l=jo(r);l==null?e.removeAttribute("class"):e.className=l,e.__className=r}return i}function zo(e,t,r,a){var s=e.__style;if(s!==t){var i=Do(t);i==null?e.removeAttribute("style"):e.style.cssText=i,e.__style=t}return a}function ms(e,t,r=!1){if(e.multiple){if(t==null)return;if(!nn(t))return zi();for(var a of e.options)a.selected=t.includes(Gr(a));return}for(a of e.options){var s=Gr(a);if(io(s,t)){a.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Jo(e){var t=new MutationObserver(()=>{ms(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),dn(()=>{t.disconnect()})}function gn(e,t,r=t){var a=new WeakSet,s=!0;Qa(e,"change",i=>{var f=i?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(f),Gr);else{var c=e.querySelector(f)??e.querySelector("option:not([disabled])");l=c&&Gr(c)}r(l),ee!==null&&a.add(ee)}),Xa(()=>{var i=t();if(e===document.activeElement){var f=on??ee;if(a.has(f))return}if(ms(e,i,s),s&&i===void 0){var l=e.querySelector(":checked");l!==null&&(i=Gr(l),r(i))}e.__value=i,s=!1}),Jo(e)}function Gr(e){return"__value"in e?e.__value:e.value}const Vo=Symbol("is custom element"),Bo=Symbol("is html");function bs(e,t,r,a){var s=qo(e);s[t]!==(s[t]=r)&&(r==null?e.removeAttribute(t):typeof r!="string"&&Uo(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function qo(e){return e.__attributes??={[Vo]:e.nodeName.includes("-"),[Bo]:e.namespaceURI===$a}}var ys=new Map;function Uo(e){var t=e.getAttribute("is")||e.nodeName,r=ys.get(t);if(r)return r;ys.set(t,r=[]);for(var a,s=e,i=Element.prototype;i!==s;){a=ba(s);for(var f in a)a[f].set&&r.push(f);s=jn(s)}return r}function ws(e,t,r=t){var a=new WeakSet;Qa(e,"input",async s=>{var i=s?e.defaultValue:e.value;if(i=na(e)?aa(i):i,r(i),ee!==null&&a.add(ee),await wo(),i!==(i=t())){var f=e.selectionStart,l=e.selectionEnd,c=e.value.length;if(e.value=i??"",l!==null){var v=e.value.length;f===l&&l===c&&v>c?(e.selectionStart=v,e.selectionEnd=v):(e.selectionStart=f,e.selectionEnd=Math.min(l,v))}}}),y(t)==null&&e.value&&(r(na(e)?aa(e.value):e.value),ee!==null&&a.add(ee)),qr(()=>{var s=t();if(e===document.activeElement){var i=on??ee;if(a.has(i))return}na(e)&&s===aa(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function na(e){var t=e.type;return t==="number"||t==="range"}function aa(e){return e===""?null:+e}function Ss(e,t,r){var a=ur(e,t);a&&a.set&&(e[t]=r,dn(()=>{e[t]=null}))}function xs(e,t){return e===t||e?.[It]===t}function Lr(e={},t,r,a){return Xa(()=>{var s,i;return qr(()=>{s=i,i=[],y(()=>{e!==r(...i)&&(t(e,...i),s&&xs(r(...s),e)&&t(null,...s))})}),()=>{Ot(()=>{i&&xs(r(...i),e)&&t(null,...i)})}}),e}function er(e=!1){const t=oe,r=t.l.u;if(!r)return;let a=()=>re(t.s);if(e){let s=0,i={};const f=cn(()=>{let l=!1;const c=t.s;for(const v in c)c[v]!==i[v]&&(i[v]=c[v],l=!0);return l&&s++,s});a=()=>n(f)}r.b.length&&vo(()=>{ks(t,a),Dn(r.b)}),Qn(()=>{const s=y(()=>r.m.map(hi));return()=>{for(const i of s)typeof i=="function"&&i()}}),r.a.length&&Qn(()=>{ks(t,a),Dn(r.a)})}function ks(e,t){if(e.l.s)for(const r of e.l.s)n(r);t()}let mn=!1;function Ho(e){var t=mn;try{return mn=!1,[e(),mn]}finally{mn=t}}function Ae(e,t,r,a){var s=!Rr||(r&Mi)!==0,i=(r&Oi)!==0,f=(r&Fi)!==0,l=a,c=!0,v=()=>(c&&(c=!1,l=f?y(a):a),l),h;if(i){var w=It in e||gi in e;h=ur(e,t)?.set??(w&&t in e?C=>e[t]=C:void 0)}var g,k=!1;i?[g,k]=Ho(()=>e[t]):g=e[t],g===void 0&&a!==void 0&&(g=v(),h&&(s&&ki(),h(g)));var S;if(s?S=()=>{var C=e[t];return C===void 0?v():(c=!0,C)}:S=()=>{var C=e[t];return C!==void 0&&(l=void 0),C===void 0?l:C},s&&(r&Li)===0)return S;if(h){var R=e.$$legacy;return(function(C,O){return arguments.length>0?((!s||!O||R||k)&&h(O?S():C),C):S()})}var b=!1,T=((r&Ii)!==0?cn:De)(()=>(b=!1,S()));i&&n(T);var U=te;return(function(C,O){if(arguments.length>0){const z=O?n(T):s&&i?Ar(C):C;return u(T,z),b=!0,l!==void 0&&(l=z),C}return Zt&&b||(U.f&Ct)!==0?T.v:n(T)})}function wr(e){oe===null&&Bn(),Rr&&oe.l!==null?Ko(oe).m.push(e):Qn(()=>{const t=y(e);if(typeof t=="function")return t})}function Es(e){oe===null&&Bn(),wr(()=>()=>y(e))}function Wo(e,t,{bubbles:r=!1,cancelable:a=!1}={}){return new CustomEvent(e,{detail:t,bubbles:r,cancelable:a})}function Go(){const e=oe;return e===null&&Bn(),(t,r,a)=>{const s=e.s.$$events?.[t];if(s){const i=nn(s)?s.slice():[s],f=Wo(t,r,a);for(const l of i)l.call(e.x,f);return!f.defaultPrevented}return!0}}function Ko(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Qo="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Qo),Bi();const Yo=(e,t,r)=>r&&typeof r=="object"?typeof r.message=="string"?r.message:typeof r.code=="string"?r.code:JSON.stringify(r):typeof r=="string"&&r.trim()?r:`${e} ${t}`,ue=async(e,t={})=>{const r=await fetch(e,t),a=await r.text(),s=a?JSON.parse(a):{};if(!r.ok)throw new Error(Yo(r.status,r.statusText,s?.detail));return s},Zo=()=>ue("/api/v1/capabilities"),Xo=()=>ue("/api/v1/version"),el=(e=[])=>ue("/api/v1/log/client",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:Array.isArray(e)?e:[]})}),tl=()=>ue("/api/v1/playground/files"),rl=e=>ue(`/api/v1/playground/files/${gl(e)}`),nl=e=>ue("/api/v1/playground/symbols",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({program:e})}),al=e=>ue("/api/v1/playground/jobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({program:e,execute:!0,execution_strategy:"dask"})}),sl=()=>ue("/api/v1/playground/jobs"),Ts=e=>ue(`/api/v1/playground/jobs/${encodeURIComponent(e)}`),$s=e=>ue(`/api/v1/playground/jobs/${encodeURIComponent(e)}`,{method:"DELETE"}),il=({program:e,nodeId:t="",variable:r="",path:a="",enqueue:s=!0})=>{const i={program:e,execution_strategy:"dask",variable:r,path:a,enqueue:s};return!r&&t&&(i.node_id=t),ue("/api/v1/playground/value",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})},ol=({program:e,nodeId:t="",variable:r="",path:a="",offset:s=0,limit:i=64,enqueue:f=!0})=>{const l={program:e,execution_strategy:"dask",variable:r,path:a,offset:Math.max(0,Number(s||0)),limit:Math.max(1,Number(i||64)),enqueue:f};return!r&&t&&(l.node_id=t),ue("/api/v1/playground/value/page",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})},ll=({limit:e=200,statusFilter:t="",nodeFilter:r=""}={})=>{const a=new URLSearchParams;return a.set("limit",`${e}`),t&&a.set("status_filter",t),r&&a.set("node_filter",r),ue(`/api/v1/results/store?${a.toString()}`)},cl=(e,t="")=>{const r=t?`?path=${encodeURIComponent(t)}`:"";return ue(`/api/v1/results/store/${encodeURIComponent(e)}${r}`)},ul=({nodeId:e,path:t="",offset:r=0,limit:a=64})=>{const s=new URLSearchParams;return t&&s.set("path",t),s.set("offset",`${Math.max(0,Number(r||0))}`),s.set("limit",`${Math.max(1,Number(a||64))}`),ue(`/api/v1/results/store/${encodeURIComponent(e)}/page?${s.toString()}`)},fl=()=>ue("/api/v1/docs/gallery"),dl=()=>ue("/api/v1/testing/report"),vl=()=>ue("/api/v1/testing/jobs"),_l=e=>ue(`/api/v1/testing/jobs/${encodeURIComponent(e)}`),pl=({profile:e,includePerf:t})=>ue("/api/v1/testing/jobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profile:e,include_perf:t})}),Ns=e=>ue(`/api/v1/testing/jobs/${encodeURIComponent(e)}`,{method:"DELETE"}),hl=()=>ue("/api/v1/storage/stats"),gl=e=>String(e||"").split("/").map(t=>encodeURIComponent(t)).join("/"),lt=e=>Number.isFinite(e)?e<.001?`${(e*1e3).toFixed(2)} ms`:`${e.toFixed(3)} s`:"-",Rs=e=>Number.isFinite(e)?`${(e*100).toFixed(1)}%`:"-",Ie=e=>{if(!Number.isFinite(e)||e<0)return"-";const t=["B","KB","MB","GB","TB"];let r=e,a=0;for(;r>=1024&&a<t.length-1;)r/=1024,a+=1;return`${r.toFixed(a===0?0:2)} ${t[a]}`},sa=e=>{const t=e.filter(a=>Number.isFinite(a)).sort((a,s)=>a-s);if(!t.length)return NaN;const r=Math.floor(t.length/2);return t.length%2===1?t[r]:(t[r-1]+t[r])/2},Ps=e=>{const t=String(e||"idle").toLowerCase();return["running","completed","failed","killed"].includes(t)?t:"neutral"},Cs=e=>{const t=[],r=String(e||"").split(/\r?\n/).map(a=>a.trim()).filter(Boolean);for(const a of r){try{const s=JSON.parse(a);if(s&&typeof s=="object"){t.push(s);continue}}catch{}t.push({event:"raw",message:a})}return t},ml=(e,t)=>{const r=Array.isArray(e)?e:[],a={queued:0,running:0,completed:0,failed:0,killed:0,other:0,total:r.length};for(const l of r){const c=String(l?.status||"").toLowerCase();c in a?a[c]+=1:c==="success"?a.completed+=1:a.other+=1}const i=Cs(t?.log_tail||"").filter(l=>l&&l.event==="playground.node").slice(-360).map(l=>({status:String(l.status||"unknown"),cache_source:String(l.cache_source||"-"),duration_s:Number(l.duration_s||0),operator:String(l.operator||"-"),node_id:String(l.node_id||"")})),f=r.slice(0,36).map(l=>({id:String(l.job_id||""),status:String(l.status||"unknown"),created_at:String(l.created_at||""),started_at:String(l.started_at||""),finished_at:String(l.finished_at||""),wall_time_s:Number(l?.metrics?.wall_time_s||0),strategy:String(l?.request?.execution_strategy||"dask"),kind:String(l?.request?.job_kind||"run")}));return{generated_at:Date.now(),counts:a,jobs:f,node_events:i,active_job_id:t?.job_id?String(t.job_id):""}},bn=e=>{const a=((e?.result||{})?.execution||{}).cache_summary||{},s=String(e?.log_tail||""),i=Cs(s),f=i.filter(v=>v.event==="playground.node"),l=f.length?f:i.filter(v=>v.event!=="raw"),c=`computed ${Number(a.computed||0)} | cached(store) ${Number(a.cached_store||0)} | cached(local) ${Number(a.cached_local||0)} | failed ${Number(a.failed||0)} | events ${Number(a.events_stored||f.length)}/${Number(a.events_total||f.length)}`;return{raw:s,summaryText:c,rows:l.slice(-220).reverse()}},bl=({precomputedPrintTargets:e=[],latestGoalResults:t=[],precomputedSymbolTable:r={},latestSymbolTable:a={}})=>{const s=[],i=new Set,f=c=>{const v=`${c.kind}:${c.label}:${c.nodeId}`;i.has(v)||(i.add(v),s.push(c))};for(const c of e)c?.node_id&&f({kind:"print",label:String(c.name||"print"),nodeId:String(c.node_id)});for(const c of t)!c||c.operation!=="print"||!c.node_id||f({kind:"print",label:String(c.name||"print"),nodeId:String(c.node_id)});const l=Object.keys(r||{}).length>0?r:a;for(const[c,v]of Object.entries(l||{}))!v||typeof v!="string"||f({kind:"variable",label:String(c),nodeId:v});return s},As=e=>{const t=e&&typeof e=="object"?e.execution_errors:null;if(t&&typeof t=="object")return t;const r=e?.diagnostics?.execution_errors;return r&&typeof r=="object"?r:{}},yl=e=>{const t=e&&typeof e=="object"?e.execution_error_details:null;if(t&&typeof t=="object")return t;const r=e?.diagnostics?.execution_error_details;return r&&typeof r=="object"?r:{}},Is=e=>{const t=Object.entries(e||{});return t.length?t.map(([r,a])=>`${String(r).slice(0,12)}: ${String(a)}`).join(`
`):"none"},wl=(e,t)=>{const r=Object.entries(e||{});if(!r.length)return"";const a=(s,i=120)=>{const f=String(s??"");return f.length<=i?f:`${f.slice(0,i)}...`};return r.map(([s,i])=>{const f=i?.operator?String(i.operator):"unknown",l=Array.isArray(i?.args)?i.args.map(b=>a(b)).join(", "):"",c=i&&typeof i.kwargs=="object"&&i.kwargs?Object.entries(i.kwargs).map(([b,T])=>`${String(b)}=${a(T)}`).join(", "):"",v=i&&typeof i.attrs=="object"&&i.attrs?a(JSON.stringify(i.attrs)):"",h=i?.kind?` kind=${String(i.kind)}`:"",w=i?.output_kind?` output=${String(i.output_kind)}`:"",g=t?.[s]?String(t[s]):"",k=c?`${f}(${l}${l?", ":""}${c})`:`${f}(${l})`,S=v&&v!=="{}"?` attrs=${v}`:"",R=g?` error=${g}`:"";return`${String(s).slice(0,12)}: ${k}${S}${h}${w}${R}`}).join(`
`)},Sl=(e,t)=>{const r=String(e.node_id||t.nodeId||""),a=e.path||t.path||"",s=String(e.compute_status||e.status||"failed"),i=[`node: ${r||"-"}`,`path: ${a||"/"}`,`status: ${s}`],f=String(e.store_status||e?.diagnostics?.store_status||"missing");i.push(`store: ${f}`),e.error&&i.push(`error: ${String(e.error)}`),e.job_error&&i.push(`job_error: ${String(e.job_error)}`),e.store_error&&i.push(`store_error: ${String(e.store_error)}`);const l=e?.diagnostics;l&&typeof l=="object"&&(l.job_error&&!e.job_error&&i.push(`job_error: ${String(l.job_error)}`),l.store_error&&!e.store_error&&i.push(`store_error: ${String(l.store_error)}`));const c=As(e);Object.keys(c).length&&(i.push("execution_errors:"),i.push(Is(c)));const v=wl(yl(e),c);return v&&(i.push("failed_operations:"),i.push(v)),i.join(`
`)},xl=e=>{if(!e||typeof e!="object")return"value available";const t=String(e.vox_type||"value"),r=e.summary&&typeof e.summary=="object"?e.summary:{};return["integer","number","boolean"].includes(t)?`${t}: ${r.value}`:t==="string"?`string(${r.length||0}): ${r?.value||""}`:t==="ndarray"?`ndarray ${(r.shape||[]).join("x")} ${r.dtype||""}`.trim():["image2d","volume3d"].includes(t)?`${t} ${(r.size||[]).join("x")} ${r.pixel_id||""}`.trim():t==="sequence"?`sequence length=${r.length||0}`:t==="mapping"?`mapping length=${r.length||0}`:t},yn=/[A-Za-z0-9_.$+\-*/<>=!?~^%:&|]/,kl=(e,t)=>{if(!e||!Number.isInteger(t)||t<0)return"";const r=Math.max(0,Math.min(t,e.length));let a=r,s=r;for(;a>0&&yn.test(e[a-1]);)a-=1;for(;s<e.length&&yn.test(e[s]);)s+=1;return e.slice(a,s).trim().replace(/^[^A-Za-z0-9_.$+\-*/<>=!?~^%:&|]+|[^A-Za-z0-9_.$+\-*/<>=!?~^%:&|]+$/g,"")},El=(e,t)=>{if(!e||!Number.isInteger(t)||t<0)return{token:"",start:0,end:0};const r=Math.max(0,Math.min(t,e.length));let a=r,s=r;for(;a>0&&yn.test(e[a-1]);)a-=1;for(;s<e.length&&yn.test(e[s]);)s+=1;return{token:e.slice(a,s).trim().replace(/^[^A-Za-z0-9_.$+\-*/<>=!?~^%:&|]+|[^A-Za-z0-9_.$+\-*/<>=!?~^%:&|]+$/g,""),start:a,end:s}},Tl=e=>e?!/[A-Za-z0-9_$]/.test(e):!1,$l=(e,t)=>{const r=Math.max(0,Math.min(Number(t||0),e.length));let a=r,s=r;for(;a>0&&e[a-1]!==`
`;)a-=1;for(;s<e.length&&e[s]!==`
`;)s+=1;const i=e.slice(a,s).trim();return i?i.length<=140?i:`${i.slice(0,137)}...`:""},Nl=(e,t,r)=>{const a=e.value||"",s=e.getBoundingClientRect();if(t<s.left||t>s.right||r<s.top||r>s.bottom)return null;const i=window.getComputedStyle(e),f=i.font||`${i.fontSize} ${i.fontFamily}`,l=Number.parseFloat(i.lineHeight)||Number.parseFloat(i.fontSize)*1.5,c=Number.parseFloat(i.paddingLeft)||0,v=Number.parseFloat(i.paddingTop)||0,h=document.createElement("span");h.style.position="absolute",h.style.visibility="hidden",h.style.whiteSpace="pre",h.style.font=f,h.textContent="MMMMMMMMMM",document.body.appendChild(h);const w=Math.max(1,h.getBoundingClientRect().width/10);h.remove();const g=t-s.left+e.scrollLeft-c,k=r-s.top+e.scrollTop-v,S=Math.max(0,Math.floor(k/l)),R=Math.max(0,Math.floor(g/w)),b=a.split(`
`),T=Math.min(S,Math.max(0,b.length-1));let U=0;for(let C=0;C<T;C+=1)U+=b[C].length+1;return U+=Math.min(R,b[T].length),Math.min(U,a.length)},Rl=(e,t,r,a)=>{if(!e)return"";const s=[];let i=0;for(;i<e.length;){const f=e[i];if(/[A-Za-z_.$]/.test(f)){let l=i+1;for(;l<e.length&&/[A-Za-z0-9_.$]/.test(e[l]);)l+=1;const c=e.slice(i,l);if(t(c)){const v=encodeURIComponent(c);s.push(`<button type="button" class="editor-token-hit" data-token="${a(v)}" tabindex="-1" title="Inspect ${a(c)}">${r(c)}</button>`)}else s.push(r(c));i=l;continue}s.push(r(f)),i+=1}return s.join("")},Pl=e=>String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"),Cl=e=>String(e).replaceAll("&","&amp;").replaceAll('"',"&quot;").replaceAll("'","&#39;").replaceAll("<","&lt;").replaceAll(">","&gt;");var Al=V("<span> </span>");function Ms(e,t){Mt(t,!1);let r=Ae(t,"value",8,"idle"),a=Ae(t,"extraClass",8,"");er();var s=Al(),i=d(s);Q((f,l)=>{ot(s,1,f),E(i,l)},[()=>gs((re(Ps),re(r()),re(a()),y(()=>`chip ${Ps(r())} ${a()}`.trim()))),()=>(re(r()),y(()=>String(r()||"idle").toLowerCase()))]),A(e,s),Lt()}var Il=V("<option> </option>"),Ml=V("<option> </option>"),Ll=V('<div id="programDiagnostics" class="inline-error"> </div>'),Ol=V('<div id="runError" class="inline-error"> </div>'),Fl=V('<div class="muted"> </div>'),jl=V('<div class="muted">No jobs executed yet.</div>'),Dl=V('<button type="button"> </button>'),zl=V("<span> </span>"),Jl=V('<button class="btn btn-danger btn-small" type="button">Kill</button>'),Vl=V('<article class="job-item"><div class="job-row"><strong> </strong> <!></div> <div class="job-row"><span> </span> <span> </span></div> <div class="job-row"><span> </span> <div class="row gap-s"><button class="btn btn-ghost btn-small" type="button">Open</button> <!></div></div></article>'),Bl=V("<option>No print labels or variables available</option>"),ql=V("<option> </option>"),Ul=V('<div class="muted">No node events available yet. Raw log is shown below.</div>'),Hl=V('<article class="table-like-row"><div class="name"><span class="mini-chip"> </span> </div> <div class="detail"> <!></div></article>'),Wl=V('<article class="table-like-row"><div class="name"> </div> <div class="detail"> </div></article>'),Gl=V(`<section id="tab-playground"><div class="grid-two"><article class="card editor-card"><div class="card-header"><h2>Interactive Playground</h2> <div class="row gap-s"><label class="inline-control" for="executionStrategy">Strategy</label> <select id="executionStrategy" class="select" disabled=""><option selected="">dask</option></select></div></div> <div id="editorShell" class="editor-shell"><textarea id="programInput" class="code-input" spellcheck="false"></textarea> <pre class="editor-token-overlay" aria-hidden="true"></pre></div> <div class="row controls"><label class="inline-control" for="programLibrarySelect">Program Library</label> <select id="programLibrarySelect" class="select"><!></select> <button id="loadProgramFileBtn" class="btn btn-ghost btn-small" type="button">Load from Library</button></div> <p id="programLibraryMeta" class="muted"> </p> <p class="muted">Variables are directly clickable in the editor. Hover changes appearance, click resolves on demand with
        priority even when no full run has been launched.</p> <div id="editorHoverPreview" class="editor-hover-preview muted"> </div> <!> <div class="row controls"><button id="runProgramBtn" class="btn btn-primary hidden" type="button">Run Program</button> <button id="killProgramBtn" class="btn btn-danger" type="button">Kill Running Job</button> <button id="clearOutputBtn" class="btn btn-ghost" type="button">Clear Output</button> <!></div> <!></article> <article class="card telemetry-card"><div class="card-header"><h2>Runtime Telemetry</h2> <button id="refreshJobsBtn" class="btn btn-ghost btn-small" type="button">Refresh</button></div> <div class="stats-grid"><div class="stat"><span class="label">Wall Time</span><strong id="metricWall"> </strong></div> <div class="stat"><span class="label">CPU Time</span><strong id="metricCpu"> </strong></div> <div class="stat"><span class="label">CPU Util.</span><strong id="metricCpuUtil"> </strong></div> <div class="stat"><span class="label">Peak Python Heap</span><strong id="metricHeapPeak"> </strong></div> <div class="stat"><span class="label">RSS Delta</span><strong id="metricRssDelta"> </strong></div> <div class="stat"><span class="label">Current Job</span><strong id="metricJobId"> </strong></div></div> <h3 class="subheading">Recent Jobs</h3> <div id="recentJobs" class="job-list"><!></div> <h3 class="subheading">Dask Queue Flux</h3> <div id="daskQueueViz" class="dask-queue-viz"></div> <h3 class="subheading">Focused Result</h3> <div class="row gap-s controls"><label class="inline-control" for="playResultSelector">Target</label> <select id="playResultSelector" class="select"><!></select></div> <p id="playResultMeta" class="muted"> </p> <div id="playResultInspector" class="result-inspector compact"></div> <h3 class="subheading">Execution Log</h3> <p id="playExecSummary" class="muted"> </p> <div id="playExecLog" class="table-like muted"><!></div> <pre id="playExecRaw" class="mono-scroll compact-log"> </pre></article></div> <div class="grid-two"><article class="card"><h2>Execution Result</h2> <pre id="executionOutput" class="mono-scroll"> </pre></article> <article class="card"><h2>Task Graph (Text)</h2> <pre id="taskGraphOutput" class="mono-scroll"> </pre></article></div></section>`);function Kl(e,t){Mt(t,!1);const r=N();let a=Ae(t,"active",8,!1),s=Ae(t,"capabilities",24,()=>({}));const i="brats_flair_mean_threshold.imgql";let l=N(`import "simpleitk"

dataset_root = "tests/data/datasets/BraTS_2019_HGG"

// Recursively discover all BRaTS FLAIR volumes.
flair_paths = dir(dataset_root, "*_flair.nii.gz", true, true)

// Threshold each image at the midpoint between its min and max intensity.
mk_mask(path) =
  let img = ReadImage(path) in
  let mm = MinimumMaximum(img) in
  let lo = index(mm, 0) in
  let hi = index(mm, 1) in
  BinaryThreshold(img, (lo + hi) / 2, hi, 255, 0)

// Sequence of binary masks, one per discovered FLAIR image.
masks = map(mk_mask, flair_paths)`),c=N([]),v=N(""),h=N(""),w=!1,g=!1,k=N([]),S={},R=[],b=[],T={},U=0,C=null,O=N(""),z=N("idle"),M="",B=null,F=N([]),ie=N("-"),H=N("-"),be=N("-"),Ee=N("-"),Pe=N("-"),we=N("-"),Te=N(""),W=N(""),I=N("Click inspect on a variable to resolve it on demand."),q=N([]),ne=N(-1),ye=N("No execution trace yet."),$e=N(""),ve=N([]),Me=N(""),j=N("Hover a variable to see cached value status, or hover an operator to inspect expression context."),L="",J="",fe=0,Z=N(""),Ne=N(null),Le=N(),ae=N(),Ve=N(),ht=N(),Se=null,We=null,kt=null,Et="",Dt=null,_e=null,gt=null,tr=0,Be=null,pe=null,Tt=null,Sr=0,zt="";const ia=o=>{const _=Array.isArray(o)?o:[];return _.length?_.map(m=>{const P=m?.code?`[${m.code}] `:"",x=m?.message?String(m.message):"Static error",D=m?.symbol?` (symbol: ${m.symbol})`:"",K=m?.location?` @ ${m.location}`:"";return`${P}${x}${D}${K}`}).join(`
`):""},rr=o=>{const _=o?.metrics||{};u(ie,lt(Number(_.wall_time_s))),u(H,lt(Number(_.cpu_time_s))),u(be,Rs(Number(_.cpu_utilization))),u(Ee,Ie(Number(_.python_heap_peak_bytes))),u(Pe,Ie(Number(_.ru_maxrss_delta_bytes))),u(we,o?.job_id?String(o.job_id).slice(0,12):"-")},mt=o=>{u(z,String(o||"idle").toLowerCase())},Sn=()=>{u(O,"")},Kr=()=>`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}`,xn=o=>{const _=Math.min(8,Math.max(0,Number(o||0))),m=Math.min(5e3,250*2**_),P=Math.floor(Math.random()*180);return m+P},Qr=()=>{gt&&(clearTimeout(gt),gt=null);const o=_e;if(_e=null,o)try{o.close()}catch{}},kn=()=>{Tt&&(clearTimeout(Tt),Tt=null);const o=pe;if(pe=null,o)try{o.close()}catch{}},En=()=>{_e&&(_e.readyState===WebSocket.OPEN||_e.readyState===WebSocket.CONNECTING)||(Qr(),_e=new WebSocket(`${Kr()}/ws/playground/value`),_e.onopen=()=>{tr=0,Be&&_e.send(JSON.stringify({type:"subscribe",request:{program:n(l),execution_strategy:"dask",node_id:Be.nodeId,variable:Be.variable||"",path:Be.path||"",enqueue:Be.enqueue!==!1}}))},_e.onmessage=o=>{try{const _=JSON.parse(String(o.data||"{}"));_?.type==="value"&&_?.payload&&Be&&An(_.payload,Be)}catch{}},_e.onclose=()=>{if(_e=null,!Be)return;tr+=1;const o=xn(tr);gt&&clearTimeout(gt),gt=setTimeout(()=>{En()},o)},_e.onerror=()=>{try{_e?.close()}catch{}})},oa=({nodeId:o="",variable:_="",path:m="",enqueue:P=!0}={})=>"WebSocket"in window?(Be={nodeId:o,variable:_,path:m,enqueue:P},En(),_e&&_e.readyState===WebSocket.OPEN&&_e.send(JSON.stringify({type:"subscribe",request:{program:n(l),execution_strategy:"dask",node_id:o,variable:_,path:m,enqueue:P}})),!0):!1,Tn=()=>{pe&&(pe.readyState===WebSocket.OPEN||pe.readyState===WebSocket.CONNECTING)||(kn(),pe=new WebSocket(`${Kr()}/ws/playground/jobs`),pe.onopen=()=>{Sr=0,zt&&pe.send(JSON.stringify({type:"subscribe",job_id:zt}))},pe.onmessage=async o=>{try{const _=JSON.parse(String(o.data||"{}"));if(_?.type!=="job"&&_?.type!=="terminal")return;const m=_?.payload||null;if(!m)return;B=m||null,mt(m.status),rr(m);const{raw:P,summaryText:x,rows:D}=bn(m);u($e,P),u(ye,x),u(ve,D),Jt(),_.type==="terminal"&&(zt="",await Xr(m))}catch{}},pe.onclose=()=>{if(pe=null,!zt)return;Sr+=1;const o=xn(Sr);Tt&&clearTimeout(Tt),Tt=setTimeout(()=>{Tn()},o)},pe.onerror=()=>{try{pe?.close()}catch{}})},$n=(o="")=>!o||!("WebSocket"in window)?!1:(zt=String(o),Tn(),pe&&pe.readyState===WebSocket.OPEN&&pe.send(JSON.stringify({type:"subscribe",job_id:zt})),!0),$t=()=>{kt&&(clearInterval(kt),kt=null),zt="",kn()},bt=()=>{Be=null,Qr()},nr=()=>{const o=n(q)[n(ne)];if(u(q,bl({precomputedPrintTargets:R,latestGoalResults:b,precomputedSymbolTable:S,latestSymbolTable:T})),!n(q).length){u(ne,-1);return}if(o){const _=n(q).findIndex(m=>m.kind===o.kind&&m.label===o.label&&m.nodeId===o.nodeId);u(ne,_>=0?_:0);return}u(ne,0)},Yr=()=>{if(Se||!n(Ve))return;const o=window.VoxResultViewer?.ResultViewer;if(typeof o=="function"){Se=new o(n(Ve),{onNavigate:_=>{const m=n(q)[n(ne)];m?.nodeId&&Or(m.nodeId,_||"",{variable:m.kind==="variable"?m.label:""})},fetchPage:({nodeId:_,path:m,offset:P,limit:x})=>{const D=n(q)[n(ne)],K=D?.kind==="variable"?D.label:"";return ol({program:n(l),nodeId:_||D?.nodeId||"",variable:K,path:m||"",offset:Number(P||0),limit:Number(x||64),enqueue:!0})},onStatusClick:_=>{!_||_.status!=="failed"&&_.status!=="killed"||Zr(_,{nodeId:_.node_id||"",path:_.path||""})}});return}Se={setLoading:_=>{yt(Ve,n(Ve).textContent=_||"Loading...")},setError:_=>{yt(Ve,n(Ve).textContent=_||"Viewer error")},renderRecord:_=>{yt(Ve,n(Ve).textContent=JSON.stringify(_||{},null,2))}}},Nn=()=>{if(We||!n(ht))return;const o=window.VoxDaskQueueViz?.DaskQueueVisualizer;if(typeof o=="function"){We=new o(n(ht));return}We={render:_=>{const m=_?.counts||{};yt(ht,n(ht).textContent=`queue: queued ${Number(m.queued||0)} | running ${Number(m.running||0)} | completed ${Number(m.completed||0)} | failed ${Number(m.failed||0)}`)}}},Jt=()=>{Nn(),We&&We.render(ml(n(F),B))},Rn=async o=>{const _=o?.result||{};u(Te,JSON.stringify(_,null,2)),u(W,_.task_graph||"(no task graph in payload)"),Array.isArray(_.goal_results)&&(b=_.goal_results),_.symbol_table&&typeof _.symbol_table=="object"&&(T=_.symbol_table);const{raw:m,summaryText:P,rows:x}=bn(o);if(u($e,m),u(ye,P),u(ve,x),nr(),n(q).length&&n(ne)>=0){const D=n(q)[n(ne)];await Or(D.nodeId,"",{variable:D.kind==="variable"?D.label:""})}Jt()},la=async()=>{if(s().playground_program_library===!1){u(c,[]),u(v,""),u(h,"Program library endpoint unavailable on this backend.");return}try{const o=await tl();if(!o.available){u(c,[]),u(v,""),u(h,o.error||"Program library unavailable.");return}if(u(c,o.files||[]),!n(c).length){u(v,""),g=!0,u(h,`${o.load_dir} | 0 files`);return}const _=n(c).find(m=>{const P=String(m?.path||"");return P===i||P.endsWith(`/${i}`)});g?(!n(v)||!n(c).some(m=>m.path===n(v)))&&u(v,_?.path||n(c)[0].path):(u(v,_?.path||n(c)[0].path),g=!0),u(h,`${o.load_dir} | ${n(c).length} file(s)`)}catch(o){u(c,[]),u(v,""),u(h,`Unable to load library: ${o.message}`)}},Pn=async()=>{if(n(v))try{const o=await rl(n(v));u(l,o.content||""),u(h,`${o.path} | ${Ie(Number(o.bytes||0))}`),b=[],T={},Ke(),await Nt(),Sn()}catch(o){u(h,`Unable to load ${n(v)}: ${o.message}`)}},Nt=async()=>{if(s().playground_symbols===!1)return;const o=U+1;if(U=o,!String(n(l)||"").trim()){S={},R=[],u(k,[]),nr(),Ke();return}try{const _=await nl(n(l));if(o!==U)return;const m=_?.available!==!1;S=m?_.symbol_table||{}:{},R=m?_.print_targets||[]:[],u(k,_?.diagnostics||[]),nr(),Ke()}catch(_){if(o!==U)return;S={},R=[],u(k,[{code:"E_SYMBOLS",message:`Unable to refresh symbols: ${_.message}`}]),nr(),Ke()}},ca=()=>{C&&clearTimeout(C),C=setTimeout(()=>{Nt()},260)},Cn=({nodeId:o="",variable:_="",path:m="",enqueue:P=!0})=>il({program:n(l),nodeId:o,variable:_,path:m,enqueue:P}),Zr=(o,_)=>{const m=String(o.node_id||_.nodeId||""),P=o.path||_.path||"",D=String(o.compute_status||o.status||"failed").toLowerCase()==="killed"?"killed":"failed",K=Sl(o,_),Fe=String(o.error||"Value inspection failed.");if(Se.renderRecord({available:!1,node_id:m,status:D,runtime_version:o.runtime_version||"runtime",updated_at:o.updated_at||new Date().toISOString(),path:P,error:Fe,log_tail:o.log_tail||"",execution_errors:As(o),descriptor:{vox_type:"string",format_version:"voxpod/1",summary:{value:K,length:K.length,truncated:!1},navigation:{path:P||"",pageable:!1,can_descend:!1,default_page_size:64,max_page_size:512}},diagnostics:o.diagnostics||{}}),u(I,`Unable to inspect ${m.slice(0,12)}${P?` @ ${P}`:""}: ${Fe}`),o.log_tail){const{raw:ut,summaryText:Qe,rows:Rt}=bn({log_tail:o.log_tail,result:{execution:{cache_summary:o?.cache_summary||o?.diagnostics?.cache_summary||{}}}});u($e,ut),u(ye,Qe),u(ve,Rt);return}u($e,""),u(ye,"No execution log available for this failure."),u(ve,[])},An=(o,_)=>{const m=String(o.materialization||""),P=String(o.compute_status||""),x=String(o.status||""),D=String(o.node_id||_.nodeId||""),K=o.path||_.path||"",Fe=o.job_id?String(o.job_id):"",ut=o?.descriptor&&typeof o.descriptor=="object"?String(o.descriptor.vox_type||""):"",Qe=o?.descriptor&&ut&&ut!=="unavailable"&&ut!=="error";if((m==="cached"||m==="computed"||x==="materialized")&&Qe){bt(),Et="",Se.renderRecord(o),u(I,`Inspecting ${D.slice(0,12)}${K?` @ ${K}`:""} | ${m||"materialized"} | status=${P||"materialized"}`);return}if(m==="failed"||P==="failed"||P==="killed"||x==="failed"){bt(),Et="",Zr(o,_);return}if(m==="pending"||m==="missing"||P==="queued"||P==="running"||P==="persisting"){const Ht=`${D}|${K||""}`,lr=(ut==="sequence"||ut==="mapping")&&o?.descriptor&&typeof o.descriptor=="object"?o.descriptor:{vox_type:"unavailable",format_version:"voxpod/1",summary:{reason:`status=${P||"pending"}`},navigation:{path:K||"",pageable:!1,can_descend:!1,default_page_size:64,max_page_size:512}},cr={...o,available:!1,node_id:D,status:P||"running",runtime_version:o.runtime_version||"runtime",updated_at:o.updated_at||new Date().toISOString(),path:K,descriptor:lr};Et===Ht&&typeof Se.refreshPage=="function"?Se.refreshPage(D,K):(Se.renderRecord(cr),Et=Ht),u(I,`In progress ${D.slice(0,12)}${K?` @ ${K}`:""} | ${P||"pending"}${Fe?` | job ${Fe.slice(0,12)}`:""}`),oa({nodeId:D,variable:_.variable||"",path:K,enqueue:!1});return}bt();const Ut=o.error||(m==="missing"?"Value is not materialized yet.":`Unable to inspect value (${m||P||"unknown"}).`);Zr({...o,error:Ut,compute_status:P||"failed",status:o.status||"failed"},_)},Or=async(o,_="",m={})=>{Yr(),bt();const P=String(m.variable||"");u(I,`Resolving ${o.slice(0,12)}${_?` @ ${_}`:""}...`);try{const x=await Cn({nodeId:o,variable:P,path:_,enqueue:m.enqueue!==!1});An(x,{nodeId:o,variable:P,path:_})}catch(x){bt(),Se.setError(`Value lookup failed: ${x.message}`),u(I,`Unable to inspect ${o.slice(0,12)}: ${x.message}`)}},ar=async()=>{try{const o=await sl();u(F,o.jobs||[]),u(Me,""),!B&&n(F).length&&(B=n(F)[0]),Jt()}catch(o){u(F,[]),u(Me,`Failed to load jobs: ${o.message}`),Jt()}},Xr=async o=>{B=o||null,mt(o?.status),rr(o),await Rn(o),u(O,o?.error||""),await ar()},en=async()=>{if(M)try{const o=await Ts(M);B=o||null,mt(o.status),rr(o);const{raw:_,summaryText:m,rows:P}=bn(o);if(u($e,_),u(ye,m),u(ve,P),Jt(),o.status==="running")return;$t(),await Xr(o)}catch(o){$t(),mt("failed"),u(O,`Polling failed: ${o.message}`)}},tn=async()=>{if(Sn(),await Nt(),n(k).length){u(O,"Static diagnostics must be fixed before execution can start.");return}try{mt("running"),bt(),u(Te,""),u(W,""),u($e,""),u(ve,[]),u(ye,"Execution started. Waiting for log events..."),rr(null);const o=await al(n(l));M=o.job_id,u(we,String(o.job_id||"").slice(0,12)),$t(),$n(String(M||""))||(kt=setInterval(en,800),await en())}catch(o){mt("failed"),u(O,o.message)}},$=()=>{u(Te,""),u(W,""),u(O,""),rr(null),u(ye,"No execution log yet."),u($e,""),u(ve,[]),b=[],T={},B=null,bt(),Et="",u(I,"Click inspect on a variable to resolve it on demand."),Yr(),Se.renderRecord(null),nr(),u(ne,n(q).length?0:-1),Jt()},G=async()=>{if(M)try{const o=await $s(M);$t(),await Xr(o)}catch(o){u(O,`Kill failed: ${o.message}`)}},de=async o=>{if(o)try{const _=await Ts(o);M=o,B=_||null,mt(_.status),rr(_),await Rn(_),_.status==="running"&&($t(),$n(String(o||""))||(kt=setInterval(en,800)));const m=_?.result?.execution?.errors;(_.status==="failed"||_.status==="killed")&&m&&typeof m=="object"?u(O,[_.error||"Execution failed",Is(m)].filter(Boolean).join(`
`)):u(O,_.error||"")}catch(_){u(O,`Unable to open ${o}: ${_.message}`)}},he=async o=>{try{await $s(o),M===o&&($t(),mt("killed")),await ar()}catch(_){u(O,`Unable to kill ${o}: ${_.message}`)}},X=async()=>{const o=Number(n(ne));if(!Number.isFinite(o)||(u(ne,o),n(ne)<0||n(ne)>=n(q).length))return;const _=n(q)[n(ne)];await Or(_.nodeId,"",{variable:_.kind==="variable"?_.label:""})},ge=o=>S[o]||T[o]||"",Ge=()=>{!n(ae)||!n(Le)||(yt(ae,n(ae).scrollTop=n(Le).scrollTop),yt(ae,n(ae).scrollLeft=n(Le).scrollLeft))},ct=o=>{if(!n(ae))return;const _=encodeURIComponent(String(o||""));n(ae).querySelectorAll(".editor-token-hit").forEach(m=>{m instanceof HTMLElement&&(o&&m.dataset.token===_?m.classList.add("is-active"):m.classList.remove("is-active"))})},Oe=o=>{u(j,o||"")},Ce=()=>{L="",J="",ct(""),Oe("Hover a variable to see cached value status, or hover an operator to inspect expression context.")},Vt=o=>{L=o||"",ct(o||"")},Ke=()=>{n(ae)&&(yt(ae,n(ae).innerHTML=Rl(String(n(l)||""),ge,Pl,Cl)),Ge(),L&&ct(L))},sr=async o=>{const _=ge(o);if(!_)return;Ce();const m=n(q).findIndex(P=>P.kind==="variable"&&P.label===o);m>=0&&u(ne,m),await Or(_,"",{variable:o})},Bt=async o=>{const _=fe+1;fe=_,Oe(`var ${o}: checking cache...`);try{const m=await Cn({variable:o,enqueue:!1});if(_!==fe||L!==o)return;const P=String(m.materialization||"");if(m.descriptor&&(P==="cached"||P==="computed")){Oe(`var ${o}: ${xl(m.descriptor)} (${P})`);return}if(P==="pending"||m.compute_status==="running"||m.compute_status==="queued"||m.compute_status==="persisting"){Oe(`var ${o}: running (${m.compute_status}). Click to focus/inspect.`);return}Oe(`var ${o}: not materialized yet. Click to compute on demand.`)}catch{if(_!==fe||L!==o)return;Oe(`var ${o}: click to compute on demand.`)}},ir=o=>{a()&&(n(Ne)&&(clearTimeout(n(Ne)),u(Ne,null)),u(Ne,setTimeout(()=>{const _=Nl(n(Le),o.clientX,o.clientY);if(!Number.isInteger(_)){Ce();return}const m=El(n(l)||"",_);if(!m.token){Ce();return}const P=ge(m.token);if(!P&&!Tl(m.token)){Ce();return}if(u(Z,m.token),P){Vt(m.token),J!==m.token&&(J=m.token,Bt(m.token));return}Vt(""),J=m.token;const x=$l(n(l)||"",m.start);Oe(x?`operator '${m.token}' in: ${x}`:`operator '${m.token}'`)},140)))},qt=async o=>{if(!o)return!1;let _=ge(o)?o:"";if(!_){await Nt();const m=kl(n(l)||"",Number(n(Le)?.selectionStart||0));_=ge(o)?o:ge(m)?m:"",!_&&n(Z)&&ge(n(Z))&&(_=n(Z))}return _?(u(Z,_),await sr(_),!0):!1},ua=()=>{T={},b=[],Ke(),ca(),Ce()},In=()=>{if(!n(ae))return;const o=x=>{x.target instanceof Element&&x.target.closest(".editor-token-hit")&&x.preventDefault()},_=x=>{const D=x.target instanceof Element?x.target.closest(".editor-token-hit"):null;if(!D)return;const K=decodeURIComponent(String(D.getAttribute("data-token")||""));K&&(u(Z,K),Vt(K),J!==K&&(J=K,Bt(K)))},m=x=>{!(x.target instanceof Element&&x.target.closest(".editor-token-hit"))||x.relatedTarget instanceof Element&&x.relatedTarget.closest(".editor-token-hit")||(u(Z,""),Ce())},P=async x=>{const D=x.target instanceof Element?x.target.closest(".editor-token-hit"):null;if(!D)return;x.preventDefault();const K=decodeURIComponent(String(D.getAttribute("data-token")||""));K&&(await qt(K),n(Le)?.focus({preventScroll:!0}))};return n(ae).addEventListener("mousedown",o),n(ae).addEventListener("mouseover",_),n(ae).addEventListener("mouseout",m),n(ae).addEventListener("click",P),()=>{n(ae).removeEventListener("mousedown",o),n(ae).removeEventListener("mouseover",_),n(ae).removeEventListener("mouseout",m),n(ae).removeEventListener("click",P)}},fa=async o=>{await de(o)},da=()=>{Dt||(Dt=setInterval(()=>{a()&&(ar(),Nt())},15e3))},Mn=()=>{Dt&&(clearInterval(Dt),Dt=null)};async function or(o,_=!1){u(l,String(o||"")),T={},b=[],Ke(),await Nt(),_&&await tn()}async function rn(){await tn()}wr(()=>{Yr(),Nn(),Jt();const o=In();return Ke(),(async()=>(await la(),!w&&n(v)&&(w=!0,await Pn()),await Promise.all([ar(),Nt()])))(),()=>{o?.()}}),Es(()=>{$t(),bt(),Mn(),C&&clearTimeout(C),n(Ne)&&clearTimeout(n(Ne)),We&&typeof We.destroy=="function"&&We.destroy(),Se&&typeof Se.destroy=="function"&&Se.destroy()}),St(()=>n(k),()=>{u(r,ia(n(k)))}),St(()=>re(a()),()=>{a()?(ar(),Nt(),da()):Mn()}),St(()=>re(s()),()=>{s().playground_program_library===!1&&u(h,"Program library endpoint unavailable on this backend.")}),Ir();var Nc={loadProgram:or,runCurrentProgram:rn};er();var va=Gl(),Os=d(va),Fs=d(Os),js=d(Fs),Rc=p(d(js),2),Pc=p(d(Rc),2),Ds=d(Pc);Ds.value=Ds.__value="dask";var zs=p(js,2),xr=d(zs);Lr(xr,o=>u(Le,o),()=>n(Le));var Cc=p(xr,2);Lr(Cc,o=>u(ae,o),()=>n(ae));var Js=p(zs,2),Ln=p(d(Js),2),Ac=d(Ln);{var Ic=o=>{var _=Il(),m=d(_);_.value=_.__value="",Q(()=>E(m,(re(s()),y(()=>s().playground_program_library===!1?"unavailable":"no .imgql files found")))),A(o,_)},Mc=o=>{var _=at(),m=Ue(_);it(m,1,()=>n(c),st,(P,x)=>{var D=Ml(),K=d(D),Fe={};Q(()=>{E(K,(n(x),y(()=>n(x).path))),Fe!==(Fe=(n(x),y(()=>n(x).path)))&&(D.value=(D.__value=(n(x),y(()=>n(x).path)))??"")}),A(P,D)}),A(o,_)};ce(Ac,o=>{n(c),y(()=>!n(c).length)?o(Ic):o(Mc,!1)})}var Vs=p(Ln,2),Bs=p(Js,2),Lc=d(Bs),qs=p(Bs,4),Oc=d(qs),Us=p(qs,2);{var Fc=o=>{var _=Ll(),m=d(_);Q(()=>E(m,n(r))),A(o,_)};ce(Us,o=>{n(r)&&o(Fc)})}var Hs=p(Us,2),Ws=d(Hs),_a=p(Ws,2),Gs=p(_a,2),jc=p(Gs,2);Ms(jc,{get value(){return n(z)}});var Dc=p(Hs,2);{var zc=o=>{var _=Ol(),m=d(_);Q(()=>E(m,n(O))),A(o,_)};ce(Dc,o=>{n(O)&&o(zc)})}var Jc=p(Fs,2),Ks=d(Jc),Vc=p(d(Ks),2),Qs=p(Ks,2),Ys=d(Qs),Bc=p(d(Ys)),qc=d(Bc),Zs=p(Ys,2),Uc=p(d(Zs)),Hc=d(Uc),Xs=p(Zs,2),Wc=p(d(Xs)),Gc=d(Wc),ei=p(Xs,2),Kc=p(d(ei)),Qc=d(Kc),ti=p(ei,2),Yc=p(d(ti)),Zc=d(Yc),Xc=p(ti,2),eu=p(d(Xc)),tu=d(eu),ri=p(Qs,4),ru=d(ri);{var nu=o=>{var _=Fl(),m=d(_);Q(()=>E(m,n(Me))),A(o,_)},au=o=>{var _=jl();A(o,_)},su=o=>{var _=at(),m=Ue(_);it(m,1,()=>n(F),st,(P,x)=>{const D=De(()=>(n(x),y(()=>String(n(x).status||"unknown")))),K=De(()=>n(D)==="failed"||n(D)==="killed");var Fe=Vl(),ut=d(Fe),Qe=d(ut),Rt=d(Qe),Ut=p(Qe,2);{var Ht=ft=>{var Ye=Dl(),ma=d(Ye);Q(()=>{ot(Ye,1,`chip ${n(D)} chip-clickable`),E(ma,n(D))}),se("click",Ye,()=>fa(n(x).job_id)),A(ft,Ye)},Fr=ft=>{var Ye=zl(),ma=d(Ye);Q(()=>{ot(Ye,1,`chip ${n(D)}`),E(ma,n(D))}),A(ft,Ye)};ce(Ut,ft=>{n(K)?ft(Ht):ft(Fr,!1)})}var lr=p(ut,2),cr=d(lr),Fn=d(cr),pa=p(cr,2),ha=d(pa),kr=p(lr,2),Er=d(kr),ga=d(Er),Su=p(Er,2),ui=d(Su),xu=p(ui,2);{var ku=ft=>{var Ye=Jl();se("click",Ye,()=>he(n(x).job_id)),A(ft,Ye)};ce(xu,ft=>{n(D)==="running"&&ft(ku)})}Q((ft,Ye)=>{E(Rt,ft),E(Fn,(n(x),y(()=>n(x)?.request?.execution_strategy||"dask"))),E(ha,Ye),E(ga,(n(x),y(()=>n(x).created_at||"-")))},[()=>(n(x),y(()=>String(n(x).job_id||"").slice(0,12))),()=>(re(lt),n(x),y(()=>lt(Number(n(x)?.metrics?.wall_time_s))))]),se("click",ui,()=>de(n(x).job_id)),A(P,Fe)}),A(o,_)};ce(ru,o=>{n(Me)?o(nu):(n(F),y(()=>!n(F).length)?o(au,1):o(su,!1))})}var ni=p(ri,4);Lr(ni,o=>u(ht,o),()=>n(ht));var ai=p(ni,4),On=p(d(ai),2),iu=d(On);{var ou=o=>{var _=Bl();_.value=_.__value="",A(o,_)},lu=o=>{var _=at(),m=Ue(_);it(m,1,()=>n(q),st,(P,x,D)=>{var K=ql(),Fe=d(K);K.value=K.__value=D,Q(()=>E(Fe,(n(x),y(()=>n(x).kind==="print"?`print: ${n(x).label}`:`var: ${n(x).label}`)))),A(P,K)}),A(o,_)};ce(iu,o=>{n(q),y(()=>!n(q).length)?o(ou):o(lu,!1)})}var si=p(ai,2),cu=d(si),ii=p(si,2);Lr(ii,o=>u(Ve,o),()=>n(Ve));var oi=p(ii,4),uu=d(oi),li=p(oi,2),fu=d(li);{var du=o=>{var _=Ul();A(o,_)},vu=o=>{var _=at(),m=Ue(_);it(m,1,()=>n(ve),st,(P,x)=>{var D=at(),K=Ue(D);{var Fe=Qe=>{var Rt=Hl(),Ut=d(Rt),Ht=d(Ut),Fr=d(Ht),lr=p(Ht),cr=p(Ut,2),Fn=d(cr),pa=p(Fn);{var ha=kr=>{var Er=Ro();Q(ga=>E(Er,`| ${ga??""}`),[()=>(n(x),y(()=>String(n(x).error)))]),A(kr,Er)};ce(pa,kr=>{n(x),y(()=>n(x).error)&&kr(ha)})}Q((kr,Er)=>{E(Fr,(n(x),y(()=>n(x).status||"unknown"))),E(lr,` ${n(x),y(()=>n(x).operator||"-")??""}`),E(Fn,`node=${kr??""} | source=${n(x),y(()=>n(x).cache_source||"-")??""} |
                  duration=${Er??""} ms `)},[()=>(n(x),y(()=>String(n(x).node_id||"").slice(0,12))),()=>(n(x),y(()=>(Number(n(x).duration_s||0)*1e3).toFixed(2)))]),A(Qe,Rt)},ut=Qe=>{var Rt=Wl(),Ut=d(Rt),Ht=d(Ut),Fr=p(Ut,2),lr=d(Fr);Q(cr=>{E(Ht,(n(x),y(()=>n(x).event||"event"))),E(lr,cr)},[()=>(n(x),y(()=>n(x).message||n(x).error||JSON.stringify(n(x)).slice(0,180)))]),A(Qe,Rt)};ce(K,Qe=>{n(x),y(()=>n(x).event==="playground.node")?Qe(Fe):Qe(ut,!1)})}A(P,D)}),A(o,_)};ce(fu,o=>{n(ve),y(()=>!n(ve).length)?o(du):o(vu,!1)})}var _u=p(li,2),pu=d(_u),hu=p(Os,2),ci=d(hu),gu=p(d(ci),2),mu=d(gu),bu=p(ci,2),yu=p(d(bu),2),wu=d(yu);return Q(()=>{ot(va,1,`panel ${a()?"active":""}`),Ln.disabled=(n(c),y(()=>!n(c).length)),Vs.disabled=(n(c),y(()=>!n(c).length)),E(Lc,n(h)),E(Oc,n(j)),_a.disabled=n(z)!=="running",E(qc,n(ie)),E(Hc,n(H)),E(Gc,n(be)),E(Qc,n(Ee)),E(Zc,n(Pe)),E(tu,n(we)),On.disabled=(n(q),y(()=>!n(q).length)),E(cu,n(I)),E(uu,n(ye)),E(pu,n($e)),E(mu,n(Te)),E(wu,n(W))}),ws(xr,()=>n(l),o=>u(l,o)),se("input",xr,ua),se("mousemove",xr,ir),se("mouseleave",xr,()=>{u(Z,""),Ce(),n(Ne)&&(clearTimeout(n(Ne)),u(Ne,null))}),se("scroll",xr,Ge),gn(Ln,()=>n(v),o=>u(v,o)),se("click",Vs,Pn),se("click",Ws,tn),se("click",_a,G),se("click",Gs,$),se("click",Vc,ar),gn(On,()=>n(ne),o=>u(ne,o)),se("change",On,X),A(e,va),Ss(t,"loadProgram",or),Ss(t,"runCurrentProgram",rn),Lt(Nc)}var Ql=V('<div class="inline-error"> </div>'),Yl=V('<div class="muted">No stored results found for current runtime.</div>'),Zl=V('<article><div class="job-row"><strong> </strong> <span> </span></div> <div class="job-row"><span> </span> <span> </span></div> <div class="job-row"><span> </span> <button class="btn btn-ghost btn-small" type="button">Inspect</button></div></article>'),Xl=V('<section id="tab-results"><div class="grid-two"><article class="card"><div class="card-header"><h2>Stored Results</h2> <button id="refreshResultsBtn" class="btn btn-ghost btn-small" type="button">Refresh</button></div> <div class="row gap-s controls"><label class="inline-control" for="resultStatusFilter">Status</label> <select id="resultStatusFilter" class="select"><option>all</option><option>materialized</option><option>failed</option></select> <input id="resultSearchInput" class="input" type="search" placeholder="Filter by node id"/></div> <p id="resultListMeta" class="muted"> </p> <!> <div id="resultList" class="job-list"><!></div></article> <article class="card"><h2>Result Inspector</h2> <p class="muted">View values only from persisted store entries. Server-side save/export is intentionally disabled.</p> <div id="resultInspector" class="result-inspector"></div></article></div></section>');function ec(e,t){Mt(t,!1);let r=Ae(t,"active",8,!1),a=Ae(t,"capabilities",24,()=>({})),s=N(""),i=N(""),f=N([]),l=N(""),c=N(""),v=N(""),h="",w=N(),g=null,k=null;const S=()=>{if(g)return;const j=window.VoxResultViewer?.ResultViewer;if(typeof j=="function"){g=new j(n(w),{onNavigate:L=>{n(v)&&R(n(v),L||"")},fetchPage:({nodeId:L,path:J,offset:fe,limit:Z})=>ul({nodeId:L||n(v),path:J||"",offset:Number(fe||0),limit:Number(Z||64)}),onStatusClick:L=>{if(!L||L.status!=="failed"&&L.status!=="killed")return;const J=[`node: ${L.node_id||"-"}`,`path: ${L.path||"/"}`,`status: ${L.status||"failed"}`,L.error?`error: ${L.error}`:""].filter(Boolean);g.setError(J.join(`
`))}});return}g={setLoading:L=>{yt(w,n(w).textContent=L||"Loading...")},setError:L=>{yt(w,n(w).textContent=L||"Viewer error")},renderRecord:L=>{yt(w,n(w).textContent=JSON.stringify(L||{},null,2))}}},R=async(j,L="")=>{S(),u(v,j),h=L,g.setLoading(`Loading ${j}${L||""} ...`);try{const J=await cl(j,L);g.renderRecord(J),u(c,"")}catch(J){g.setError(`Failed loading result ${j}: ${J.message}`)}},b=async()=>{if(S(),a().store_results_viewer===!1){u(f,[]),u(l,"Store results viewer unavailable on this backend."),u(c,""),g.setError("Store results endpoint unavailable.");return}try{const j=await ll({limit:200,statusFilter:n(s),nodeFilter:n(i).trim()});if(!j.available){u(f,[]),u(l,j.error||"Store results unavailable."),g.setError(j.error||"Store results unavailable.");return}u(f,j.records||[]);const L=j.summary||{};if(u(l,`${Number(L.total||0)} total | ${Number(L.materialized||0)} materialized | ${Number(L.failed||0)} failed`),u(c,""),n(v)&&n(f).some(J=>J.node_id===n(v))){await R(n(v),h);return}n(f).length?await R(n(f)[0].node_id,""):(u(v,""),h="",g.renderRecord(null))}catch(j){u(f,[]),u(l,`Unable to load results: ${j.message}`),u(c,""),g.setError(`Unable to load result list: ${j.message}`)}},T=()=>{k&&clearTimeout(k),k=setTimeout(()=>{b()},260)},U=j=>{j.key==="Enter"&&b()};wr(()=>(S(),b(),()=>{k&&clearTimeout(k),g&&typeof g.destroy=="function"&&g.destroy()})),St(()=>re(r()),()=>{r()&&b()}),Ir(),er();var C=Xl(),O=d(C),z=d(O),M=d(z),B=p(d(M),2),F=p(M,2),ie=p(d(F),2),H=d(ie);H.value=H.__value="";var be=p(H);be.value=be.__value="materialized";var Ee=p(be);Ee.value=Ee.__value="failed";var Pe=p(ie,2),we=p(F,2),Te=d(we),W=p(we,2);{var I=j=>{var L=Ql(),J=d(L);Q(()=>E(J,n(c))),A(j,L)};ce(W,j=>{n(c)&&j(I)})}var q=p(W,2),ne=d(q);{var ye=j=>{var L=Yl();A(j,L)},$e=j=>{var L=at(),J=Ue(L);it(J,1,()=>n(f),st,(fe,Z)=>{var Ne=Zl(),Le=d(Ne),ae=d(Le),Ve=d(ae),ht=p(ae,2),Se=d(ht),We=p(Le,2),kt=d(We),Et=d(kt),Dt=p(kt,2),_e=d(Dt),gt=p(We,2),tr=d(gt),Be=d(tr),pe=p(tr,2);Q((Tt,Sr)=>{ot(Ne,1,(n(v),n(Z),y(()=>`job-item result-item ${n(v)===n(Z).node_id?"active":""}`))),E(Ve,Tt),ot(ht,1,(n(Z),y(()=>`chip ${n(Z).status}`))),E(Se,(n(Z),y(()=>n(Z).status))),E(Et,(n(Z),y(()=>n(Z).runtime_version||"-"))),E(_e,Sr),E(Be,(n(Z),y(()=>n(Z).updated_at||"-")))},[()=>(n(Z),y(()=>n(Z).node_id.slice(0,16))),()=>(re(Ie),n(Z),y(()=>Ie(Number(n(Z).payload_bytes||0))))]),se("click",pe,()=>R(n(Z).node_id,"")),A(fe,Ne)}),A(j,L)};ce(ne,j=>{n(f),y(()=>!n(f).length)?j(ye):j($e,!1)})}var ve=p(z,2),Me=p(d(ve),4);Lr(Me,j=>u(w,j),()=>n(w)),Q(()=>{ot(C,1,`panel ${r()?"active":""}`),E(Te,n(l))}),se("click",B,b),gn(ie,()=>n(s),j=>u(s,j)),se("change",ie,b),ws(Pe,()=>n(i),j=>u(i,j)),se("input",Pe,T),se("keydown",Pe,U),A(e,C),Lt()}var tc=V("<option> </option>"),rc=V('<div class="muted"> </div>'),nc=V('<div class="muted">No examples for selected module.</div>'),ac=V('<article class="gallery-item"><h3> </h3> <div class="gallery-meta"><span class="mini-chip"> </span> <span class="mini-chip"> </span> <span class="mini-chip"> </span></div> <p class="muted"> </p> <pre class="gallery-code"> </pre> <div class="row gap-s"><button class="btn btn-primary btn-small" type="button">Load</button> <button class="btn btn-ghost btn-small" type="button">Run</button></div></article>'),sc=V('<section id="tab-gallery"><article class="card"><div class="card-header"><h2>Progressive Example Gallery</h2> <div class="row gap-s"><label class="inline-control" for="moduleFilter">Module</label> <select id="moduleFilter" class="select"></select></div></div> <p class="muted">Gallery cards are generated from markdown directives in <code>doc/user/language-gallery.md</code> using <code>&lt;!-- vox:playground ... --&gt;</code> comments.</p> <div id="galleryCards" class="gallery-grid"><!></div></article></section>');function ic(e,t){Mt(t,!1);const r=N();let a=Ae(t,"active",8,!1);const s=Go();let i=N([]),f=N(["all"]),l=N("all"),c=N("");const v=async()=>{try{const M=await fl();u(i,M.examples||[]),u(f,["all",...M.modules||[]]),n(f).includes(n(l))||u(l,"all"),u(c,"")}catch(M){u(i,[]),u(f,["all"]),u(c,`Unable to load gallery: ${M.message}`)}},h=M=>{s("load",{code:M.code,run:!1})},w=M=>{s("load",{code:M.code,run:!0})};wr(()=>{v()}),St(()=>(n(i),n(l)),()=>{u(r,n(i).filter(M=>n(l)==="all"||M.module===n(l)))}),St(()=>re(a()),()=>{a()&&v()}),Ir(),er();var g=sc(),k=d(g),S=d(k),R=p(d(S),2),b=p(d(R),2);it(b,5,()=>n(f),st,(M,B)=>{var F=tc(),ie=d(F),H={};Q(()=>{E(ie,n(B)),H!==(H=n(B))&&(F.value=(F.__value=n(B))??"")}),A(M,F)});var T=p(S,4),U=d(T);{var C=M=>{var B=rc(),F=d(B);Q(()=>E(F,n(c))),A(M,B)},O=M=>{var B=nc();A(M,B)},z=M=>{var B=at(),F=Ue(B);it(F,1,()=>n(r),st,(ie,H)=>{var be=ac(),Ee=d(be),Pe=d(Ee),we=p(Ee,2),Te=d(we),W=d(Te),I=p(Te,2),q=d(I),ne=p(I,2),ye=d(ne),$e=p(we,2),ve=d($e),Me=p($e,2),j=d(Me),L=p(Me,2),J=d(L),fe=p(J,2);Q(()=>{E(Pe,(n(H),y(()=>n(H).title))),E(W,(n(H),y(()=>n(H).module))),E(q,(n(H),y(()=>n(H).level))),E(ye,(n(H),y(()=>n(H).strategy||"dask"))),E(ve,(n(H),y(()=>n(H).description||""))),E(j,(n(H),y(()=>n(H).code)))}),se("click",J,()=>h(n(H))),se("click",fe,()=>w(n(H))),A(ie,be)}),A(M,B)};ce(U,M=>{n(c)?M(C):(n(r),y(()=>!n(r).length)?M(O,1):M(z,!1))})}Q(()=>ot(g,1,`panel ${a()?"active":""}`)),gn(b,()=>n(l),M=>u(l,M)),A(e,g),Lt()}var oc=V('<div class="muted"> </div>'),lc=V('<div class="bar-row"><div class="meta"><span> </span> <strong> </strong></div> <div class="bar-bg"><div class="bar-fill"></div></div></div>');function wn(e,t){Mt(t,!1);const r=N();let a=Ae(t,"items",24,()=>[]),s=Ae(t,"valueField",8,"value"),i=Ae(t,"labelField",8,"label"),f=Ae(t,"formatter",8,g=>`${g}`),l=Ae(t,"emptyMessage",8,"No data yet.");St(()=>(re(a()),re(s())),()=>{u(r,Math.max(1,...a().map(g=>Number(g?.[s()]||0))))}),Ir(),er();var c=at(),v=Ue(c);{var h=g=>{var k=oc(),S=d(k);Q(()=>E(S,l())),A(g,k)},w=g=>{var k=at(),S=Ue(k);it(S,1,a,st,(R,b)=>{const T=De(()=>(n(b),re(s()),y(()=>Number(n(b)?.[s()]||0)))),U=De(()=>n(T)/n(r)*100);var C=lc(),O=d(C),z=d(O),M=d(z),B=p(z,2),F=d(B),ie=p(O,2),H=d(ie);Q((be,Ee)=>{E(M,(n(b),re(i()),y(()=>n(b)?.[i()]))),E(F,be),zo(H,Ee)},[()=>(re(f()),re(n(T)),y(()=>f()(n(T)))),()=>(re(n(U)),y(()=>`width: ${n(U).toFixed(2)}%`))]),A(R,C)}),A(g,k)};ce(v,g=>{re(a()),y(()=>!a().length)?g(h):g(w,!1)})}A(e,c),Lt()}var cc=V('<img id="perfChart" class="perf-chart" alt="Performance comparison chart"/>'),uc=V('<img id="primitivePerfChart" class="perf-chart" alt="Primitive benchmark histogram"/>'),fc=V('<div class="muted"> </div>'),dc=V('<div class="muted"> </div>'),vc=V('<div class="muted">No test jobs started from UI yet.</div>'),_c=V('<button class="btn btn-danger btn-small" type="button">Kill</button>'),pc=V('<article class="job-item"><div class="job-row"><strong> </strong> <span> </span></div> <div class="job-row"><span> </span> <span> </span></div> <div class="job-row"><span> </span> <!></div></article>'),hc=V('<div class="muted">No junit report loaded.</div>'),gc=V('<article class="table-like-row"><div class="name"> </div> <div class="detail"> </div></article>'),mc=V('<div class="muted">No failures in current report.</div>'),bc=V('<article class="table-like-row"><div class="name"> </div> <div class="detail"> </div></article>'),yc=V('<section id="tab-quality"><div class="grid-two"><article class="card"><div class="card-header"><h2>Test &amp; Coverage Overview</h2> <div class="row gap-s"><button id="refreshQualityBtn" class="btn btn-ghost btn-small" type="button">Refresh</button> <!></div></div> <div class="row controls"><button id="runQuickTestsBtn" class="btn btn-ghost btn-small" type="button">Run Quick</button> <button id="runFullTestsBtn" class="btn btn-primary btn-small" type="button">Run Full</button> <button id="runPerfTestsBtn" class="btn btn-ghost btn-small" type="button">Run Perf</button> <button id="killTestRunBtn" class="btn btn-danger btn-small" type="button">Kill Test Run</button></div> <div class="stats-grid"><div class="stat"><span class="label">Total Tests</span><strong id="qTotalTests"> </strong></div> <div class="stat"><span class="label">Passed</span><strong id="qPassed"> </strong></div> <div class="stat"><span class="label">Failed</span><strong id="qFailed"> </strong></div> <div class="stat"><span class="label">Skipped</span><strong id="qSkipped"> </strong></div> <div class="stat"><span class="label">Duration</span><strong id="qDuration"> </strong></div> <div class="stat"><span class="label">Line Coverage</span><strong id="qCoverage"> </strong></div></div> <h3 class="subheading">Lowest Coverage Packages</h3> <div id="coverageBars" class="bars"><!></div></article> <article class="card"><h2>VoxLogicA-1 vs VoxLogicA-2 Performance</h2> <!> <div id="perfSummary" class="muted"> </div> <h3 class="subheading">Primitive Benchmark Histogram</h3> <!> <div id="primitivePerfBars" class="bars"><!></div></article></div> <div class="grid-two"><article class="card"><h2>Test Run Logs</h2> <pre id="testRunLog" class="mono-scroll"> </pre> <h3 class="subheading">Recent Test Jobs</h3> <div id="recentTestJobs" class="job-list"><!></div></article> <article class="card"><h2>Test Titles</h2> <div id="testTitles" class="table-like muted"><!></div></article></div> <article class="card"><h2>Failing Test Cases</h2> <div id="failedCases" class="table-like muted"><!></div></article></section>');function wc(e,t){Mt(t,!1);let r=Ae(t,"active",8,!1),a=Ae(t,"capabilities",24,()=>({})),s=N("idle"),i=N(!1),f="",l=N(""),c=N([]),v=N(""),h=N({}),w=N({}),g=N([]),k=N([]),S=N([]),R=N("No performance report yet."),b=N(""),T=N(""),U=N([]),C=N("No primitive benchmark report yet."),O=null,z=null;const M=$=>{u(i,!1),u(s,"unavailable"),u(l,$)},B=async()=>{try{const $=await dl(),G=$?.junit||{},de=$?.coverage||{},he=$?.performance||{};if(u(h,G.summary||{}),u(w,de.summary||{}),u(g,de.lowest_modules||[]),u(k,G.failed_cases||[]),u(S,G.test_cases||[]),he.available){const X=Number(he.speed_ratio||0),ge=Number(he.vox1_median_s||0),Ge=Number(he.vox2_median_s||0),ct=Number(he.vox1_cpu_median_s||0),Oe=Number(he.vox2_cpu_median_s||0),Ce=Number(he.vox1_ru_maxrss_delta_median_bytes||0),Vt=Number(he.vox2_ru_maxrss_delta_median_bytes||0);let Ke="";const sr=he.test_metrics||{};if(sr.available){const ir=sr.tests||[];Ke=` | perf tests: ${Number(sr.count||ir.length)} | median util: ${Rs(sa(ir.map(qt=>Number(qt.cpu_utilization))))} | median heap: ${Ie(sa(ir.map(qt=>Number(qt.python_heap_peak_bytes))))} | median rss delta: ${Ie(sa(ir.map(qt=>Number(qt.ru_maxrss_delta_bytes))))}`}u(R,`vox1 median: ${lt(ge)} (cpu ${lt(ct)}, rss ${Ie(Ce)}) | vox2 median: ${lt(Ge)} (cpu ${lt(Oe)}, rss ${Ie(Vt)}) | ratio vox1/vox2: ${X.toFixed(2)}x${Ke}`),u(b,`/api/v1/testing/performance/chart?t=${Date.now()}`);const Bt=he.primitive_benchmarks||{};Bt.available?(u(U,Bt.cases||[]),u(C,""),u(T,Bt.svg_available?`/api/v1/testing/performance/primitive-chart?t=${Date.now()}`:"")):(u(U,[]),u(C,Bt.reason||"No primitive benchmark report yet."),u(T,""))}else u(R,"No performance report yet. Run `./tests/run-tests.sh` with perf tests enabled."),u(b,""),u(T,""),u(U,[]),u(C,"No primitive benchmark report yet.")}catch($){u(R,`Failed loading report: ${$.message}`)}},F=async()=>{try{const $=await vl();u(c,$.jobs||[]),u(v,"")}catch($){u(c,[]),u(v,`Failed to load test jobs: ${$.message}`)}},ie=async()=>{if(f)try{const $=await _l(f);if(u(s,$.status),u(l,$.log_tail||""),$.status==="running")return;u(i,!1),z&&(clearInterval(z),z=null),await Promise.all([B(),F()])}catch($){u(i,!1),u(s,"failed"),u(l,`Unable to poll test job: ${$.message}`),z&&(clearInterval(z),z=null)}},H=async($,G)=>{if(a().testing_jobs===!1){M("Testing jobs API unavailable. Restart `./voxlogica serve` from latest code.");return}try{u(i,!0),u(s,"running"),u(l,"");const de=await pl({profile:$,includePerf:G});f=de.job_id,u(l,de.log_tail||""),z&&clearInterval(z),z=setInterval(ie,1200),await Promise.all([ie(),F()])}catch(de){u(i,!1),u(s,"failed"),u(l,`Unable to start test run: ${de.message}`)}},be=async()=>{if(f)try{const $=await Ns(f);u(i,!1),u(s,$.status),u(l,$.log_tail||""),z&&(clearInterval(z),z=null),await F()}catch($){u(l,`Unable to kill current test job: ${$.message}`)}},Ee=async $=>{try{await Ns($),f===$&&(f="",u(i,!1),u(s,"killed")),await F()}catch(G){u(v,`Unable to kill ${$}: ${G.message}`)}},Pe=()=>{O&&(clearInterval(O),O=null),O=setInterval(()=>{r()&&(B(),F(),ie())},15e3)},we=async()=>{await Promise.all([B(),F()])};wr(async()=>{await we(),Pe()}),Es(()=>{O&&clearInterval(O),z&&clearInterval(z)}),St(()=>re(r()),()=>{r()&&(we(),Pe())}),St(()=>re(a()),()=>{a().testing_jobs===!1&&M("This backend does not expose testing jobs. Restart server from latest commit.")}),Ir(),er();var Te=yc(),W=d(Te),I=d(W),q=d(I),ne=p(d(q),2),ye=d(ne),$e=p(ye,2);Ms($e,{get value(){return n(s)}});var ve=p(q,2),Me=d(ve),j=p(Me,2),L=p(j,2),J=p(L,2),fe=p(ve,2),Z=d(fe),Ne=p(d(Z)),Le=d(Ne),ae=p(Z,2),Ve=p(d(ae)),ht=d(Ve),Se=p(ae,2),We=p(d(Se)),kt=d(We),Et=p(Se,2),Dt=p(d(Et)),_e=d(Dt),gt=p(Et,2),tr=p(d(gt)),Be=d(tr),pe=p(gt,2),Tt=p(d(pe)),Sr=d(Tt),zt=p(fe,4),ia=d(zt);wn(ia,{get items(){return n(g)},valueField:"line_percent",labelField:"name",formatter:$=>`${Number($).toFixed(2)}%`});var rr=p(I,2),mt=p(d(rr),2);{var Sn=$=>{var G=cc();Q(()=>bs(G,"src",n(b))),A($,G)};ce(mt,$=>{n(b)&&$(Sn)})}var Kr=p(mt,2),xn=d(Kr),Qr=p(Kr,4);{var kn=$=>{var G=uc();Q(()=>bs(G,"src",n(T))),A($,G)};ce(Qr,$=>{n(T)&&$(kn)})}var En=p(Qr,2),oa=d(En);{var Tn=$=>{wn($,{get items(){return n(U)},valueField:"speed_ratio",labelField:"name",formatter:G=>`${Number(G).toFixed(3)}x`})},$n=$=>{var G=fc(),de=d(G);Q(()=>E(de,n(C))),A($,G)};ce(oa,$=>{n(U),y(()=>n(U).length)?$(Tn):$($n,!1)})}var $t=p(W,2),bt=d($t),nr=p(d(bt),2),Yr=d(nr),Nn=p(nr,4),Jt=d(Nn);{var Rn=$=>{var G=dc(),de=d(G);Q(()=>E(de,n(v))),A($,G)},la=$=>{var G=vc();A($,G)},Pn=$=>{var G=at(),de=Ue(G);it(de,1,()=>n(c),st,(he,X)=>{var ge=pc(),Ge=d(ge),ct=d(Ge),Oe=d(ct),Ce=p(ct,2),Vt=d(Ce),Ke=p(Ge,2),sr=d(Ke),Bt=d(sr),ir=p(sr,2),qt=d(ir),ua=p(Ke,2),In=d(ua),fa=d(In),da=p(In,2);{var Mn=or=>{var rn=_c();se("click",rn,()=>Ee(n(X).job_id)),A(or,rn)};ce(da,or=>{n(X),y(()=>n(X).status==="running")&&or(Mn)})}Q(or=>{E(Oe,or),ot(Ce,1,(n(X),y(()=>`chip ${n(X).status}`))),E(Vt,(n(X),y(()=>n(X).status))),E(Bt,(n(X),y(()=>n(X).profile))),E(qt,(n(X),y(()=>n(X).include_perf?"with perf":"no perf"))),E(fa,(n(X),y(()=>n(X).created_at||"-")))},[()=>(n(X),y(()=>String(n(X).job_id||"").slice(0,12)))]),A(he,ge)}),A($,G)};ce(Jt,$=>{n(v)?$(Rn):(n(c),y(()=>!n(c).length)?$(la,1):$(Pn,!1))})}var Nt=p(bt,2),ca=p(d(Nt),2),Cn=d(ca);{var Zr=$=>{var G=hc();A($,G)},An=$=>{var G=at(),de=Ue(G);it(de,1,()=>(n(S),y(()=>n(S).slice(0,200))),st,(he,X)=>{var ge=gc(),Ge=d(ge),ct=d(Ge),Oe=p(Ge,2),Ce=d(Oe);Q(Vt=>{E(ct,(n(X),y(()=>n(X).id))),E(Ce,`status=${n(X),y(()=>n(X).status)??""} | time=${Vt??""}`)},[()=>(re(lt),n(X),y(()=>lt(Number(n(X).time_s||0))))]),A(he,ge)}),A($,G)};ce(Cn,$=>{n(S),y(()=>!n(S).length)?$(Zr):$(An,!1)})}var Or=p($t,2),ar=p(d(Or),2),Xr=d(ar);{var en=$=>{var G=mc();A($,G)},tn=$=>{var G=at(),de=Ue(G);it(de,1,()=>n(k),st,(he,X)=>{var ge=bc(),Ge=d(ge),ct=d(Ge),Oe=p(Ge,2),Ce=d(Oe);Q(()=>{E(ct,(n(X),y(()=>n(X).id))),E(Ce,(n(X),y(()=>n(X).message||"Failure without message")))}),A(he,ge)}),A($,G)};ce(Xr,$=>{n(k),y(()=>!n(k).length)?$(en):$(tn,!1)})}Q(($,G,de,he,X,ge)=>{ot(Te,1,`panel ${r()?"active":""}`),Me.disabled=(n(i),re(a()),y(()=>n(i)||a().testing_jobs===!1)),j.disabled=(n(i),re(a()),y(()=>n(i)||a().testing_jobs===!1)),L.disabled=(n(i),re(a()),y(()=>n(i)||a().testing_jobs===!1)),J.disabled=!n(i),E(Le,$),E(ht,G),E(kt,de),E(_e,he),E(Be,X),E(Sr,`${ge??""}%`),E(xn,n(R)),E(Yr,n(l))},[()=>(n(h),y(()=>Number(n(h).total||0))),()=>(n(h),y(()=>Number(n(h).passed||0))),()=>(n(h),y(()=>Number(n(h).failed||0))),()=>(n(h),y(()=>Number(n(h).skipped||0))),()=>(re(lt),n(h),y(()=>lt(Number(n(h).duration_s||0)))),()=>(n(w),y(()=>Number(n(w).line_percent||0).toFixed(2)))]),se("click",ye,we),se("click",Me,()=>H("quick",!1)),se("click",j,()=>H("full",!0)),se("click",L,()=>H("perf",!0)),se("click",J,be),A(e,Te),Lt()}var Sc=V('<div class="inline-error"> </div>'),xc=V('<section id="tab-storage"><div class="grid-two"><article class="card"><div class="card-header"><h2>Cache Footprint</h2> <button id="refreshStorageBtn" class="btn btn-ghost btn-small" type="button">Refresh</button></div> <div class="stats-grid"><div class="stat"><span class="label">Cached Records</span> <strong id="sTotal"> </strong></div> <div class="stat"><span class="label">Materialized</span> <strong id="sMaterialized"> </strong></div> <div class="stat"><span class="label">Failed</span> <strong id="sFailed"> </strong></div> <div class="stat"><span class="label">Average Payload</span> <strong id="sAvgPayload"> </strong></div> <div class="stat"><span class="label">Total Payload</span> <strong id="sTotalPayload"> </strong></div> <div class="stat"><span class="label">Database Size</span> <strong id="sDbSize"> </strong></div></div> <p id="storageMeta" class="muted"> </p> <!></article> <article class="card"><h2>Payload Size Distribution</h2> <div id="payloadBuckets" class="bars"><!></div> <h3 class="subheading">Runtime Versions</h3> <div id="runtimeVersions" class="bars"><!></div></article></div></section>');function kc(e,t){Mt(t,!1);let r=Ae(t,"active",8,!1),a=N(null),s=N(null),i=N(null),f=N(""),l=N("");const c=async()=>{try{const J=await hl();if(u(a,J),!J.available){u(l,J.error||"Storage stats unavailable."),u(f,n(l)),u(s,null),u(i,null);return}u(l,""),u(s,J.summary||{}),u(i,J.disk||{}),u(f,`${J.db_path} | last update ${n(s).last_update_at||"-"}`)}catch(J){u(l,`Failed loading storage stats: ${J.message}`),u(f,n(l)),u(s,null),u(i,null)}};wr(()=>{c()}),St(()=>re(r()),()=>{r()&&c()}),Ir(),er();var v=xc(),h=d(v),w=d(h),g=d(w),k=p(d(g),2),S=p(g,2),R=d(S),b=p(d(R),2),T=d(b),U=p(R,2),C=p(d(U),2),O=d(C),z=p(U,2),M=p(d(z),2),B=d(M),F=p(z,2),ie=p(d(F),2),H=d(ie),be=p(F,2),Ee=p(d(be),2),Pe=d(Ee),we=p(be,2),Te=p(d(we),2),W=d(Te),I=p(S,2),q=d(I),ne=p(I,2);{var ye=J=>{var fe=Sc(),Z=d(fe);Q(()=>E(Z,n(l))),A(J,fe)};ce(ne,J=>{n(l)&&J(ye)})}var $e=p(w,2),ve=p(d($e),2),Me=d(ve);{let J=De(()=>(n(a),y(()=>n(a)?.payload_buckets||[])));wn(Me,{get items(){return n(J)},valueField:"count",labelField:"bucket",formatter:fe=>`${fe}`})}var j=p(ve,4),L=d(j);{let J=De(()=>(n(a),y(()=>n(a)?.runtime_versions||[])));wn(L,{get items(){return n(J)},valueField:"count",labelField:"runtime_version",formatter:fe=>`${fe}`})}Q((J,fe,Z,Ne,Le,ae)=>{ot(v,1,`panel ${r()?"active":""}`),E(T,J),E(O,fe),E(B,Z),E(H,Ne),E(Pe,Le),E(W,ae),E(q,n(f))},[()=>(n(s),y(()=>n(s)?Number(n(s).total_records||0):"-")),()=>(n(s),y(()=>n(s)?Number(n(s).materialized_records||0):"-")),()=>(n(s),y(()=>n(s)?Number(n(s).failed_records||0):"-")),()=>(n(s),re(Ie),y(()=>n(s)?Ie(Number(n(s).avg_payload_bytes||0)):"-")),()=>(n(s),re(Ie),y(()=>n(s)?Ie(Number(n(s).total_payload_bytes||0)):"-")),()=>(n(i),re(Ie),y(()=>n(i)?Ie(Number(n(i).db_bytes||0)+Number(n(i).wal_bytes||0)):"-"))]),se("click",k,c),A(e,v),Lt()}var Ec=V('<button type="button"> </button>'),Tc=V('<div class="background-layer"></div> <div class="shell"><header class="topbar"><div><p class="eyebrow">VoxLogicA Serve</p> <h1>VoxLogicA Studio Console</h1></div> <div class="topbar-meta"><span id="buildStamp" class="chip"> </span></div></header> <nav class="tabbar" aria-label="Main pages"></nav> <main class="content"><!> <!> <!> <!> <!></main></div>',1);function $c(e,t){Mt(t,!1);const r=[{id:"playground",label:"Playground"},{id:"results",label:"Results Explorer"},{id:"gallery",label:"Example Gallery"},{id:"quality",label:"Test Intelligence"},{id:"storage",label:"Storage Stats"}];let a=N("playground"),s=N({}),i=N("Loading..."),f=!1,l=[],c=null,v=!1;const h=300,w=40;let g=N();const k=W=>W.map(I=>{if(I instanceof Error)return I.stack||I.message||String(I);if(typeof I=="string")return I;try{return JSON.stringify(I)}catch{return String(I)}}).join(" "),S=async()=>{if(v||!l.length)return;v=!0;const W=l.splice(0,w);try{await el(W)}catch{l=[...W,...l].slice(-h)}finally{v=!1,l.length&&(c&&clearTimeout(c),c=setTimeout(S,800))}},R=(W,I,q=null)=>{l.push({level:W,message:k(I),source:"browser-console",url:window.location.href,ts:new Date().toISOString(),user_agent:navigator.userAgent,payload:q}),l.length>h&&(l=l.slice(-h)),c&&clearTimeout(c),c=setTimeout(S,250)},b=()=>{if(f||typeof window>"u"||typeof window.WebSocket>"u")return;f=!0;const W=["log","info","warn","error","debug"];for(const I of W){const q=console[I]?console[I].bind(console):console.log.bind(console);console[I]=(...ne)=>{q(...ne),R(I,ne)}}window.addEventListener("error",I=>{R("error",[I.message||"window error"],{filename:I.filename,lineno:I.lineno,colno:I.colno})}),window.addEventListener("unhandledrejection",I=>{const q=I.reason;R("error",["unhandledrejection",q instanceof Error?q.stack||q.message:q],null)})},T=()=>{const W=window.location.protocol==="https:"?"wss":"ws",I=new WebSocket(`${W}://${window.location.host}/livereload`);I.onmessage=q=>{q.data==="reload"&&window.location.reload()},I.onclose=()=>{setTimeout(T,2e3)}},U=async W=>{const I=String(W.detail?.code||""),q=!!W.detail?.run;u(a,"playground"),n(g)&&typeof n(g).loadProgram=="function"&&await n(g).loadProgram(I,q)};wr(async()=>{b();try{const[W,I]=await Promise.all([Zo(),Xo()]);u(s,W||{}),u(i,`v${I.version||"unknown"}`)}catch{u(i,"version unavailable")}T()}),er();var C=Tc(),O=p(Ue(C),2),z=d(O),M=p(d(z),2),B=d(M),F=d(B),ie=p(z,2);it(ie,5,()=>r,st,(W,I)=>{var q=Ec(),ne=d(q);Q(ye=>{ot(q,1,ye),E(ne,n(I).label)},[()=>gs(`tab ${n(a)===n(I).id?"active":""}`.trim())]),se("click",q,()=>u(a,n(I).id)),A(W,q)});var H=p(ie,2),be=d(H);{let W=De(()=>n(a)==="playground");Lr(Kl(be,{get active(){return n(W)},get capabilities(){return n(s)},$$legacy:!0}),I=>u(g,I),()=>n(g))}var Ee=p(be,2);{let W=De(()=>n(a)==="results");ec(Ee,{get active(){return n(W)},get capabilities(){return n(s)}})}var Pe=p(Ee,2);{let W=De(()=>n(a)==="gallery");ic(Pe,{get active(){return n(W)},$$events:{load:U}})}var we=p(Pe,2);{let W=De(()=>n(a)==="quality");wc(we,{get active(){return n(W)},get capabilities(){return n(s)}})}var Te=p(we,2);{let W=De(()=>n(a)==="storage");kc(Te,{get active(){return n(W)}})}Q(()=>E(F,n(i))),A(e,C),Lt()}const Ls=document.getElementById("app");if(!(Ls instanceof HTMLElement))throw new Error("Missing #app root element.");Po($c,{target:Ls})})();
