(function(){"use strict";const qs=globalThis.process?.env?.NODE_ENV,L=qs&&!qs.toLowerCase().startsWith("prod");var Qr=Array.isArray,Vi=Array.prototype.indexOf,wr=Array.prototype.includes,Sn=Array.from,rr=Object.defineProperty,nr=Object.getOwnPropertyDescriptor,Bs=Object.getOwnPropertyDescriptors,Ui=Object.prototype,Ji=Array.prototype,Zn=Object.getPrototypeOf,Vs=Object.isExtensible;const Hi=()=>{};function Wi(e){return e()}function Xn(e){for(var t=0;t<e.length;t++)e[t]()}function Us(){var e,t,r=new Promise((s,a)=>{e=s,t=a});return{promise:r,resolve:e,reject:t}}const Be=2,Zr=4,Xr=8,Js=1<<24,qt=16,Et=32,xr=64,es=128,pt=512,je=1024,Ve=2048,_t=4096,st=8192,Bt=16384,Sr=32768,zr=65536,kn=1<<17,Hs=1<<18,qr=1<<19,Ws=1<<20,Vt=1<<25,sr=65536,ts=1<<21,En=1<<22,ar=1<<23,Ut=Symbol("$state"),Gi=Symbol("legacy props"),Ki=Symbol(""),Gs=Symbol("proxy path"),kr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function rs(e){if(L){const t=new Error(`lifecycle_outside_component
\`${e}(...)\` can only be used during component initialisation
https://svelte.dev/e/lifecycle_outside_component`);throw t.name="Svelte error",t}else throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Yi(){if(L){const e=new Error("async_derived_orphan\nCannot create a `$derived(...)` with an `await` expression outside of an effect tree\nhttps://svelte.dev/e/async_derived_orphan");throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ks(){if(L){const e=new Error("bind_invalid_checkbox_value\nUsing `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\nhttps://svelte.dev/e/bind_invalid_checkbox_value");throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/bind_invalid_checkbox_value")}function Qi(){if(L){const e=new Error(`derived_references_self
A derived value cannot reference itself recursively
https://svelte.dev/e/derived_references_self`);throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/derived_references_self")}function Ys(e,t,r){if(L){const s=new Error(`each_key_duplicate
${r?`Keyed each block has duplicate key \`${r}\` at indexes ${e} and ${t}`:`Keyed each block has duplicate key at indexes ${e} and ${t}`}
https://svelte.dev/e/each_key_duplicate`);throw s.name="Svelte error",s}else throw new Error("https://svelte.dev/e/each_key_duplicate")}function Zi(e,t,r){if(L){const s=new Error(`each_key_volatile
Keyed each block has key that is not idempotent â€” the key for item at index ${e} was \`${t}\` but is now \`${r}\`. Keys must be the same each time for a given item
https://svelte.dev/e/each_key_volatile`);throw s.name="Svelte error",s}else throw new Error("https://svelte.dev/e/each_key_volatile")}function Xi(e){if(L){const t=new Error(`effect_in_teardown
\`${e}\` cannot be used inside an effect cleanup function
https://svelte.dev/e/effect_in_teardown`);throw t.name="Svelte error",t}else throw new Error("https://svelte.dev/e/effect_in_teardown")}function eo(){if(L){const e=new Error("effect_in_unowned_derived\nEffect cannot be created inside a `$derived` value that was not itself created inside an effect\nhttps://svelte.dev/e/effect_in_unowned_derived");throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function to(e){if(L){const t=new Error(`effect_orphan
\`${e}\` can only be used inside an effect (e.g. during component initialisation)
https://svelte.dev/e/effect_orphan`);throw t.name="Svelte error",t}else throw new Error("https://svelte.dev/e/effect_orphan")}function ro(){if(L){const e=new Error(`effect_update_depth_exceeded
Maximum update depth exceeded. This typically indicates that an effect reads and writes the same piece of state
https://svelte.dev/e/effect_update_depth_exceeded`);throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function no(e){if(L){const t=new Error(`props_invalid_value
Cannot do \`bind:${e}={undefined}\` when \`${e}\` has a fallback value
https://svelte.dev/e/props_invalid_value`);throw t.name="Svelte error",t}else throw new Error("https://svelte.dev/e/props_invalid_value")}function so(e){if(L){const t=new Error(`rune_outside_svelte
The \`${e}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files
https://svelte.dev/e/rune_outside_svelte`);throw t.name="Svelte error",t}else throw new Error("https://svelte.dev/e/rune_outside_svelte")}function ao(){if(L){const e=new Error("state_descriptors_fixed\nProperty descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\nhttps://svelte.dev/e/state_descriptors_fixed");throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function io(){if(L){const e=new Error("state_prototype_fixed\nCannot set prototype of `$state` object\nhttps://svelte.dev/e/state_prototype_fixed");throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/state_prototype_fixed")}function oo(){if(L){const e=new Error("state_unsafe_mutation\nUpdating state inside `$derived(...)`, `$inspect(...)` or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\nhttps://svelte.dev/e/state_unsafe_mutation");throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function lo(){if(L){const e=new Error("svelte_boundary_reset_onerror\nA `<svelte:boundary>` `reset` function cannot be called while an error is still being handled\nhttps://svelte.dev/e/svelte_boundary_reset_onerror");throw e.name="Svelte error",e}else throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const co=1,uo=2,Qs=4,fo=8,vo=16,po=1,_o=2,ho=4,go=8,mo=16,bo=1,yo=2,Ue=Symbol(),wo=Symbol("filename"),Zs="http://www.w3.org/1999/xhtml",xo="http://www.w3.org/2000/svg",So="http://www.w3.org/1998/Math/MathML";var ns="font-weight: bold",ss="font-weight: normal";function ko(){L?console.warn("%c[svelte] select_multiple_invalid_value\n%cThe `value` property of a `<select multiple>` element should be an array, but it received a non-array value. The selection will be kept as is.\nhttps://svelte.dev/e/select_multiple_invalid_value",ns,ss):console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function as(e){L?console.warn(`%c[svelte] state_proxy_equality_mismatch
%cReactive \`$state(...)\` proxies and the values they proxy have different identities. Because of this, comparisons with \`${e}\` will produce unexpected results
https://svelte.dev/e/state_proxy_equality_mismatch`,ns,ss):console.warn("https://svelte.dev/e/state_proxy_equality_mismatch")}function Eo(){L?console.warn("%c[svelte] svelte_boundary_reset_noop\n%cA `<svelte:boundary>` `reset` function only resets the boundary the first time it is called\nhttps://svelte.dev/e/svelte_boundary_reset_noop",ns,ss):console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Xs(e){return e===this.v}function To(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ea(e){return!To(e,this.v)}let Br=!1,$o=!1;function No(){Br=!0}function At(e,t){return e.label=t,ta(e.v,t),e}function ta(e,t){return e?.[Gs]?.(t),e}function Ro(e){const t=new Error,r=Co();return r.length===0?null:(r.unshift(`
`),rr(t,"stack",{value:r.join(`
`)}),rr(t,"name",{value:e}),t)}function Co(){const e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;const t=new Error().stack;if(Error.stackTraceLimit=e,!t)return[];const r=t.split(`
`),s=[];for(let a=0;a<r.length;a++){const i=r[a],l=i.replaceAll("\\","/");if(i.trim()!=="Error"){if(i.includes("validate_each_keys"))return[];l.includes("svelte/src/internal")||l.includes("node_modules/.vite")||s.push(i)}}return s}let me=null;function Vr(e){me=e}let en=null;function Tn(e){en=e}let tn=null;function ra(e){tn=e}function Tt(e,t=!1,r){me={p:me,i:!1,c:null,e:null,s:e,x:null,l:Br&&!t?{s:null,u:null,$:[]}:null},L&&(me.function=r,tn=r)}function $t(e){var t=me,r=t.e;if(r!==null){t.e=null;for(var s of r)Ta(s)}return e!==void 0&&(t.x=e),t.i=!0,me=t.p,L&&(tn=me?.function??null),e??{}}function rn(){return!Br||me!==null&&me.l===null}let Er=[];function na(){var e=Er;Er=[],Xn(e)}function Jt(e){if(Er.length===0&&!nn){var t=Er;queueMicrotask(()=>{t===Er&&na()})}Er.push(e)}function Po(){for(;Er.length>0;)na()}const is=new WeakMap;function sa(e){var t=ce;if(t===null)return ve.f|=ar,e;if(L&&e instanceof Error&&!is.has(e)&&is.set(e,Ao(e,t)),(t.f&Sr)===0&&(t.f&Zr)===0)throw L&&!t.parent&&e instanceof Error&&aa(e),e;ir(e,t)}function ir(e,t){for(;t!==null;){if((t.f&es)!==0){if((t.f&Sr)===0)throw e;try{t.b.error(e);return}catch(r){e=r}}t=t.parent}throw L&&e instanceof Error&&aa(e),e}function Ao(e,t){const r=nr(e,"message");if(!(r&&!r.configurable)){for(var s=vs?"  ":"	",a=`
${s}in ${t.fn?.name||"<unknown>"}`,i=t.ctx;i!==null;)a+=`
${s}in ${i.function?.[wo].split("/").pop()}`,i=i.p;return{message:e.message+`
${a}
`,stack:e.stack?.split(`
`).filter(l=>!l.includes("svelte/src/internal")).join(`
`)}}}function aa(e){const t=is.get(e);t&&(rr(e,"message",{value:t.message}),rr(e,"stack",{value:t.stack}))}const Mo=-7169;function Ne(e,t){e.f=e.f&Mo|t}function os(e){(e.f&pt)!==0||e.deps===null?Ne(e,je):Ne(e,_t)}function ia(e){if(e!==null)for(const t of e)(t.f&Be)===0||(t.f&sr)===0||(t.f^=sr,ia(t.deps))}function oa(e,t,r){(e.f&Ve)!==0?t.add(e):(e.f&_t)!==0&&r.add(e),ia(e.deps),Ne(e,je)}const $n=new Set;let _e=null,Nn=null,Nt=null,et=[],Rn=null,ls=!1,nn=!1;class or{current=new Map;previous=new Map;#t=new Set;#o=new Set;#e=0;#i=0;#n=null;#a=new Set;#r=new Set;#s=new Map;is_fork=!1;#l=!1;#u(){return this.is_fork||this.#i>0}skip_effect(t){this.#s.has(t)||this.#s.set(t,{d:[],m:[]})}unskip_effect(t){var r=this.#s.get(t);if(r){this.#s.delete(t);for(var s of r.d)Ne(s,Ve),Rt(s);for(s of r.m)Ne(s,_t),Rt(s)}}process(t){et=[],this.apply();var r=[],s=[];for(const a of t)this.#c(a,r,s);if(this.#u()){this.#d(s),this.#d(r);for(const[a,i]of this.#s)da(a,i)}else{for(const a of this.#t)a();this.#t.clear(),this.#e===0&&this.#v(),Nn=this,_e=null,ca(s),ca(r),this.#a.clear(),this.#r.clear(),Nn=null,this.#n?.resolve()}Nt=null}#c(t,r,s){t.f^=je;for(var a=t.first;a!==null;){var i=a.f,l=(i&(Et|xr))!==0,c=l&&(i&je)!==0,u=c||(i&st)!==0||this.#s.has(a);if(!u&&a.fn!==null){l?a.f^=je:(i&Zr)!==0?r.push(a):Wr(a)&&((i&qt)!==0&&this.#r.add(a),Mr(a));var v=a.first;if(v!==null){a=v;continue}}for(;a!==null;){var h=a.next;if(h!==null){a=h;break}a=a.parent}}}#d(t){for(var r=0;r<t.length;r+=1)oa(t[r],this.#a,this.#r)}capture(t,r){r!==Ue&&!this.previous.has(t)&&this.previous.set(t,r),(t.f&ar)===0&&(this.current.set(t,t.v),Nt?.set(t,t.v))}activate(){_e=this,this.apply()}deactivate(){_e===this&&(_e=null,Nt=null)}flush(){if(this.activate(),et.length>0){if(la(),_e!==null&&_e!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#o)t(this);this.#o.clear()}#v(){if($n.size>1){this.previous.clear();var t=Nt,r=!0;for(const a of $n){if(a===this){r=!1;continue}const i=[];for(const[c,u]of this.current){if(a.current.has(c))if(r&&u!==a.current.get(c))a.current.set(c,u);else continue;i.push(c)}if(i.length===0)continue;const l=[...a.current.keys()].filter(c=>!this.current.has(c));if(l.length>0){var s=et;et=[];const c=new Set,u=new Map;for(const v of i)ua(v,l,c,u);if(et.length>0){_e=a,a.apply();for(const v of et)a.#c(v,[],[]);a.deactivate()}et=s}}_e=null,Nt=t}this.#s.clear(),$n.delete(this)}increment(t){this.#e+=1,t&&(this.#i+=1)}decrement(t){this.#e-=1,t&&(this.#i-=1),!this.#l&&(this.#l=!0,Jt(()=>{this.#l=!1,this.#u()?et.length>0&&this.flush():this.revive()}))}revive(){for(const t of this.#a)this.#r.delete(t),Ne(t,Ve),Rt(t);for(const t of this.#r)Ne(t,_t),Rt(t);this.flush()}oncommit(t){this.#t.add(t)}ondiscard(t){this.#o.add(t)}settled(){return(this.#n??=Us()).promise}static ensure(){if(_e===null){const t=_e=new or;$n.add(_e),nn||Jt(()=>{_e===t&&t.flush()})}return _e}apply(){}}function Lo(e){var t=nn;nn=!0;try{for(var r;;){if(Po(),et.length===0&&(_e?.flush(),et.length===0))return Rn=null,r;la()}}finally{nn=t}}function la(){ls=!0;var e=L?new Set:null;try{for(var t=0;et.length>0;){var r=or.ensure();if(t++>1e3){if(L){var s=new Map;for(const i of r.current.keys())for(const[l,c]of i.updated??[]){var a=s.get(l);a||(a={error:c.error,count:0},s.set(l,a)),a.count+=c.count}for(const i of s.values())i.error&&console.error(i.error)}Io()}if(r.process(et),lr.clear(),L)for(const i of r.current.keys())e.add(i)}}finally{if(et=[],ls=!1,Rn=null,L)for(const i of e)i.updated=null}}function Io(){try{ro()}catch(e){L&&rr(e,"stack",{value:""}),ir(e,Rn)}}let Ht=null;function ca(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var s=e[r++];if((s.f&(Bt|st))===0&&Wr(s)&&(Ht=new Set,Mr(s),s.deps===null&&s.first===null&&s.nodes===null&&s.teardown===null&&s.ac===null&&Ca(s),Ht?.size>0)){lr.clear();for(const a of Ht){if((a.f&(Bt|st))!==0)continue;const i=[a];let l=a.parent;for(;l!==null;)Ht.has(l)&&(Ht.delete(l),i.push(l)),l=l.parent;for(let c=i.length-1;c>=0;c--){const u=i[c];(u.f&(Bt|st))===0&&Mr(u)}}Ht.clear()}}Ht=null}}function ua(e,t,r,s){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const a of e.reactions){const i=a.f;(i&Be)!==0?ua(a,t,r,s):(i&(En|qt))!==0&&(i&Ve)===0&&fa(a,t,s)&&(Ne(a,Ve),Rt(a))}}function fa(e,t,r){const s=r.get(e);if(s!==void 0)return s;if(e.deps!==null)for(const a of e.deps){if(wr.call(t,a))return!0;if((a.f&Be)!==0&&fa(a,t,r))return r.set(a,!0),!0}return r.set(e,!1),!1}function Rt(e){var t=Rn=e,r=t.b;if(r?.is_pending&&(e.f&(Zr|Xr|Js))!==0&&(e.f&Sr)===0){r.defer_effect(e);return}for(;t.parent!==null;){t=t.parent;var s=t.f;if(ls&&t===ce&&(s&qt)!==0&&(s&Hs)===0&&(s&Sr)!==0)return;if((s&(xr|Et))!==0){if((s&je)===0)return;t.f^=je}}et.push(t)}function da(e,t){if(!((e.f&Et)!==0&&(e.f&je)!==0)){(e.f&Ve)!==0?t.d.push(e):(e.f&_t)!==0&&t.m.push(e),Ne(e,je);for(var r=e.first;r!==null;)da(r,t),r=r.next}}function Oo(e){let t=0,r=Tr(0),s;return L&&At(r,"createSubscriber version"),()=>{ps()&&(n(r),cn(()=>(t===0&&(s=S(()=>e(()=>an(r)))),t+=1,()=>{Jt(()=>{t-=1,t===0&&(s?.(),s=void 0,an(r))})})))}}var Fo=zr|qr;function jo(e,t,r,s){new Do(e,t,r,s)}class Do{parent;is_pending=!1;transform_error;#t;#o=null;#e;#i;#n;#a=null;#r=null;#s=null;#l=null;#u=0;#c=0;#d=!1;#v=new Set;#p=new Set;#f=null;#b=Oo(()=>(this.#f=Tr(this.#u),L&&At(this.#f,"$effect.pending()"),()=>{this.#f=null}));constructor(t,r,s,a){this.#t=t,this.#e=r,this.#i=i=>{var l=ce;l.b=this,l.f|=es,s(i)},this.parent=ce.b,this.transform_error=a??this.parent?.transform_error??(i=>i),this.#n=hs(()=>{this.#g()},Fo)}#y(){try{this.#a=ht(()=>this.#i(this.#t))}catch(t){this.error(t)}}#w(t){const r=this.#e.failed;r&&(this.#s=ht(()=>{r(this.#t,()=>t,()=>()=>{})}))}#x(){const t=this.#e.pending;t&&(this.is_pending=!0,this.#r=ht(()=>t(this.#t)),Jt(()=>{var r=this.#l=document.createDocumentFragment(),s=Wt();r.append(s),this.#a=this.#h(()=>(or.ensure(),ht(()=>this.#i(s)))),this.#c===0&&(this.#t.before(r),this.#l=null,Cr(this.#r,()=>{this.#r=null}),this.#_())}))}#g(){try{if(this.is_pending=this.has_pending_snippet(),this.#c=0,this.#u=0,this.#a=ht(()=>{this.#i(this.#t)}),this.#c>0){var t=this.#l=document.createDocumentFragment();Ma(this.#a,t);const r=this.#e.pending;this.#r=ht(()=>r(this.#t))}else this.#_()}catch(r){this.error(r)}}#_(){this.is_pending=!1;for(const t of this.#v)Ne(t,Ve),Rt(t);for(const t of this.#p)Ne(t,_t),Rt(t);this.#v.clear(),this.#p.clear()}defer_effect(t){oa(t,this.#v,this.#p)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#h(t){var r=ce,s=ve,a=me;Pt(this.#n),gt(this.#n),Vr(this.#n.ctx);try{return t()}catch(i){return sa(i),null}finally{Pt(r),gt(s),Vr(a)}}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#c+=t,this.#c===0&&(this.#_(),this.#r&&Cr(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null))}update_pending_count(t){this.#m(t),this.#u+=t,!(!this.#f||this.#d)&&(this.#d=!0,Jt(()=>{this.#d=!1,this.#f&&Jr(this.#f,this.#u)}))}get_effect_pending(){return this.#b(),n(this.#f)}error(t){var r=this.#e.onerror;let s=this.#e.failed;if(!r&&!s)throw t;this.#a&&(rt(this.#a),this.#a=null),this.#r&&(rt(this.#r),this.#r=null),this.#s&&(rt(this.#s),this.#s=null);var a=!1,i=!1;const l=()=>{if(a){Eo();return}a=!0,i&&lo(),this.#s!==null&&Cr(this.#s,()=>{this.#s=null}),this.#h(()=>{or.ensure(),this.#g()})},c=u=>{try{i=!0,r?.(u,l),i=!1}catch(v){ir(v,this.#n&&this.#n.parent)}s&&(this.#s=this.#h(()=>{or.ensure();try{return ht(()=>{var v=ce;v.b=this,v.f|=es,s(this.#t,()=>u,()=>l)})}catch(v){return ir(v,this.#n.parent),null}}))};Jt(()=>{var u;try{u=this.transform_error(t)}catch(v){ir(v,this.#n&&this.#n.parent);return}u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(c,v=>ir(v,this.#n&&this.#n.parent)):c(u)})}}function zo(e,t,r,s){const a=rn()?sn:Ke;var i=e.filter(m=>!m.settled);if(r.length===0&&i.length===0){s(t.map(a));return}var l=ce,c=qo(),u=i.length===1?i[0].promise:i.length>1?Promise.all(i.map(m=>m.promise)):null;function v(m){c();try{s(m)}catch(p){(l.f&Bt)===0&&ir(p,l)}cs()}if(r.length===0){u.then(()=>v(t.map(a)));return}function h(){c(),Promise.all(r.map(m=>Uo(m))).then(m=>v([...t.map(a),...m])).catch(m=>ir(m,l))}u?u.then(h):h()}function qo(){var e=ce,t=ve,r=me,s=_e;if(L)var a=en;return function(l=!0){Pt(e),gt(t),Vr(r),l&&s?.activate(),L&&Tn(a)}}function cs(e=!0){Pt(null),gt(null),Vr(null),e&&_e?.deactivate(),L&&Tn(null)}function Bo(){var e=ce.b,t=_e,r=e.is_rendered();return e.update_pending_count(1),t.increment(r),()=>{e.update_pending_count(-1),t.decrement(r)}}const Vo=new Set;function sn(e){var t=Be|Ve,r=ve!==null&&(ve.f&Be)!==0?ve:null;return ce!==null&&(ce.f|=qr),{ctx:me,deps:null,effects:null,equals:Xs,f:t,fn:e,reactions:null,rv:0,v:Ue,wv:0,parent:r??ce,ac:null}}function Uo(e,t,r){ce===null&&Yi();var a=void 0,i=Tr(Ue);L&&(i.label=t);var l=!ve,c=new Map;return il(()=>{var u=Us();a=u.promise;try{Promise.resolve(e()).then(u.resolve,u.reject).finally(cs)}catch(p){u.reject(p),cs()}var v=_e;if(l){var h=Bo();c.get(v)?.reject(kr),c.delete(v),c.set(v,u)}const m=(p,w=void 0)=>{if(v.activate(),w)w!==kr&&(i.f|=ar,Jr(i,w));else{(i.f&ar)!==0&&(i.f^=ar),Jr(i,p);for(const[y,x]of c){if(c.delete(y),y===v)break;x.reject(kr)}}h&&h()};u.promise.then(m,p=>m(null,p||"unknown"))}),An(()=>{for(const u of c.values())u.reject(kr)}),L&&(i.f|=En),new Promise(u=>{function v(h){function m(){h===a?u(i):v(a)}h.then(m,m)}v(a)})}function Jo(e){const t=sn(e);return Ia(t),t}function Ke(e){const t=sn(e);return t.equals=ea,t}function va(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)rt(t[r])}}let us=[];function Ho(e){for(var t=e.parent;t!==null;){if((t.f&Be)===0)return(t.f&Bt)===0?t:null;t=t.parent}return null}function fs(e){var t,r=ce;if(Pt(Ho(e)),L){let s=Ur;ha(new Set);try{wr.call(us,e)&&Qi(),us.push(e),e.f&=~sr,va(e),t=bs(e)}finally{Pt(r),ha(s),us.pop()}}else try{e.f&=~sr,va(e),t=bs(e)}finally{Pt(r)}return t}function pa(e){var t=fs(e);if(!e.equals(t)&&(e.wv=ja(),(!_e?.is_fork||e.deps===null)&&(e.v=t,e.deps===null))){Ne(e,je);return}ur||(Nt!==null?(ps()||_e?.is_fork)&&Nt.set(e,t):os(e))}function Wo(e){if(e.effects!==null)for(const t of e.effects)(t.teardown||t.ac)&&(t.teardown?.(),t.ac?.abort(kr),t.teardown=Hi,t.ac=null,un(t,0),gs(t))}function _a(e){if(e.effects!==null)for(const t of e.effects)t.teardown&&Mr(t)}let Ur=new Set;const lr=new Map;function ha(e){Ur=e}let ds=!1;function Go(){ds=!0}function Tr(e,t){var r={f:0,v:e,reactions:null,equals:Xs,rv:0,wv:0};return r}function cr(e,t){const r=Tr(e);return Ia(r),r}function N(e,t=!1,r=!0){const s=Tr(e);return t||(s.equals=ea),Br&&r&&me!==null&&me.l!==null&&(me.l.s??=[]).push(s),s}function tt(e,t){return o(e,S(()=>n(e))),t}function o(e,t,r=!1){ve!==null&&(!Ct||(ve.f&kn)!==0)&&rn()&&(ve.f&(Be|qt|En|kn))!==0&&(mt===null||!wr.call(mt,e))&&oo();let s=r?Hr(t):t;return L&&ta(s,e.label),Jr(e,s)}function Jr(e,t){if(!e.equals(t)){var r=e.v;ur?lr.set(e,t):lr.set(e,r),e.v=t;var s=or.ensure();if(s.capture(e,r),L){if(ce!==null){e.updated??=new Map;const a=(e.updated.get("")?.count??0)+1;if(e.updated.set("",{error:null,count:a}),a>5){const i=Ro("updated at");if(i!==null){let l=e.updated.get(i.stack);l||(l={error:i,count:0},e.updated.set(i.stack,l)),l.count++}}}ce!==null&&(e.set_during_effect=!0)}if((e.f&Be)!==0){const a=e;(e.f&Ve)!==0&&fs(a),os(a)}e.wv=ja(),ma(e,Ve),rn()&&ce!==null&&(ce.f&je)!==0&&(ce.f&(Et|xr))===0&&(bt===null?ll([e]):bt.push(e)),!s.is_fork&&Ur.size>0&&!ds&&ga()}return t}function ga(){ds=!1;for(const e of Ur)(e.f&je)!==0&&Ne(e,_t),Wr(e)&&Mr(e);Ur.clear()}function an(e){o(e,e.v+1)}function ma(e,t){var r=e.reactions;if(r!==null)for(var s=rn(),a=r.length,i=0;i<a;i++){var l=r[i],c=l.f;if(!(!s&&l===ce)){if(L&&(c&kn)!==0){Ur.add(l);continue}var u=(c&Ve)===0;if(u&&Ne(l,t),(c&Be)!==0){var v=l;Nt?.delete(v),(c&sr)===0&&(c&pt&&(l.f|=sr),ma(v,_t))}else u&&((c&qt)!==0&&Ht!==null&&Ht.add(l),Rt(l))}}}const Ko=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function Hr(e){if(typeof e!="object"||e===null||Ut in e)return e;const t=Zn(e);if(t!==Ui&&t!==Ji)return e;var r=new Map,s=Qr(e),a=cr(0),i=Ar,l=h=>{if(Ar===i)return h();var m=ve,p=Ar;gt(null),Fa(i);var w=h();return gt(m),Fa(p),w};s&&(r.set("length",cr(e.length)),L&&(e=Zo(e)));var c="";let u=!1;function v(h){if(!u){u=!0,c=h,At(a,`${c} version`);for(const[m,p]of r)At(p,$r(c,m));u=!1}}return new Proxy(e,{defineProperty(h,m,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&ao();var w=r.get(m);return w===void 0?l(()=>{var y=cr(p.value);return r.set(m,y),L&&typeof m=="string"&&At(y,$r(c,m)),y}):o(w,p.value,!0),!0},deleteProperty(h,m){var p=r.get(m);if(p===void 0){if(m in h){const w=l(()=>cr(Ue));r.set(m,w),an(a),L&&At(w,$r(c,m))}}else o(p,Ue),an(a);return!0},get(h,m,p){if(m===Ut)return e;if(L&&m===Gs)return v;var w=r.get(m),y=m in h;if(w===void 0&&(!y||nr(h,m)?.writable)&&(w=l(()=>{var b=Hr(y?h[m]:Ue),E=cr(b);return L&&At(E,$r(c,m)),E}),r.set(m,w)),w!==void 0){var x=n(w);return x===Ue?void 0:x}return Reflect.get(h,m,p)},getOwnPropertyDescriptor(h,m){var p=Reflect.getOwnPropertyDescriptor(h,m);if(p&&"value"in p){var w=r.get(m);w&&(p.value=n(w))}else if(p===void 0){var y=r.get(m),x=y?.v;if(y!==void 0&&x!==Ue)return{enumerable:!0,configurable:!0,value:x,writable:!0}}return p},has(h,m){if(m===Ut)return!0;var p=r.get(m),w=p!==void 0&&p.v!==Ue||Reflect.has(h,m);if(p!==void 0||ce!==null&&(!w||nr(h,m)?.writable)){p===void 0&&(p=l(()=>{var x=w?Hr(h[m]):Ue,b=cr(x);return L&&At(b,$r(c,m)),b}),r.set(m,p));var y=n(p);if(y===Ue)return!1}return w},set(h,m,p,w){var y=r.get(m),x=m in h;if(s&&m==="length")for(var b=p;b<y.v;b+=1){var E=r.get(b+"");E!==void 0?o(E,Ue):b in h&&(E=l(()=>cr(Ue)),r.set(b+"",E),L&&At(E,$r(c,b)))}if(y===void 0)(!x||nr(h,m)?.writable)&&(y=l(()=>cr(void 0)),L&&At(y,$r(c,m)),o(y,Hr(p)),r.set(m,y));else{x=y.v!==Ue;var F=l(()=>Hr(p));o(y,F)}var T=Reflect.getOwnPropertyDescriptor(h,m);if(T?.set&&T.set.call(w,p),!x){if(s&&typeof m=="string"){var A=r.get("length"),R=Number(m);Number.isInteger(R)&&R>=A.v&&o(A,R+1)}an(a)}return!0},ownKeys(h){n(a);var m=Reflect.ownKeys(h).filter(y=>{var x=r.get(y);return x===void 0||x.v!==Ue});for(var[p,w]of r)w.v!==Ue&&!(p in h)&&m.push(p);return m},setPrototypeOf(){io()}})}function $r(e,t){return typeof t=="symbol"?`${e}[Symbol(${t.description??""})]`:Ko.test(t)?`${e}.${t}`:/^\d+$/.test(t)?`${e}[${t}]`:`${e}['${t}']`}function on(e){try{if(e!==null&&typeof e=="object"&&Ut in e)return e[Ut]}catch{}return e}function Yo(e,t){return Object.is(on(e),on(t))}const Qo=new Set(["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"]);function Zo(e){return new Proxy(e,{get(t,r,s){var a=Reflect.get(t,r,s);return Qo.has(r)?function(...i){Go();var l=a.apply(this,i);return ga(),l}:a}})}function Xo(){const e=Array.prototype,t=Array.__svelte_cleanup;t&&t();const{indexOf:r,lastIndexOf:s,includes:a}=e;e.indexOf=function(i,l){const c=r.call(this,i,l);if(c===-1){for(let u=l??0;u<this.length;u+=1)if(on(this[u])===i){as("array.indexOf(...)");break}}return c},e.lastIndexOf=function(i,l){const c=s.call(this,i,l??this.length-1);if(c===-1){for(let u=0;u<=(l??this.length-1);u+=1)if(on(this[u])===i){as("array.lastIndexOf(...)");break}}return c},e.includes=function(i,l){const c=a.call(this,i,l);if(!c){for(let u=0;u<this.length;u+=1)if(on(this[u])===i){as("array.includes(...)");break}}return c},Array.__svelte_cleanup=()=>{e.indexOf=r,e.lastIndexOf=s,e.includes=a}}var Cn,vs,ba,ya;function el(){if(Cn===void 0){Cn=window,vs=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;ba=nr(t,"firstChild").get,ya=nr(t,"nextSibling").get,Vs(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Vs(r)&&(r.__t=void 0),L&&(e.__svelte_meta=null,Xo())}}function Wt(e=""){return document.createTextNode(e)}function Nr(e){return ba.call(e)}function ln(e){return ya.call(e)}function d(e,t){return Nr(e)}function at(e,t=!1){{var r=Nr(e);return r instanceof Comment&&r.data===""?ln(r):r}}function g(e,t=1,r=!1){let s=e;for(;t--;)s=ln(s);return s}function tl(e){e.textContent=""}function wa(){return!1}function xa(e,t,r){return document.createElementNS(t??Zs,e,void 0)}let Sa=!1;function rl(){Sa||(Sa=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Pn(e){var t=ve,r=ce;gt(null),Pt(null);try{return e()}finally{gt(t),Pt(r)}}function ka(e,t,r,s=r){e.addEventListener(t,()=>Pn(r));const a=e.__on_r;a?e.__on_r=()=>{a(),s(!0)}:e.__on_r=()=>s(!0),rl()}function Ea(e){ce===null&&(ve===null&&to(e),eo()),ur&&Xi(e)}function nl(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function Mt(e,t,r){var s=ce;if(L)for(;s!==null&&(s.f&kn)!==0;)s=s.parent;s!==null&&(s.f&st)!==0&&(e|=st);var a={ctx:me,deps:null,nodes:null,f:e|Ve|pt,first:null,fn:t,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,wv:0,ac:null};if(L&&(a.component_function=tn),r)try{Mr(a)}catch(c){throw rt(a),c}else t!==null&&Rt(a);var i=a;if(r&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&qr)===0&&(i=i.first,(e&qt)!==0&&(e&zr)!==0&&i!==null&&(i.f|=zr)),i!==null&&(i.parent=s,s!==null&&nl(i,s),ve!==null&&(ve.f&Be)!==0&&(e&xr)===0)){var l=ve;(l.effects??=[]).push(i)}return a}function ps(){return ve!==null&&!Ct}function An(e){const t=Mt(Xr,null,!1);return Ne(t,je),t.teardown=e,t}function _s(e){Ea("$effect"),L&&rr(e,"name",{value:"$effect"});var t=ce.f,r=!ve&&(t&Et)!==0&&(t&Sr)===0;if(r){var s=me;(s.e??=[]).push(e)}else return Ta(e)}function Ta(e){return Mt(Zr|Ws,e,!1)}function sl(e){return Ea("$effect.pre"),L&&rr(e,"name",{value:"$effect.pre"}),Mt(Xr|Ws,e,!0)}function al(e){or.ensure();const t=Mt(xr|qr,e,!0);return(r={})=>new Promise(s=>{r.outro?Cr(t,()=>{rt(t),s(void 0)}):(rt(t),s(void 0))})}function $a(e){return Mt(Zr,e,!1)}function it(e,t){var r=me,s={effect:null,ran:!1,deps:e};r.l.$.push(s),s.effect=cn(()=>{e(),!s.ran&&(s.ran=!0,S(t))})}function Rr(){var e=me;cn(()=>{for(var t of e.l.$){t.deps();var r=t.effect;(r.f&je)!==0&&r.deps!==null&&Ne(r,_t),Wr(r)&&Mr(r),t.ran=!1}})}function il(e){return Mt(En|qr,e,!0)}function cn(e,t=0){return Mt(Xr|t,e,!0)}function ee(e,t=[],r=[],s=[]){zo(s,t,r,a=>{Mt(Xr,()=>e(...a.map(n)),!0)})}function hs(e,t=0){var r=Mt(qt|t,e,!0);return L&&(r.dev_stack=en),r}function ht(e){return Mt(Et|qr,e,!0)}function Na(e){var t=e.teardown;if(t!==null){const r=ur,s=ve;La(!0),gt(null);try{t.call(null)}finally{La(r),gt(s)}}}function gs(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const a=r.ac;a!==null&&Pn(()=>{a.abort(kr)});var s=r.next;(r.f&xr)!==0?r.parent=null:rt(r,t),r=s}}function ol(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&Et)===0&&rt(t),t=r}}function rt(e,t=!0){var r=!1;(t||(e.f&Hs)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Ra(e.nodes.start,e.nodes.end),r=!0),gs(e,t&&!r),un(e,0),Ne(e,Bt);var s=e.nodes&&e.nodes.t;if(s!==null)for(const i of s)i.stop();Na(e);var a=e.parent;a!==null&&a.first!==null&&Ca(e),L&&(e.component_function=null),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Ra(e,t){for(;e!==null;){var r=e===t?null:ln(e);e.remove(),e=r}}function Ca(e){var t=e.parent,r=e.prev,s=e.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),t!==null&&(t.first===e&&(t.first=s),t.last===e&&(t.last=r))}function Cr(e,t,r=!0){var s=[];Pa(e,s,!0);var a=()=>{r&&rt(e),t&&t()},i=s.length;if(i>0){var l=()=>--i||a();for(var c of s)c.out(l)}else a()}function Pa(e,t,r){if((e.f&st)===0){e.f^=st;var s=e.nodes&&e.nodes.t;if(s!==null)for(const c of s)(c.is_global||r)&&t.push(c);for(var a=e.first;a!==null;){var i=a.next,l=(a.f&zr)!==0||(a.f&Et)!==0&&(e.f&qt)!==0;Pa(a,t,l?r:!1),a=i}}}function ms(e){Aa(e,!0)}function Aa(e,t){if((e.f&st)!==0){e.f^=st,(e.f&je)===0&&(Ne(e,Ve),Rt(e));for(var r=e.first;r!==null;){var s=r.next,a=(r.f&zr)!==0||(r.f&Et)!==0;Aa(r,a?t:!1),r=s}var i=e.nodes&&e.nodes.t;if(i!==null)for(const l of i)(l.is_global||t)&&l.in()}}function Ma(e,t){if(e.nodes)for(var r=e.nodes.start,s=e.nodes.end;r!==null;){var a=r===s?null:ln(r);t.append(r),r=a}}let Mn=!1,ur=!1;function La(e){ur=e}let ve=null,Ct=!1;function gt(e){ve=e}let ce=null;function Pt(e){ce=e}let mt=null;function Ia(e){ve!==null&&(mt===null?mt=[e]:mt.push(e))}let nt=null,ot=0,bt=null;function ll(e){bt=e}let Oa=1,Pr=0,Ar=Pr;function Fa(e){Ar=e}function ja(){return++Oa}function Wr(e){var t=e.f;if((t&Ve)!==0)return!0;if(t&Be&&(e.f&=~sr),(t&_t)!==0){for(var r=e.deps,s=r.length,a=0;a<s;a++){var i=r[a];if(Wr(i)&&pa(i),i.wv>e.wv)return!0}(t&pt)!==0&&Nt===null&&Ne(e,je)}return!1}function Da(e,t,r=!0){var s=e.reactions;if(s!==null&&!(mt!==null&&wr.call(mt,e)))for(var a=0;a<s.length;a++){var i=s[a];(i.f&Be)!==0?Da(i,t,!1):t===i&&(r?Ne(i,Ve):(i.f&je)!==0&&Ne(i,_t),Rt(i))}}function bs(e){var t=nt,r=ot,s=bt,a=ve,i=mt,l=me,c=Ct,u=Ar,v=e.f;nt=null,ot=0,bt=null,ve=(v&(Et|xr))===0?e:null,mt=null,Vr(e.ctx),Ct=!1,Ar=++Pr,e.ac!==null&&(Pn(()=>{e.ac.abort(kr)}),e.ac=null);try{e.f|=ts;var h=e.fn,m=h();e.f|=Sr;var p=e.deps,w=_e?.is_fork;if(nt!==null){var y;if(w||un(e,ot),p!==null&&ot>0)for(p.length=ot+nt.length,y=0;y<nt.length;y++)p[ot+y]=nt[y];else e.deps=p=nt;if(ps()&&(e.f&pt)!==0)for(y=ot;y<p.length;y++)(p[y].reactions??=[]).push(e)}else!w&&p!==null&&ot<p.length&&(un(e,ot),p.length=ot);if(rn()&&bt!==null&&!Ct&&p!==null&&(e.f&(Be|_t|Ve))===0)for(y=0;y<bt.length;y++)Da(bt[y],e);if(a!==null&&a!==e){if(Pr++,a.deps!==null)for(let x=0;x<r;x+=1)a.deps[x].rv=Pr;if(t!==null)for(const x of t)x.rv=Pr;bt!==null&&(s===null?s=bt:s.push(...bt))}return(e.f&ar)!==0&&(e.f^=ar),m}catch(x){return sa(x)}finally{e.f^=ts,nt=t,ot=r,bt=s,ve=a,mt=i,Vr(l),Ct=c,Ar=u}}function cl(e,t){let r=t.reactions;if(r!==null){var s=Vi.call(r,e);if(s!==-1){var a=r.length-1;a===0?r=t.reactions=null:(r[s]=r[a],r.pop())}}if(r===null&&(t.f&Be)!==0&&(nt===null||!wr.call(nt,t))){var i=t;(i.f&pt)!==0&&(i.f^=pt,i.f&=~sr),os(i),Wo(i),un(i,0)}}function un(e,t){var r=e.deps;if(r!==null)for(var s=t;s<r.length;s++)cl(e,r[s])}function Mr(e){var t=e.f;if((t&Bt)===0){Ne(e,je);var r=ce,s=Mn;if(ce=e,Mn=!0,L){var a=tn;ra(e.component_function);var i=en;Tn(e.dev_stack??en)}try{(t&(qt|Js))!==0?ol(e):gs(e),Na(e);var l=bs(e);e.teardown=typeof l=="function"?l:null,e.wv=Oa;var c;L&&$o&&(e.f&Ve)!==0&&e.deps}finally{Mn=s,ce=r,L&&(ra(a),Tn(i))}}}async function za(){await Promise.resolve(),Lo()}function n(e){var t=e.f,r=(t&Be)!==0;if(ve!==null&&!Ct){var s=ce!==null&&(ce.f&Bt)!==0;if(!s&&(mt===null||!wr.call(mt,e))){var a=ve.deps;if((ve.f&ts)!==0)e.rv<Pr&&(e.rv=Pr,nt===null&&a!==null&&a[ot]===e?ot++:nt===null?nt=[e]:nt.push(e));else{(ve.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[ve]:wr.call(i,ve)||i.push(ve)}}}if(L&&Vo.delete(e),ur&&lr.has(e))return lr.get(e);if(r){var l=e;if(ur){var c=l.v;return((l.f&je)===0&&l.reactions!==null||Ba(l))&&(c=fs(l)),lr.set(l,c),c}var u=(l.f&pt)===0&&!Ct&&ve!==null&&(Mn||(ve.f&pt)!==0),v=(l.f&Sr)===0;Wr(l)&&(u&&(l.f|=pt),pa(l)),u&&!v&&(_a(l),qa(l))}if(Nt?.has(e))return Nt.get(e);if((e.f&ar)!==0)throw e.v;return e.v}function qa(e){if(e.f|=pt,e.deps!==null)for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&Be)!==0&&(t.f&pt)===0&&(_a(t),qa(t))}function Ba(e){if(e.v===Ue)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(lr.has(t)||(t.f&Be)!==0&&Ba(t))return!0;return!1}function S(e){var t=Ct;try{return Ct=!0,e()}finally{Ct=t}}function pe(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Ut in e)ys(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&Ut in r&&ys(r)}}}function ys(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let s in e)try{ys(e[s],t)}catch{}const r=Zn(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const s=Bs(r);for(let a in s){const i=s[a].get;if(i)try{i.call(e)}catch{}}}}}const ul=["touchstart","touchmove"];function fl(e){return ul.includes(e)}const Ln=Symbol("events"),dl=new Set,Va=new Set;function vl(e,t,r,s={}){function a(i){if(s.capture||ws.call(t,i),!i.cancelBubble)return Pn(()=>r?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Jt(()=>{t.addEventListener(e,a,s)}):t.addEventListener(e,a,s),a}function ne(e,t,r,s,a){var i={capture:s,passive:a},l=vl(e,t,r,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&An(()=>{t.removeEventListener(e,l,i)})}let Ua=null;function ws(e){var t=this,r=t.ownerDocument,s=e.type,a=e.composedPath?.()||[],i=a[0]||e.target;Ua=e;var l=0,c=Ua===e&&e[Ln];if(c){var u=a.indexOf(c);if(u!==-1&&(t===document||t===window)){e[Ln]=t;return}var v=a.indexOf(t);if(v===-1)return;u<=v&&(l=u)}if(i=a[l]||e.target,i!==t){rr(e,"currentTarget",{configurable:!0,get(){return i||r}});var h=ve,m=ce;gt(null),Pt(null);try{for(var p,w=[];i!==null;){var y=i.assignedSlot||i.parentNode||i.host||null;try{var x=i[Ln]?.[s];x!=null&&(!i.disabled||e.target===i)&&x.call(i,e)}catch(b){p?w.push(b):p=b}if(e.cancelBubble||y===t||y===null)break;i=y}if(p){for(let b of w)queueMicrotask(()=>{throw b});throw p}}finally{e[Ln]=t,delete e.currentTarget,gt(h),Pt(m)}}}const pl=globalThis?.window?.trustedTypes&&globalThis.window.trustedTypes.createPolicy("svelte-trusted-html",{createHTML:e=>e});function _l(e){return pl?.createHTML(e)??e}function hl(e){var t=xa("template");return t.innerHTML=_l(e.replaceAll("<!>","<!---->")),t.content}function fn(e,t){var r=ce;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function J(e,t){var r=(t&bo)!==0,s=(t&yo)!==0,a,i=!e.startsWith("<!>");return()=>{a===void 0&&(a=hl(i?e:"<!>"+e),r||(a=Nr(a)));var l=s||vs?document.importNode(a,!0):a.cloneNode(!0);if(r){var c=Nr(l),u=l.lastChild;fn(c,u)}else fn(l,l);return l}}function gl(e=""){{var t=Wt(e+"");return fn(t,t),t}}function yt(){var e=document.createDocumentFragment(),t=document.createComment(""),r=Wt();return e.append(t,r),fn(t,r),e}function I(e,t){e!==null&&e.before(t)}function $(e,t){var r=t==null?"":typeof t=="object"?`${t}`:t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=`${r}`)}function ml(e,t){return bl(e,t)}const In=new Map;function bl(e,{target:t,anchor:r,props:s={},events:a,context:i,intro:l=!0,transformError:c}){el();var u=void 0,v=al(()=>{var h=r??t.appendChild(Wt());jo(h,{pending:()=>{}},w=>{Tt({});var y=me;i&&(y.c=i),a&&(s.$$events=a),u=e(w,s)||{},$t()},c);var m=new Set,p=w=>{for(var y=0;y<w.length;y++){var x=w[y];if(!m.has(x)){m.add(x);var b=fl(x);for(const T of[t,document]){var E=In.get(T);E===void 0&&(E=new Map,In.set(T,E));var F=E.get(x);F===void 0?(T.addEventListener(x,ws,{passive:b}),E.set(x,1)):E.set(x,F+1)}}}};return p(Sn(dl)),Va.add(p),()=>{for(var w of m)for(const b of[t,document]){var y=In.get(b),x=y.get(w);--x==0?(b.removeEventListener(w,ws),y.delete(w),y.size===0&&In.delete(b)):y.set(w,x)}Va.delete(p),h!==r&&h.parentNode?.removeChild(h)}});return yl.set(u,v),u}let yl=new WeakMap;class wl{anchor;#t=new Map;#o=new Map;#e=new Map;#i=new Set;#n=!0;constructor(t,r=!0){this.anchor=t,this.#n=r}#a=()=>{var t=_e;if(this.#t.has(t)){var r=this.#t.get(t),s=this.#o.get(r);if(s)ms(s),this.#i.delete(r);else{var a=this.#e.get(r);a&&(this.#o.set(r,a.effect),this.#e.delete(r),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),s=a.effect)}for(const[i,l]of this.#t){if(this.#t.delete(i),i===t)break;const c=this.#e.get(l);c&&(rt(c.effect),this.#e.delete(l))}for(const[i,l]of this.#o){if(i===r||this.#i.has(i))continue;const c=()=>{if(Array.from(this.#t.values()).includes(i)){var v=document.createDocumentFragment();Ma(l,v),v.append(Wt()),this.#e.set(i,{effect:l,fragment:v})}else rt(l);this.#i.delete(i),this.#o.delete(i)};this.#n||!s?(this.#i.add(i),Cr(l,c,!1)):c()}}};#r=t=>{this.#t.delete(t);const r=Array.from(this.#t.values());for(const[s,a]of this.#e)r.includes(s)||(rt(a.effect),this.#e.delete(s))};ensure(t,r){var s=_e,a=wa();if(r&&!this.#o.has(t)&&!this.#e.has(t))if(a){var i=document.createDocumentFragment(),l=Wt();i.append(l),this.#e.set(t,{effect:ht(()=>r(l)),fragment:i})}else this.#o.set(t,ht(()=>r(this.anchor)));if(this.#t.set(s,t),a){for(const[c,u]of this.#o)c===t?s.unskip_effect(u):s.skip_effect(u);for(const[c,u]of this.#e)c===t?s.unskip_effect(u.effect):s.skip_effect(u.effect);s.oncommit(this.#a),s.ondiscard(this.#r)}else this.#a()}}function xe(e,t,r=!1){var s=new wl(e),a=r?zr:0;function i(l,c){s.ensure(l,c)}hs(()=>{var l=!1;t((c,u=0)=>{l=!0,i(u,c)}),l||i(!1,null)},a)}function lt(e,t){return t}function xl(e,t,r){for(var s=[],a=t.length,i,l=t.length,c=0;c<a;c++){let m=t[c];Cr(m,()=>{if(i){if(i.pending.delete(m),i.done.add(m),i.pending.size===0){var p=e.outrogroups;xs(Sn(i.done)),p.delete(i),p.size===0&&(e.outrogroups=null)}}else l-=1},!1)}if(l===0){var u=s.length===0&&r!==null;if(u){var v=r,h=v.parentNode;tl(h),h.append(v),e.items.clear()}xs(t,!u)}else i={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(i)}function xs(e,t=!0){for(var r=0;r<e.length;r++)rt(e[r],t)}var Ja;function ct(e,t,r,s,a,i=null){var l=e,c=new Map,u=(t&Qs)!==0;if(u){var v=e;l=v.appendChild(Wt())}var h=null,m=Ke(()=>{var E=r();return Qr(E)?E:E==null?[]:Sn(E)}),p,w=!0;function y(){b.fallback=h,Sl(b,p,l,t,s),h!==null&&(p.length===0?(h.f&Vt)===0?ms(h):(h.f^=Vt,vn(h,null,l)):Cr(h,()=>{h=null}))}var x=hs(()=>{p=n(m);for(var E=p.length,F=new Set,T=_e,A=wa(),R=0;R<E;R+=1){var j=p[R],q=s(j,R);if(L){var H=s(j,R);q!==H&&Zi(String(R),String(q),String(H))}var X=w?null:c.get(q);X?(X.v&&Jr(X.v,j),X.i&&Jr(X.i,R),A&&T.unskip_effect(X.e)):(X=kl(c,w?l:Ja??=Wt(),j,q,R,a,t,r),w||(X.e.f|=Vt),c.set(q,X)),F.add(q)}if(E===0&&i&&!h&&(w?h=ht(()=>i(l)):(h=ht(()=>i(Ja??=Wt())),h.f|=Vt)),E>F.size&&(L?El(p,s):Ys("","","")),!w)if(A){for(const[Q,he]of c)F.has(Q)||T.skip_effect(he.e);T.oncommit(y),T.ondiscard(()=>{})}else y();n(m)}),b={effect:x,items:c,outrogroups:null,fallback:h};w=!1}function dn(e){for(;e!==null&&(e.f&Et)===0;)e=e.next;return e}function Sl(e,t,r,s,a){var i=(s&fo)!==0,l=t.length,c=e.items,u=dn(e.effect.first),v,h=null,m,p=[],w=[],y,x,b,E;if(i)for(E=0;E<l;E+=1)y=t[E],x=a(y,E),b=c.get(x).e,(b.f&Vt)===0&&(b.nodes?.a?.measure(),(m??=new Set).add(b));for(E=0;E<l;E+=1){if(y=t[E],x=a(y,E),b=c.get(x).e,e.outrogroups!==null)for(const Q of e.outrogroups)Q.pending.delete(b),Q.done.delete(b);if((b.f&Vt)!==0)if(b.f^=Vt,b===u)vn(b,null,r);else{var F=h?h.next:u;b===e.effect.last&&(e.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),fr(e,h,b),fr(e,b,F),vn(b,F,r),h=b,p=[],w=[],u=dn(h.next);continue}if((b.f&st)!==0&&(ms(b),i&&(b.nodes?.a?.unfix(),(m??=new Set).delete(b))),b!==u){if(v!==void 0&&v.has(b)){if(p.length<w.length){var T=w[0],A;h=T.prev;var R=p[0],j=p[p.length-1];for(A=0;A<p.length;A+=1)vn(p[A],T,r);for(A=0;A<w.length;A+=1)v.delete(w[A]);fr(e,R.prev,j.next),fr(e,h,R),fr(e,j,T),u=T,h=j,E-=1,p=[],w=[]}else v.delete(b),vn(b,u,r),fr(e,b.prev,b.next),fr(e,b,h===null?e.effect.first:h.next),fr(e,h,b),h=b;continue}for(p=[],w=[];u!==null&&u!==b;)(v??=new Set).add(u),w.push(u),u=dn(u.next);if(u===null)continue}(b.f&Vt)===0&&p.push(b),h=b,u=dn(b.next)}if(e.outrogroups!==null){for(const Q of e.outrogroups)Q.pending.size===0&&(xs(Sn(Q.done)),e.outrogroups?.delete(Q));e.outrogroups.size===0&&(e.outrogroups=null)}if(u!==null||v!==void 0){var q=[];if(v!==void 0)for(b of v)(b.f&st)===0&&q.push(b);for(;u!==null;)(u.f&st)===0&&u!==e.fallback&&q.push(u),u=dn(u.next);var H=q.length;if(H>0){var X=(s&Qs)!==0&&l===0?r:null;if(i){for(E=0;E<H;E+=1)q[E].nodes?.a?.measure();for(E=0;E<H;E+=1)q[E].nodes?.a?.fix()}xl(e,q,X)}}i&&Jt(()=>{if(m!==void 0)for(b of m)b.nodes?.a?.apply()})}function kl(e,t,r,s,a,i,l,c){var u=(l&co)!==0?(l&vo)===0?N(r,!1,!1):Tr(r):null,v=(l&uo)!==0?Tr(a):null;return L&&u&&(u.trace=()=>{c()[v?.v??a]}),{v:u,i:v,e:ht(()=>(i(t,u??r,v??a,c),()=>{e.delete(s)}))}}function vn(e,t,r){if(e.nodes)for(var s=e.nodes.start,a=e.nodes.end,i=t&&(t.f&Vt)===0?t.nodes.start:r;s!==null;){var l=ln(s);if(i.before(s),s===a)return;s=l}}function fr(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function El(e,t){const r=new Map,s=e.length;for(let a=0;a<s;a++){const i=t(e[a],a);if(r.has(i)){const l=String(r.get(i)),c=String(a);let u=String(i);u.startsWith("[object ")&&(u=null),Ys(l,c,u)}r.set(i,a)}}function Tl(e,t,r=!1,s=!1,a=!1){var i=e,l="";ee(()=>{var c=ce;if(l!==(l=t()??"")&&(c.nodes!==null&&(Ra(c.nodes.start,c.nodes.end),c.nodes=null),l!=="")){var u=r?xo:s?So:void 0,v=xa(r?"svg":s?"math":"template",u);v.innerHTML=l;var h=r||s?v:v.content;if(fn(Nr(h),h.lastChild),r||s)for(;Nr(h);)i.before(Nr(h));else i.before(h)}})}function Ha(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Ha(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function $l(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Ha(e))&&(s&&(s+=" "),s+=t);return s}function Wa(e){return typeof e=="object"?$l(e):e??""}function Nl(e,t,r){var s=e==null?"":""+e;return t&&(s=s?s+" "+t:t),s===""?null:s}function Rl(e,t){return e==null?null:String(e)}function Ye(e,t,r,s,a,i){var l=e.__className;if(l!==r||l===void 0){var c=Nl(r,s);c==null?e.removeAttribute("class"):e.className=c,e.__className=r}return i}function Ss(e,t,r,s){var a=e.__style;if(a!==t){var i=Rl(t);i==null?e.removeAttribute("style"):e.style.cssText=i,e.__style=t}return s}function Ga(e,t,r=!1){if(e.multiple){if(t==null)return;if(!Qr(t))return ko();for(var s of e.options)s.selected=t.includes(pn(s));return}for(s of e.options){var a=pn(s);if(Yo(a,t)){s.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Cl(e){var t=new MutationObserver(()=>{Ga(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),An(()=>{t.disconnect()})}function On(e,t,r=t){var s=new WeakSet,a=!0;ka(e,"change",i=>{var l=i?"[selected]":":checked",c;if(e.multiple)c=[].map.call(e.querySelectorAll(l),pn);else{var u=e.querySelector(l)??e.querySelector("option:not([disabled])");c=u&&pn(u)}r(c),_e!==null&&s.add(_e)}),$a(()=>{var i=t();if(e===document.activeElement){var l=Nn??_e;if(s.has(l))return}if(Ga(e,i,a),a&&i===void 0){var c=e.querySelector(":checked");c!==null&&(i=pn(c),r(i))}e.__value=i,a=!1}),Cl(e)}function pn(e){return"__value"in e?e.__value:e.value}const Pl=Symbol("is custom element"),Al=Symbol("is html");function _n(e,t,r,s){var a=Ml(e);a[t]!==(a[t]=r)&&(t==="loading"&&(e[Ki]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Ll(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function Ml(e){return e.__attributes??={[Pl]:e.nodeName.includes("-"),[Al]:e.namespaceURI===Zs}}var Ka=new Map;function Ll(e){var t=e.getAttribute("is")||e.nodeName,r=Ka.get(t);if(r)return r;Ka.set(t,r=[]);for(var s,a=e,i=Element.prototype;i!==a;){s=Bs(a);for(var l in s)s[l].set&&r.push(l);a=Zn(a)}return r}function Ya(e,t,r=t){var s=new WeakSet;ka(e,"input",async a=>{L&&e.type==="checkbox"&&Ks();var i=a?e.defaultValue:e.value;if(i=ks(e)?Es(i):i,r(i),_e!==null&&s.add(_e),await za(),i!==(i=t())){var l=e.selectionStart,c=e.selectionEnd,u=e.value.length;if(e.value=i??"",c!==null){var v=e.value.length;l===c&&c===u&&v>u?(e.selectionStart=v,e.selectionEnd=v):(e.selectionStart=l,e.selectionEnd=Math.min(c,v))}}}),S(t)==null&&e.value&&(r(ks(e)?Es(e.value):e.value),_e!==null&&s.add(_e)),cn(()=>{L&&e.type==="checkbox"&&Ks();var a=t();if(e===document.activeElement){var i=Nn??_e;if(s.has(i))return}ks(e)&&a===Es(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function ks(e){var t=e.type;return t==="number"||t==="range"}function Es(e){return e===""?null:+e}function Qa(e,t,r){var s=nr(e,t);s&&s.set&&(e[t]=r,An(()=>{e[t]=null}))}function Za(e,t){return e===t||e?.[Ut]===t}function Lr(e={},t,r,s){return $a(()=>{var a,i;return cn(()=>{a=i,i=[],S(()=>{e!==r(...i)&&(t(e,...i),a&&Za(r(...a),e)&&t(null,...a))})}),()=>{Jt(()=>{i&&Za(r(...i),e)&&t(null,...i)})}}),e}function Il(e){return function(...t){var r=t[0];return r.preventDefault(),e?.apply(this,t)}}function Lt(e=!1){const t=me,r=t.l.u;if(!r)return;let s=()=>pe(t.s);if(e){let a=0,i={};const l=sn(()=>{let c=!1;const u=t.s;for(const v in u)u[v]!==i[v]&&(i[v]=u[v],c=!0);return c&&a++,a});s=()=>n(l)}r.b.length&&sl(()=>{Xa(t,s),Xn(r.b)}),_s(()=>{const a=S(()=>r.m.map(Wi));return()=>{for(const i of a)typeof i=="function"&&i()}}),r.a.length&&_s(()=>{Xa(t,s),Xn(r.a)})}function Xa(e,t){if(e.l.s)for(const r of e.l.s)n(r);t()}function Ol(e,t){var r=e.$$events?.[t.type],s=Qr(r)?r.slice():r==null?[]:[r];for(var a of s)a.call(this,t)}let Fn=!1;function Fl(e){var t=Fn;try{return Fn=!1,[e(),Fn]}finally{Fn=t}}function be(e,t,r,s){var a=!Br||(r&_o)!==0,i=(r&go)!==0,l=(r&mo)!==0,c=s,u=!0,v=()=>(u&&(u=!1,c=l?S(s):s),c),h;if(i){var m=Ut in e||Gi in e;h=nr(e,t)?.set??(m&&t in e?T=>e[t]=T:void 0)}var p,w=!1;i?[p,w]=Fl(()=>e[t]):p=e[t],p===void 0&&s!==void 0&&(p=v(),h&&(a&&no(t),h(p)));var y;if(a?y=()=>{var T=e[t];return T===void 0?v():(u=!0,T)}:y=()=>{var T=e[t];return T!==void 0&&(c=void 0),T===void 0?c:T},a&&(r&ho)===0)return y;if(h){var x=e.$$legacy;return(function(T,A){return arguments.length>0?((!a||!A||x||w)&&h(A?y():T),T):y()})}var b=!1,E=((r&po)!==0?sn:Ke)(()=>(b=!1,y()));L&&(E.label=t),i&&n(E);var F=ce;return(function(T,A){if(arguments.length>0){const R=A?n(E):a&&i?Hr(T):T;return o(E,R),b=!0,c!==void 0&&(c=R),T}return ur&&b||(F.f&Bt)!==0?E.v:n(E)})}if(L){let e=function(t){if(!(t in globalThis)){let r;Object.defineProperty(globalThis,t,{configurable:!0,get:()=>{if(r!==void 0)return r;so(t)},set:s=>{r=s}})}};e("$state"),e("$effect"),e("$derived"),e("$inspect"),e("$props"),e("$bindable")}function dr(e){me===null&&rs("onMount"),Br&&me.l!==null?Dl(me).m.push(e):_s(()=>{const t=S(e);if(typeof t=="function")return t})}function jn(e){me===null&&rs("onDestroy"),dr(()=>()=>S(e))}function jl(e,t,{bubbles:r=!1,cancelable:s=!1}={}){return new CustomEvent(e,{detail:t,bubbles:r,cancelable:s})}function ei(){const e=me;return e===null&&rs("createEventDispatcher"),(t,r,s)=>{const a=e.s.$$events?.[t];if(a){const i=Qr(a)?a.slice():[a],l=jl(t,r,s);for(const c of i)c.call(e.x,l);return!l.defaultPrevented}return!0}}function Dl(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const zl="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(zl),No();const ql=(e,t,r)=>r&&typeof r=="object"?typeof r.message=="string"?r.message:typeof r.code=="string"?r.code:JSON.stringify(r):typeof r=="string"&&r.trim()?r:`${e} ${t}`,Re=async(e,t={})=>{const r=await fetch(e,t),s=await r.text(),a=s?JSON.parse(s):{};if(!r.ok)throw new Error(ql(r.status,r.statusText,a?.detail));return a},Bl=()=>Re("/api/v1/capabilities"),Vl=()=>Re("/api/v1/version"),Ul=(e=[])=>Re("/api/v1/log/client",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:Array.isArray(e)?e:[]})}),Jl=()=>Re("/api/v1/playground/files"),Hl=e=>Re(`/api/v1/playground/files/${sc(e)}`),ti=e=>Re("/api/v1/playground/symbols",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({program:e})}),Wl=e=>Re("/api/v1/playground/jobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({program:e,execute:!0,execution_strategy:"dask"})}),Gl=()=>Re("/api/v1/playground/jobs"),ri=e=>Re(`/api/v1/playground/jobs/${encodeURIComponent(e)}`),ni=e=>Re(`/api/v1/playground/jobs/${encodeURIComponent(e)}`,{method:"DELETE"}),si=({program:e,nodeId:t="",variable:r="",path:s="",enqueue:a=!0})=>{const i={program:e,execution_strategy:"dask",variable:r,path:s,enqueue:a};return!r&&t&&(i.node_id=t),Re("/api/v1/playground/value",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})},ai=({program:e,nodeId:t="",variable:r="",path:s="",offset:a=0,limit:i=64,enqueue:l=!0})=>{const c={program:e,execution_strategy:"dask",variable:r,path:s,offset:Math.max(0,Number(a||0)),limit:Math.max(1,Number(i||64)),enqueue:l};return!r&&t&&(c.node_id=t),Re("/api/v1/playground/value/page",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})},Kl=({limit:e=200,statusFilter:t="",nodeFilter:r=""}={})=>{const s=new URLSearchParams;return s.set("limit",`${e}`),t&&s.set("status_filter",t),r&&s.set("node_filter",r),Re(`/api/v1/results/store?${s.toString()}`)},Yl=(e,t="")=>{const r=t?`?path=${encodeURIComponent(t)}`:"";return Re(`/api/v1/results/store/${encodeURIComponent(e)}${r}`)},Ql=({nodeId:e,path:t="",offset:r=0,limit:s=64})=>{const a=new URLSearchParams;return t&&a.set("path",t),a.set("offset",`${Math.max(0,Number(r||0))}`),a.set("limit",`${Math.max(1,Number(s||64))}`),Re(`/api/v1/results/store/${encodeURIComponent(e)}/page?${a.toString()}`)},Zl=()=>Re("/api/v1/docs/gallery"),Xl=()=>Re("/api/v1/testing/report"),ec=()=>Re("/api/v1/testing/jobs"),tc=e=>Re(`/api/v1/testing/jobs/${encodeURIComponent(e)}`),rc=({profile:e,includePerf:t})=>Re("/api/v1/testing/jobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profile:e,include_perf:t})}),ii=e=>Re(`/api/v1/testing/jobs/${encodeURIComponent(e)}`,{method:"DELETE"}),nc=()=>Re("/api/v1/storage/stats"),sc=e=>String(e||"").split("/").map(t=>encodeURIComponent(t)).join("/"),ac=({precomputedPrintTargets:e=[],latestGoalResults:t=[],precomputedSymbolTable:r={},latestSymbolTable:s={}})=>{const a=[],i=new Set,l=u=>{const v=`${u.kind}:${u.label}:${u.nodeId}`;i.has(v)||(i.add(v),a.push(u))};for(const u of e)u?.node_id&&l({kind:"print",label:String(u.name||"print"),nodeId:String(u.node_id)});for(const u of t)!u||u.operation!=="print"||!u.node_id||l({kind:"print",label:String(u.name||"print"),nodeId:String(u.node_id)});const c=Object.keys(r||{}).length>0?r:s;for(const[u,v]of Object.entries(c||{}))!v||typeof v!="string"||l({kind:"variable",label:String(u),nodeId:v});return a},oi=e=>{const t=e&&typeof e=="object"?e.execution_errors:null;if(t&&typeof t=="object")return t;const r=e?.diagnostics?.execution_errors;return r&&typeof r=="object"?r:{}},ic=e=>{const t=e&&typeof e=="object"?e.execution_error_details:null;if(t&&typeof t=="object")return t;const r=e?.diagnostics?.execution_error_details;return r&&typeof r=="object"?r:{}},li=e=>{const t=Object.entries(e||{});return t.length?t.map(([r,s])=>`${String(r).slice(0,12)}: ${String(s)}`).join(`
`):"none"},oc=(e,t)=>{const r=Object.entries(e||{});if(!r.length)return"";const s=(a,i=120)=>{const l=String(a??"");return l.length<=i?l:`${l.slice(0,i)}...`};return r.map(([a,i])=>{const l=i?.operator?String(i.operator):"unknown",c=Array.isArray(i?.args)?i.args.map(b=>s(b)).join(", "):"",u=i&&typeof i.kwargs=="object"&&i.kwargs?Object.entries(i.kwargs).map(([b,E])=>`${String(b)}=${s(E)}`).join(", "):"",v=i&&typeof i.attrs=="object"&&i.attrs?s(JSON.stringify(i.attrs)):"",h=i?.kind?` kind=${String(i.kind)}`:"",m=i?.output_kind?` output=${String(i.output_kind)}`:"",p=t?.[a]?String(t[a]):"",w=u?`${l}(${c}${c?", ":""}${u})`:`${l}(${c})`,y=v&&v!=="{}"?` attrs=${v}`:"",x=p?` error=${p}`:"";return`${String(a).slice(0,12)}: ${w}${y}${h}${m}${x}`}).join(`
`)},lc=(e,t)=>{const r=String(e.node_id||t.nodeId||""),s=e.path||t.path||"",a=String(e.compute_status||e.status||"failed"),i=[`node: ${r||"-"}`,`path: ${s||"/"}`,`status: ${a}`],l=String(e.store_status||e?.diagnostics?.store_status||"missing");i.push(`store: ${l}`),e.error&&i.push(`error: ${String(e.error)}`),e.job_error&&i.push(`job_error: ${String(e.job_error)}`),e.store_error&&i.push(`store_error: ${String(e.store_error)}`);const c=e?.diagnostics;c&&typeof c=="object"&&(c.job_error&&!e.job_error&&i.push(`job_error: ${String(c.job_error)}`),c.store_error&&!e.store_error&&i.push(`store_error: ${String(c.store_error)}`));const u=oi(e);Object.keys(u).length&&(i.push("execution_errors:"),i.push(li(u)));const v=oc(ic(e),u);return v&&(i.push("failed_operations:"),i.push(v)),i.join(`
`)},ci=e=>{if(!e||typeof e!="object")return"value available";const t=String(e.vox_type||"value"),r=e.summary&&typeof e.summary=="object"?e.summary:{};return["integer","number","boolean"].includes(t)?`${t}: ${r.value}`:t==="string"?`string(${r.length||0}): ${r?.value||""}`:t==="ndarray"?`ndarray ${(r.shape||[]).join("x")} ${r.dtype||""}`.trim():["image2d","volume3d"].includes(t)?`${t} ${(r.size||[]).join("x")} ${r.pixel_id||""}`.trim():t==="sequence"?`sequence length=${r.length||0}`:t==="mapping"?`mapping length=${r.length||0}`:t},cc=e=>String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"),Ts=e=>String(e).replaceAll("&","&amp;").replaceAll('"',"&quot;").replaceAll("'","&#39;").replaceAll("<","&lt;").replaceAll(">","&gt;"),$s=["import","let","in","for","do","true","false"],uc=new Set($s),fc=/[A-Za-z_.$]/,dc=/[A-Za-z0-9_.$]/,vc=/[0-9]/,Dn=/[A-Za-z0-9_.$]/,pc=e=>{const t=String(e?.location||""),r=String(e?.message||""),s=`${t} ${r}`;let a=s.match(/line\s+(\d+)(?:\s*,\s*column\s+(\d+))?/i);return a?{line:Number(a[1]),column:a[2]?Number(a[2]):null}:(a=s.match(/(?:^|\s)(\d+):(\d+)(?:\s|$)/),a?{line:Number(a[1]),column:Number(a[2])}:null)},_c=e=>{const t=[];let r=0;for(;r<e.length;){const s=e[r];if(s==="/"&&e[r+1]==="/"){t.push({kind:"comment",text:e.slice(r)});break}if(s==='"'){let a=r+1;for(;a<e.length;){if(e[a]==='"'&&e[a-1]!=="\\"){a+=1;break}a+=1}t.push({kind:"string",text:e.slice(r,a)}),r=a;continue}if(vc.test(s)){let a=r+1;for(;a<e.length&&/[0-9.]/.test(e[a]);)a+=1;t.push({kind:"number",text:e.slice(r,a)}),r=a;continue}if(fc.test(s)){let a=r+1;for(;a<e.length&&dc.test(e[a]);)a+=1;const i=e.slice(r,a);t.push({kind:uc.has(i)?"keyword":"identifier",text:i}),r=a;continue}if(/\s/.test(s)){let a=r+1;for(;a<e.length&&/\s/.test(e[a]);)a+=1;t.push({kind:"space",text:e.slice(r,a)}),r=a;continue}t.push({kind:"operator",text:s}),r+=1}return t},hc=(e,t)=>{const r=String(e.text||""),s=cc(r);if(e.kind==="space")return s;if(e.kind==="identifier"&&t.has(r)){const i=encodeURIComponent(r);return`<button type="button" class="vx-editor__symbol" data-token="${Ts(i)}" title="Inspect ${Ts(r)}">${s}</button>`}return`<span class="${`vx-editor__token vx-editor__token--${Ts(e.kind)}`}">${s}</span>`},gc=(e,t={},r=[])=>{const s=String(e||""),a=new Set(Object.keys(t||{})),i=new Set;for(const c of Array.isArray(r)?r:[]){const u=pc(c);u?.line&&Number.isFinite(u.line)&&u.line>0&&i.add(u.line)}return s.split(`
`).map((c,u)=>{const v=u+1,h=i.has(v)?"vx-editor__line vx-editor__line--error":"vx-editor__line",p=_c(c).map(w=>hc(w,a)).join("");return`<span class="${h}" data-line="${v}">${p||" "}</span>`}).join("")},mc=(e,t)=>{const r=String(e||""),s=Math.max(0,Math.min(Number(t||0),r.length));let a=s,i=s;for(;a>0&&r[a-1]!==`
`;)a-=1;for(;i<r.length&&r[i]!==`
`;)i+=1;const l=r.slice(a,i).trim();return l?l.length<=160?l:`${l.slice(0,157)}...`:""},bc=(e,t)=>{const r=String(e||"");if(!Number.isInteger(t)||t<0)return{token:"",start:0,end:0};const s=Math.max(0,Math.min(t,r.length));let a=s,i=s;for(;a>0&&Dn.test(r[a-1]);)a-=1;for(;i<r.length&&Dn.test(r[i]);)i+=1;return{token:r.slice(a,i).trim(),start:a,end:i}},yc=e=>!!e&&!/[A-Za-z0-9_$]/.test(e),wc=(e,t,r)=>{const s=String(e?.value||"");if(!e)return null;const a=e.getBoundingClientRect();if(t<a.left||t>a.right||r<a.top||r>a.bottom)return null;const i=window.getComputedStyle(e),l=i.font||`${i.fontSize} ${i.fontFamily}`,c=Number.parseFloat(i.lineHeight)||Number.parseFloat(i.fontSize)*1.5,u=Number.parseFloat(i.paddingLeft)||0,v=Number.parseFloat(i.paddingTop)||0,h=document.createElement("span");h.style.position="absolute",h.style.visibility="hidden",h.style.whiteSpace="pre",h.style.font=l,h.textContent="MMMMMMMMMM",document.body.appendChild(h);const m=Math.max(1,h.getBoundingClientRect().width/10);h.remove();const p=t-a.left+e.scrollLeft-u,w=r-a.top+e.scrollTop-v,y=Math.max(0,Math.floor(w/c)),x=Math.max(0,Math.floor(p/m)),b=s.split(`
`),E=Math.min(y,Math.max(0,b.length-1));let F=0;for(let T=0;T<E;T+=1)F+=b[T].length+1;return F+=Math.min(x,b[E].length),Math.min(F,s.length)},xc=(e,t)=>{const r=String(e||""),s=Math.max(0,Math.min(Number(t||0),r.length));let a=1,i=-1;for(let l=0;l<s;l+=1)r[l]===`
`&&(a+=1,i=l);return{line:a,column:s-i}},Sc=(e,t)=>{const r=String(e||""),s=Math.max(0,Math.min(Number(t||0),r.length));let a=s;for(;a>0&&Dn.test(r[a-1]);)a-=1;let i=s;for(;i<r.length&&Dn.test(r[i]);)i+=1;const l=r.slice(a,s),c=r.slice(a,i),u=xc(r,s);return{text:r,cursor:s,from:a,to:i,prefix:l,token:c,line:u.line,column:u.column}},kc=(e,{symbols:t={},keywords:r=$s,builtins:s=[]}={})=>{const a=String(e?.prefix||""),i=a.toLowerCase(),l=new Map;for(const c of r)l.set(c,{label:c,insertText:c,kind:"keyword",detail:"language keyword"});for(const c of s){const u=String(c||"");u&&l.set(u,{label:u,insertText:u,kind:"primitive",detail:"known primitive"})}for(const c of Object.keys(t||{}))l.set(c,{label:c,insertText:c,kind:"symbol",detail:"declared symbol"});return Array.from(l.values()).filter(c=>a?String(c.label||"").toLowerCase().startsWith(i):!0).sort((c,u)=>{const v=String(c.label||""),h=String(u.label||""),m=v.toLowerCase()===i,p=h.toLowerCase()===i;return m&&!p?-1:!m&&p?1:v.localeCompare(h)})},Ec=(e,t,r)=>{const s=String(e||""),a=String(r?.insertText||r?.label||""),i=Math.max(0,Math.min(Number(t?.from||0),s.length)),l=Math.max(i,Math.min(Number(t?.to||i),s.length)),c=`${s.slice(0,i)}${a}${s.slice(l)}`,u=i+a.length;return{text:c,cursor:u}},Tc=(e,t)=>{if(!e)return{left:0,top:0,height:0};const r=String(e.value||""),s=Math.max(0,Math.min(Number(t||0),r.length)),a=window.getComputedStyle(e),i=document.createElement("div");i.style.position="absolute",i.style.visibility="hidden",i.style.whiteSpace="pre-wrap",i.style.wordWrap="break-word",i.style.overflow="hidden",i.style.width=a.width,i.style.font=a.font,i.style.lineHeight=a.lineHeight,i.style.padding=a.padding,i.style.border=a.border,i.style.letterSpacing=a.letterSpacing,i.style.tabSize=a.tabSize;const l=r.slice(0,s),c=r.slice(s)||".";i.textContent=l;const u=document.createElement("span");u.textContent=c[0],i.appendChild(u),document.body.appendChild(i);const v=u.getBoundingClientRect(),h=i.getBoundingClientRect(),m=e.getBoundingClientRect(),p=Number.parseFloat(a.lineHeight)||Number.parseFloat(a.fontSize)*1.5,w=v.left-h.left-e.scrollLeft+m.left,y=v.top-h.top-e.scrollTop+m.top;return document.body.removeChild(i),{left:w,top:y,height:p}};var $c=J('<span class="vx-editor__suggestion-kind svelte-9d6ed"> </span>'),Nc=J('<span class="vx-editor__suggestion-detail svelte-9d6ed"> </span>'),Rc=J('<li role="option"><button type="button" class="vx-editor__suggestion-button svelte-9d6ed"><span class="vx-editor__suggestion-label svelte-9d6ed"> </span> <!> <!></button></li>'),Cc=J('<ul class="vx-editor__suggestions svelte-9d6ed" role="listbox" aria-label="Autocomplete suggestions" data-testid="completion-list"></ul>'),Pc=J('<div class="vx-editor svelte-9d6ed" data-testid="vox-code-editor"><div class="vx-editor__shell svelte-9d6ed"><textarea class="vx-editor__input svelte-9d6ed" spellcheck="false"></textarea> <pre class="vx-editor__overlay svelte-9d6ed" aria-hidden="true" role="presentation" tabindex="-1"><!></pre></div> <!></div>');function ui(e,t){Tt(t,!1);let r=be(t,"value",12,""),s=be(t,"symbols",24,()=>({})),a=be(t,"diagnostics",24,()=>[]),i=be(t,"autocompleteEnabled",8,!0),l=be(t,"completionProvider",8,null),c=be(t,"completionKeywords",8,$s),u=be(t,"completionBuiltins",24,()=>[]),v=be(t,"ariaLabel",8,"Program editor"),h=be(t,"placeholder",8,""),m=be(t,"readonly",8,!1);const p=ei();let w=N(),y=N(),x=null,b=null,E=0,F=N(""),T=N([]),A=N(0),R=N(!1),j=null,q=N({left:0,top:0});const H=()=>{o(T,[]),o(A,0),o(R,!1),j=null},X=()=>{!n(y)||!n(w)||(tt(y,n(y).scrollTop=n(w).scrollTop),tt(y,n(y).scrollLeft=n(w).scrollLeft))},Q=()=>{!i()||m()||(b&&clearTimeout(b),b=setTimeout(()=>{Ce(!1)},80))},he=(z,fe)=>{const le=Array.isArray(z)?z:[],re=String(fe?.prefix||"").toLowerCase();return le.map(de=>typeof de=="string"?{label:de,insertText:de,kind:"symbol",detail:""}:{label:String(de?.label||""),insertText:String(de?.insertText||de?.label||""),kind:String(de?.kind||"symbol"),detail:String(de?.detail||"")}).filter(de=>de.label).filter(de=>!re||de.label.toLowerCase().startsWith(re))},Ce=async z=>{if(!i()||m()||!n(w))return;const fe=Number(n(w).selectionStart||0),le=Sc(r(),fe);if(!z&&!le.prefix){H();return}const re=E+1;E=re;let de=[];if(typeof l()=="function")try{de=await l()({...le,symbols:{...s()||{}}})}catch{de=[]}else de=kc(le,{symbols:s(),keywords:c(),builtins:u()});if(re!==E)return;const De=he(de,le);if(!De.length){H();return}const $e=Tc(n(w),le.cursor);o(T,De),o(A,0),o(R,!0),j=le,o(q,{left:Math.max(8,Math.round($e.left+8)),top:Math.max(8,Math.round($e.top+$e.height+6))}),p("completionstate",{open:!0,count:n(T).length,prefix:le.prefix})},Le=async()=>{if(!n(R)||!n(T).length||!j)return!1;const z=n(T)[Math.max(0,Math.min(n(A),n(T).length-1))],fe=Ec(r(),j,z);return r(fe.text),p("change",{value:r()}),H(),await za(),n(w)&&(n(w).focus(),tt(w,n(w).selectionStart=fe.cursor),tt(w,n(w).selectionEnd=fe.cursor)),p("completionapply",{item:z,cursor:fe.cursor}),!0},Pe=()=>{p("change",{value:r()}),p("input",{value:r()}),Q()},Ee=async z=>{if((z.ctrlKey||z.metaKey)&&String(z.key||"").toLowerCase()===" "){z.preventDefault(),await Ce(!0);return}if(n(R)){if(z.key==="ArrowDown"){z.preventDefault(),o(A,(n(A)+1)%n(T).length);return}if(z.key==="ArrowUp"){z.preventDefault(),o(A,(n(A)-1+n(T).length)%n(T).length);return}if(z.key==="Escape"){z.preventDefault(),H();return}(z.key==="Enter"||z.key==="Tab")&&(z.preventDefault(),await Le())}},Oe=z=>{const fe=z.target instanceof Element?z.target.closest(".vx-editor__symbol"):null;if(!fe)return;const le=decodeURIComponent(String(fe.getAttribute("data-token")||""));le&&p("symbolhover",{token:le})},K=z=>{!(z.target instanceof Element&&z.target.closest(".vx-editor__symbol"))||z.relatedTarget instanceof Element&&z.relatedTarget.closest(".vx-editor__symbol")||p("symbolleave")},D=()=>{},Y=()=>{p("symbolleave")},ue=z=>{const fe=z.target instanceof Element?z.target.closest(".vx-editor__symbol"):null;if(!fe)return;z.preventDefault();const le=decodeURIComponent(String(fe.getAttribute("data-token")||""));le&&(p("symbolclick",{token:le}),n(w)?.focus({preventScroll:!0}))},Te=z=>{x&&clearTimeout(x),x=setTimeout(()=>{const fe=wc(n(w),z.clientX,z.clientY);if(!Number.isInteger(fe)){p("hoverleave");return}const le=bc(r(),fe);if(!le.token){p("hoverleave");return}if(!(s()&&s()[le.token])){if(!yc(le.token)){p("hoverleave");return}p("operatorhover",{token:le.token,context:mc(r(),le.start)})}},100)},Ae=()=>{x&&(clearTimeout(x),x=null),p("hoverleave")},Se=async z=>{o(A,Number(z||0)),await Le()},V=()=>{x&&(clearTimeout(x),x=null),b&&(clearTimeout(b),b=null)};jn(()=>{V()}),it(()=>(pe(r()),pe(s()),pe(a())),()=>{o(F,gc(r(),s(),a()))}),it(()=>(n(R),n(T)),()=>{!n(R)&&n(T).length&&o(T,[])}),Rr(),Lt();var G=Pc();ne("blur",Cn,H),ne("beforeunload",Cn,V);var W=d(G),ae=d(W);Lr(ae,z=>o(w,z),()=>n(w));var Z=g(ae,2),ze=d(Z);Tl(ze,()=>n(F)),Lr(Z,z=>o(y,z),()=>n(y));var ke=g(W,2);{var Fe=z=>{var fe=Cc();ct(fe,5,()=>n(T),lt,(le,re,de)=>{var De=Rc(),$e=d(De),ye=d($e),Ze=d(ye),ut=g(ye,2);{var He=Je=>{var We=$c(),Ge=d(We);ee(()=>$(Ge,(n(re),S(()=>n(re).kind)))),I(Je,We)};xe(ut,Je=>{n(re),S(()=>n(re).kind)&&Je(He)})}var It=g(ut,2);{var Gt=Je=>{var We=Nc(),Ge=d(We);ee(()=>$(Ge,(n(re),S(()=>n(re).detail)))),I(Je,We)};xe(It,Je=>{n(re),S(()=>n(re).detail)&&Je(Gt)})}ee(()=>{_n(De,"aria-selected",de===n(A)),Ye(De,1,`vx-editor__suggestion ${de===n(A)?"is-selected":""}`,"svelte-9d6ed"),$(Ze,(n(re),S(()=>n(re).label)))}),ne("click",$e,()=>Se(de)),ne("mousedown",De,Il(function(Je){Ol.call(this,t,Je)})),I(le,De)}),ee(()=>Ss(fe,(n(q),S(()=>`left:${n(q).left}px;top:${n(q).top}px`)))),I(z,fe)};xe(ke,z=>{n(R),n(T),S(()=>n(R)&&n(T).length)&&z(Fe)})}ee(()=>{_n(ae,"aria-label",v()),_n(ae,"placeholder",h()),ae.readOnly=m()}),Ya(ae,r),ne("input",ae,Pe),ne("keydown",ae,Ee),ne("mousemove",ae,Te),ne("mouseleave",ae,Ae),ne("scroll",ae,X),ne("mouseover",Z,Oe),ne("mouseout",Z,K),ne("click",Z,ue),ne("focus",Z,D),ne("blur",Z,Y),I(e,G),$t()}const wt=e=>Number.isFinite(e)?e<.001?`${(e*1e3).toFixed(2)} ms`:`${e.toFixed(3)} s`:"-",fi=e=>Number.isFinite(e)?`${(e*100).toFixed(1)}%`:"-",Qe=e=>{if(!Number.isFinite(e)||e<0)return"-";const t=["B","KB","MB","GB","TB"];let r=e,s=0;for(;r>=1024&&s<t.length-1;)r/=1024,s+=1;return`${r.toFixed(s===0?0:2)} ${t[s]}`},Ns=e=>{const t=e.filter(s=>Number.isFinite(s)).sort((s,a)=>s-a);if(!t.length)return NaN;const r=Math.floor(t.length/2);return t.length%2===1?t[r]:(t[r-1]+t[r])/2},di=e=>{const t=String(e||"idle").toLowerCase();return["running","completed","failed","killed"].includes(t)?t:"neutral"};var Ac=J("<span> </span>");function Rs(e,t){Tt(t,!1);let r=be(t,"value",8,"idle"),s=be(t,"extraClass",8,"");Lt();var a=Ac(),i=d(a);ee((l,c)=>{Ye(a,1,l),$(i,c)},[()=>Wa((pe(di),pe(r()),pe(s()),S(()=>`chip ${di(r())} ${s()}`.trim()))),()=>(pe(r()),S(()=>String(r()||"idle").toLowerCase()))]),I(e,a),$t()}var Mc=J('<div class="inline-error"> </div>'),Lc=J('<div class="inline-error"> </div>'),Ic=J('<section id="tab-start"><article class="card start-shell"><div class="start-split"><section class="start-result"><header class="start-head"><h2>Start</h2> <div class="row gap-s"><!> <button class="btn btn-primary btn-small" type="button">Run</button></div></header> <div class="start-viewer-wrap"><div class="result-inspector start-viewer"></div></div> <footer class="start-caption"><span class="start-caption-main"> </span> <span class="start-caption-type"> </span></footer></section> <div role="separator" aria-orientation="horizontal" aria-label="Resize result and code panes"><span></span></div> <section class="start-editor"><!></section></div> <p class="start-status muted"> </p> <!></article></section>');function Oc(e,t){Tt(t,!1);let r=be(t,"active",8,!1),s=be(t,"capabilities",24,()=>({}));const a="voxlogica.start.program.v1",i=["result","output","masks","vi_sweep_masks"],l=["map","for","range","subsequence","dir","ReadImage","BinaryThreshold","intensity","percentiles","smoothen","grow","touch","not","leq_sv","geq_sv","index"];let u=N(`import "simpleitk"

dataset_root = "tests/data/datasets/BraTS_2019_HGG"
k = 10
hi_thr = 0.93
vi_thr_start = 83
vi_thr_stop = 92
vi_ticks = range(vi_thr_start, vi_thr_stop)
to_thr(tick) = tick / 100
vi_thresholds = map(to_thr, vi_ticks)
all_flair_paths = dir(dataset_root, "*_flair.nii.gz", true, true)
flair_paths = subsequence(all_flair_paths, 0, k)
read_image(path) = ReadImage(path)
to_intensity(img) = intensity(img)
preprocess_flair(flair) =
  let background = touch(leq_sv(0.1, flair), border) in
  let brain = not(background) in
  percentiles(flair, brain, 0)
sweep_case(pflair) =
  let hyper_intense = smoothen(geq_sv(hi_thr, pflair), 5.0) in
  for vi_thr in vi_thresholds do
    let very_intense = smoothen(geq_sv(vi_thr, pflair), 2.0) in
    grow(hyper_intense, very_intense)
flair_images = map(read_image, flair_paths)
flair_intensities = map(to_intensity, flair_images)
pflair_images = map(preprocess_flair, flair_intensities)
vi_sweep_masks = map(sweep_case, pflair_images)`),v=N({}),h=N([]),m="",p=N(62),w=N(!1),y=N(),x=null,b=N("-"),E=N("-"),F=N("idle"),T=N("Write code and run to materialize a result."),A=N(""),R="",j=null,q=null,H=0;const X=()=>{const O=Array.isArray(n(h))?n(h):[];return O.length?O.map(U=>{const B=U?.code?`[${U.code}] `:"",te=U?.message?String(U.message):"Static error",ge=U?.location?` @ ${U.location}`:"";return`${B}${te}${ge}`}).join(`
`):""},Q=({prefix:O=""})=>{const U=new Map;for(const te of["import","let","in","for","do","true","false"])U.set(te,{label:te,insertText:te,kind:"keyword",detail:"language keyword"});for(const te of l)U.set(te,{label:te,insertText:te,kind:"primitive",detail:"known primitive"});for(const te of Object.keys(n(v)||{}))U.set(te,{label:te,insertText:te,kind:"symbol",detail:"declared symbol"});const B=String(O||"").toLowerCase();return Array.from(U.values()).filter(te=>!B||te.label.toLowerCase().startsWith(B)).sort((te,ge)=>String(te.label).localeCompare(String(ge.label)))},he=()=>{j&&(clearInterval(j),j=null)},Ce=()=>{q&&clearTimeout(q),q=setTimeout(()=>{try{window.localStorage.setItem(a,String(n(u)||""))}catch{}},180)},Le=(O,U)=>{const B=Object.keys(U||{});if(!B.length)return"";for(const ge of i)if(B.includes(ge))return ge;const te=[...String(O||"").matchAll(/^\s*([A-Za-z_.$][A-Za-z0-9_.$]*)\s*=/gm)];for(let ge=te.length-1;ge>=0;ge-=1){const ft=String(te[ge]?.[1]||"");if(ft&&U[ft])return ft}return B[B.length-1]||B[0]||""},Pe=()=>{if(x||!n(y))return;const O=window.VoxResultViewer?.ResultViewer;if(typeof O=="function"){x=new O(n(y),{onNavigate:U=>{R=String(U||""),D({enqueue:!1,path:R})},fetchPage:({nodeId:U,path:B,offset:te,limit:ge})=>ai({program:n(u),nodeId:U||"",variable:m,path:B||"",offset:Number(te||0),limit:Number(ge||64),enqueue:!0})});return}x={setLoading:U=>{tt(y,n(y).textContent=U||"Loading...")},setError:U=>{tt(y,n(y).textContent=U||"Viewer error")},renderRecord:U=>{tt(y,n(y).textContent=JSON.stringify(U||{},null,2))}}},Ee=(O,U)=>{const B=String(O?.error||"Unable to inspect value.");o(F,"failed"),o(T,B),o(b,U||"-"),o(E,"error"),o(A,B),x.renderRecord({available:!1,node_id:O?.node_id||"",status:"failed",path:O?.path||"/",error:B,descriptor:{vox_type:"string",format_version:"voxpod/1",summary:{value:B,length:B.length,truncated:!1},navigation:{path:O?.path||"/",pageable:!1,can_descend:!1,default_page_size:64,max_page_size:512}}})},Oe=(O,U)=>{const B=String(O?.compute_status||O?.materialization||"running");o(F,"running"),o(T,`Computing ${U} (${B})`),o(b,U||"-"),o(E,O?.descriptor?.vox_type||"in-progress"),o(A,""),x.renderRecord({...O,available:!1,status:B,path:O?.path||R||"/",descriptor:O?.descriptor&&typeof O.descriptor=="object"?O.descriptor:{vox_type:"unavailable",format_version:"voxpod/1",summary:{reason:`status=${B}`},navigation:{path:O?.path||R||"/",pageable:!1,can_descend:!1,default_page_size:64,max_page_size:512}}})},K=(O,U)=>{const B=O?.descriptor&&typeof O.descriptor=="object"?O.descriptor:null,te=String(O?.materialization||O?.status||"materialized");x.renderRecord(O),o(F,"completed"),o(T,B?ci(B):`Computed ${U}`),o(b,U||"-"),o(E,B?.vox_type||"value"),o(A,""),te==="cached"&&o(T,`${n(T)} (cached)`)},D=async({enqueue:O=!0,path:U=""}={})=>{if(Pe(),!m){o(F,"idle"),o(T,"Define at least one variable to inspect."),o(b,"-"),o(E,"-"),x.renderRecord(null);return}if(n(h).length){o(F,"failed"),o(T,"Fix static diagnostics before execution."),o(b,m),o(E,"error"),x.setError(n(T)),o(A,n(T));return}R=String(U||""),o(F,"running"),o(T,`Resolving ${m}...`),o(b,m),o(E,"in-progress"),o(A,""),x.setLoading(`Resolving ${m}${R?` @ ${R}`:""}...`);try{const B=await si({program:n(u),variable:m,path:R,enqueue:O}),te=String(B?.materialization||""),ge=String(B?.compute_status||""),ft=B?.descriptor&&typeof B.descriptor=="object"?B.descriptor:null,Ir=(te==="cached"||te==="computed")&&!!ft,vr=te==="pending"||te==="missing"||ge==="queued"||ge==="running"||ge==="persisting";if(Ir){he(),K(B,m);return}if(te==="failed"||ge==="failed"||ge==="killed"){he(),Ee(B,m);return}if(vr){Oe(B,m),j||(j=setInterval(()=>{D({enqueue:!1,path:R})},1e3));return}he(),Ee({...B,error:B?.error||"Unexpected materialization state."},m)}catch(B){he(),Ee({error:B.message||"Request failed."},m)}},Y=async()=>{if(s().playground_symbols===!1){o(v,{}),o(h,[]),m="",o(b,"-"),o(E,"-"),o(F,"failed"),o(T,"Program symbol API unavailable on this backend."),o(A,n(T));return}const O=H+1;if(H=O,!String(n(u)||"").trim()){o(v,{}),o(h,[]),m="",o(b,"-"),o(E,"-"),o(F,"idle"),o(T,"Write code and run to materialize a result."),o(A,"");return}try{const B=await ti(n(u));if(O!==H)return;const te=B?.available!==!1;o(v,te?B.symbol_table||{}:{}),o(h,B?.diagnostics||[]),m=Le(n(u),n(v)),o(b,m||"-"),n(h).length?(o(F,"failed"),o(T,"Static diagnostics detected."),o(A,n(T))):m&&(o(F,"idle"),o(T,`Ready to resolve ${m}.`),o(A,""))}catch(B){if(O!==H)return;o(v,{}),o(h,[{code:"E_SYMBOLS",message:B.message||"Unable to refresh symbols."}]),m="",o(b,"-"),o(F,"failed"),o(T,"Unable to refresh symbols."),o(A,n(T))}},ue=async O=>{o(u,String(O?.detail?.value??n(u)??"")),Ce(),await Y()},Te=async O=>{const U=String(O?.detail?.token||"");!U||!n(v)[U]||(m=U,o(b,U),R="",await D({enqueue:!0,path:""}))},Ae=async()=>{he(),await Y(),await D({enqueue:!0,path:""})},Se=O=>{O.preventDefault();const U=O.currentTarget?.parentElement;if(!(U instanceof HTMLElement))return;const B=U.getBoundingClientRect();o(w,!0);const te=ft=>{const Ir=ft.clientY-B.top,vr=Math.max(28,Math.min(82,Ir/B.height*100));o(p,Number(vr.toFixed(2)))},ge=()=>{o(w,!1),window.removeEventListener("pointermove",te),window.removeEventListener("pointerup",ge),window.removeEventListener("pointercancel",ge)};window.addEventListener("pointermove",te),window.addEventListener("pointerup",ge),window.addEventListener("pointercancel",ge)};dr(async()=>{Pe();try{const O=window.localStorage.getItem(a);O&&String(O).trim()&&o(u,O)}catch{}await Y()}),jn(()=>{he(),q&&clearTimeout(q),x&&typeof x.destroy=="function"&&x.destroy()}),Lt();var V=Ic(),G=d(V),W=d(G),ae=d(W),Z=d(ae),ze=g(d(Z),2),ke=d(ze);Rs(ke,{get value(){return n(F)}});var Fe=g(ke,2),z=g(Z,2),fe=d(z);Lr(fe,O=>o(y,O),()=>n(y));var le=g(z,2),re=d(le),de=d(re),De=g(re,2),$e=d(De),ye=g(ae,2),Ze=g(ye,2),ut=d(Ze);ui(ut,{ariaLabel:"Start tab code editor",get symbols(){return n(v)},get diagnostics(){return n(h)},autocompleteEnabled:!0,completionProvider:Q,get completionBuiltins(){return l},get value(){return n(u)},set value(O){o(u,O)},$$events:{change:ue,symbolclick:Te},$$legacy:!0});var He=g(W,2),It=d(He),Gt=g(He,2);{var Je=O=>{var U=Mc(),B=d(U);ee(te=>$(B,te),[()=>S(X)]),I(O,U)},We=Jo(()=>S(X)),Ge=O=>{var U=Lc(),B=d(U);ee(()=>$(B,n(A))),I(O,U)};xe(Gt,O=>{n(We)?O(Je):n(A)&&O(Ge,1)})}ee(()=>{Ye(V,1,`panel ${r()?"active":""}`),Ss(W,`grid-template-rows: minmax(220px, ${n(p)}fr) 10px minmax(220px, ${100-n(p)}fr);`),$(de,n(b)),$($e,n(E)),Ye(ye,1,`start-divider ${n(w)?"is-active":""}`),$(It,n(T))}),ne("click",Fe,Ae),ne("pointerdown",ye,Se),I(e,V),$t()}const vi=e=>{const t=[],r=String(e||"").split(/\r?\n/).map(s=>s.trim()).filter(Boolean);for(const s of r){try{const a=JSON.parse(s);if(a&&typeof a=="object"){t.push(a);continue}}catch{}t.push({event:"raw",message:s})}return t},Fc=(e,t)=>{const r=Array.isArray(e)?e:[],s={queued:0,running:0,completed:0,failed:0,killed:0,other:0,total:r.length};for(const c of r){const u=String(c?.status||"").toLowerCase();u in s?s[u]+=1:u==="success"?s.completed+=1:s.other+=1}const i=vi(t?.log_tail||"").filter(c=>c&&c.event==="playground.node").slice(-360).map(c=>({status:String(c.status||"unknown"),cache_source:String(c.cache_source||"-"),duration_s:Number(c.duration_s||0),operator:String(c.operator||"-"),node_id:String(c.node_id||"")})),l=r.slice(0,36).map(c=>({id:String(c.job_id||""),status:String(c.status||"unknown"),created_at:String(c.created_at||""),started_at:String(c.started_at||""),finished_at:String(c.finished_at||""),wall_time_s:Number(c?.metrics?.wall_time_s||0),strategy:String(c?.request?.execution_strategy||"dask"),kind:String(c?.request?.job_kind||"run")}));return{generated_at:Date.now(),counts:s,jobs:l,node_events:i,active_job_id:t?.job_id?String(t.job_id):""}},zn=e=>{const s=((e?.result||{})?.execution||{}).cache_summary||{},a=String(e?.log_tail||""),i=vi(a),l=i.filter(v=>v.event==="playground.node"),c=l.length?l:i.filter(v=>v.event!=="raw"),u=`computed ${Number(s.computed||0)} | cached(store) ${Number(s.cached_store||0)} | cached(local) ${Number(s.cached_local||0)} | failed ${Number(s.failed||0)} | events ${Number(s.events_stored||l.length)}/${Number(s.events_total||l.length)}`;return{raw:a,summaryText:u,rows:c.slice(-220).reverse()}};var jc=J("<option> </option>"),Dc=J("<option> </option>"),zc=J('<div id="programDiagnostics" class="inline-error"> </div>'),qc=J('<div id="runError" class="inline-error"> </div>'),Bc=J('<div class="muted"> </div>'),Vc=J('<div class="muted">No jobs executed yet.</div>'),Uc=J('<button type="button"> </button>'),Jc=J("<span> </span>"),Hc=J('<button class="btn btn-danger btn-small" type="button">Kill</button>'),Wc=J('<article class="job-item"><div class="job-row"><strong> </strong> <!></div> <div class="job-row"><span> </span> <span> </span></div> <div class="job-row"><span> </span> <div class="row gap-s"><button class="btn btn-ghost btn-small" type="button">Open</button> <!></div></div></article>'),Gc=J("<option>No print labels or variables available</option>"),Kc=J("<option> </option>"),Yc=J('<div class="muted">No node events available yet. Raw log is shown below.</div>'),Qc=J('<article class="table-like-row"><div class="name"><span class="mini-chip"> </span> </div> <div class="detail"> <!></div></article>'),Zc=J('<article class="table-like-row"><div class="name"> </div> <div class="detail"> </div></article>'),Xc=J(`<section id="tab-playground"><div class="grid-two"><article class="card editor-card"><div class="card-header"><h2>Interactive Playground</h2> <div class="row gap-s"><label class="inline-control" for="executionStrategy">Strategy</label> <select id="executionStrategy" class="select" disabled=""><option selected="">dask</option></select></div></div> <div id="editorShell" class="editor-shell"><!></div> <div class="row controls"><label class="inline-control" for="programLibrarySelect">Program Library</label> <select id="programLibrarySelect" class="select"><!></select> <button id="loadProgramFileBtn" class="btn btn-ghost btn-small" type="button">Load from Library</button></div> <p id="programLibraryMeta" class="muted"> </p> <p class="muted">Variables are directly clickable in the editor. Hover changes appearance, click resolves on demand with
        priority even when no full run has been launched.</p> <div id="editorHoverPreview" class="editor-hover-preview muted"> </div> <!> <div class="row controls"><button id="runProgramBtn" class="btn btn-primary hidden" type="button">Run Program</button> <button id="killProgramBtn" class="btn btn-danger" type="button">Kill Running Job</button> <button id="clearOutputBtn" class="btn btn-ghost" type="button">Clear Output</button> <!></div> <!></article> <article class="card telemetry-card"><div class="card-header"><h2>Runtime Telemetry</h2> <button id="refreshJobsBtn" class="btn btn-ghost btn-small" type="button">Refresh</button></div> <div class="stats-grid"><div class="stat"><span class="label">Wall Time</span><strong id="metricWall"> </strong></div> <div class="stat"><span class="label">CPU Time</span><strong id="metricCpu"> </strong></div> <div class="stat"><span class="label">CPU Util.</span><strong id="metricCpuUtil"> </strong></div> <div class="stat"><span class="label">Peak Python Heap</span><strong id="metricHeapPeak"> </strong></div> <div class="stat"><span class="label">RSS Delta</span><strong id="metricRssDelta"> </strong></div> <div class="stat"><span class="label">Current Job</span><strong id="metricJobId"> </strong></div></div> <h3 class="subheading">Recent Jobs</h3> <div id="recentJobs" class="job-list"><!></div> <h3 class="subheading">Dask Queue Flux</h3> <div id="daskQueueViz" class="dask-queue-viz"></div> <h3 class="subheading">Focused Result</h3> <div class="row gap-s controls"><label class="inline-control" for="playResultSelector">Target</label> <select id="playResultSelector" class="select"><!></select></div> <p id="playResultMeta" class="muted"> </p> <div id="playResultInspector" class="result-inspector compact"></div> <h3 class="subheading">Execution Log</h3> <p id="playExecSummary" class="muted"> </p> <div id="playExecLog" class="table-like muted"><!></div> <pre id="playExecRaw" class="mono-scroll compact-log"> </pre></article></div> <div class="grid-two"><article class="card"><h2>Execution Result</h2> <pre id="executionOutput" class="mono-scroll"> </pre></article> <article class="card"><h2>Task Graph (Text)</h2> <pre id="taskGraphOutput" class="mono-scroll"> </pre></article></div></section>`);function eu(e,t){Tt(t,!1);const r=N(),s=N();let a=be(t,"active",8,!1),i=be(t,"capabilities",24,()=>({}));const l="brats_flair_mean_threshold.imgql";let u=N(`import "simpleitk"

dataset_root = "tests/data/datasets/BraTS_2019_HGG"

// Controls.
k = 10
hi_thr = 0.93
vi_thr_start = 83
vi_thr_stop = 92
vi_ticks = range(vi_thr_start, vi_thr_stop)
to_thr(tick) = tick / 100
vi_thresholds = map(to_thr, vi_ticks)

// Recursively discover BraTS FLAIR volumes and keep first k cases.
all_flair_paths = dir(dataset_root, "*_flair.nii.gz", true, true)
flair_paths = subsequence(all_flair_paths, 0, k)

// Paper method (simplified branch): lines 1-6 of the GBM specification.
// We sweep viThr in [0.83, 0.91] with step 0.01 while keeping hiThr fixed at 0.93.
read_image(path) = ReadImage(path)
to_intensity(img) = intensity(img)
preprocess_flair(flair) =
  let background = touch(leq_sv(0.1, flair), border) in
  let brain = not(background) in
  percentiles(flair, brain, 0)

sweep_case(pflair) =
  let hyper_intense = smoothen(geq_sv(hi_thr, pflair), 5.0) in
  for vi_thr in vi_thresholds do
    let very_intense = smoothen(geq_sv(vi_thr, pflair), 2.0) in
    grow(hyper_intense, very_intense)

// Debuggable sequence-of-maps pipeline.
flair_images = map(read_image, flair_paths)
flair_intensities = map(to_intensity, flair_images)
pflair_images = map(preprocess_flair, flair_intensities)

// Sequence of sequences: for each case, one mask per viThr value.
vi_sweep_masks = map(sweep_case, pflair_images)`),v=N([]),h=N(""),m=N(""),p=!1,w=!1,y=N([]),x=N({}),b=[],E=[],F=N({}),T=0,A=null,R=N(""),j=N("idle"),q="",H=null,X=N([]),Q=N("-"),he=N("-"),Ce=N("-"),Le=N("-"),Pe=N("-"),Ee=N("-"),Oe=N(""),K=N(""),D=N("Click inspect on a variable to resolve it on demand."),Y=N([]),ue=N(-1),Te=N("No execution trace yet."),Ae=N(""),Se=N([]),V=N(""),G=N("Hover a variable to see cached value status, or hover an operator to inspect expression context."),W=0,ae="",Z=N(),ze=N(),ke=null,Fe=null,z=null,fe="",le=null,re=null,de=null,De=0,$e=null,ye=null,Ze=null,ut=0,He="";const It=["map","for","range","subsequence","dir","ReadImage","BinaryThreshold","intensity","percentiles","smoothen","grow","touch","not","leq_sv","geq_sv","index"],Gt=f=>{const _=Array.isArray(f)?f:[];return _.length?_.map(k=>{const P=k?.code?`[${k.code}] `:"",M=k?.message?String(k.message):"Static error",oe=k?.symbol?` (symbol: ${k.symbol})`:"",we=k?.location?` @ ${k.location}`:"";return`${P}${M}${oe}${we}`}).join(`
`):""},Je=({prefix:f=""})=>{const _=new Map;for(const P of["import","let","in","for","do","true","false"])_.set(P,{label:P,insertText:P,kind:"keyword",detail:"language keyword"});for(const P of It)_.set(P,{label:P,insertText:P,kind:"primitive",detail:"known primitive"});for(const P of Object.keys(n(s)||{}))_.set(P,{label:P,insertText:P,kind:"symbol",detail:"declared symbol"});const k=String(f||"").toLowerCase();return Array.from(_.values()).filter(P=>!k||P.label.toLowerCase().startsWith(k)).sort((P,M)=>String(P.label).localeCompare(String(M.label)))},We=f=>{const _=f?.metrics||{};o(Q,wt(Number(_.wall_time_s))),o(he,wt(Number(_.cpu_time_s))),o(Ce,fi(Number(_.cpu_utilization))),o(Le,Qe(Number(_.python_heap_peak_bytes))),o(Pe,Qe(Number(_.ru_maxrss_delta_bytes))),o(Ee,f?.job_id?String(f.job_id).slice(0,12):"-")},Ge=f=>{o(j,String(f||"idle").toLowerCase())},O=()=>{o(R,"")},U=()=>`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}`,B=f=>{const _=Math.min(8,Math.max(0,Number(f||0))),k=Math.min(5e3,250*2**_),P=Math.floor(Math.random()*180);return k+P},te=()=>{de&&(clearTimeout(de),de=null);const f=re;if(re=null,f)try{f.close()}catch{}},ge=()=>{Ze&&(clearTimeout(Ze),Ze=null);const f=ye;if(ye=null,f)try{f.close()}catch{}},ft=()=>{re&&(re.readyState===WebSocket.OPEN||re.readyState===WebSocket.CONNECTING)||(te(),re=new WebSocket(`${U()}/ws/playground/value`),re.onopen=()=>{De=0,$e&&re.send(JSON.stringify({type:"subscribe",request:{program:n(u),execution_strategy:"dask",node_id:$e.nodeId,variable:$e.variable||"",path:$e.path||"",enqueue:$e.enqueue!==!1}}))},re.onmessage=f=>{try{const _=JSON.parse(String(f.data||"{}"));_?.type==="value"&&_?.payload&&$e&&Hn(_.payload,$e)}catch{}},re.onclose=()=>{if(re=null,!$e)return;De+=1;const f=B(De);de&&clearTimeout(de),de=setTimeout(()=>{ft()},f)},re.onerror=()=>{try{re?.close()}catch{}})},Ir=({nodeId:f="",variable:_="",path:k="",enqueue:P=!0}={})=>"WebSocket"in window?($e={nodeId:f,variable:_,path:k,enqueue:P},ft(),re&&re.readyState===WebSocket.OPEN&&re.send(JSON.stringify({type:"subscribe",request:{program:n(u),execution_strategy:"dask",node_id:f,variable:_,path:k,enqueue:P}})),!0):!1,vr=()=>{ye&&(ye.readyState===WebSocket.OPEN||ye.readyState===WebSocket.CONNECTING)||(ge(),ye=new WebSocket(`${U()}/ws/playground/jobs`),ye.onopen=()=>{ut=0,He&&ye.send(JSON.stringify({type:"subscribe",job_id:He}))},ye.onmessage=async f=>{try{const _=JSON.parse(String(f.data||"{}"));if(_?.type!=="job"&&_?.type!=="terminal")return;const k=_?.payload||null;if(!k)return;H=k||null,Ge(k.status),We(k);const{raw:P,summaryText:M,rows:oe}=zn(k);o(Ae,P),o(Te,M),o(Se,oe),Yt(),_.type==="terminal"&&(He="",await mn(k))}catch{}},ye.onclose=()=>{if(ye=null,!He)return;ut+=1;const f=B(ut);Ze&&clearTimeout(Ze),Ze=setTimeout(()=>{vr()},f)},ye.onerror=()=>{try{ye?.close()}catch{}})},Bn=(f="")=>!f||!("WebSocket"in window)?!1:(He=String(f),vr(),ye&&ye.readyState===WebSocket.OPEN&&ye.send(JSON.stringify({type:"subscribe",job_id:He})),!0),Kt=()=>{z&&(clearInterval(z),z=null),He="",ge()},Ot=()=>{$e=null,te()},pr=()=>{const f=n(Y)[n(ue)];if(o(Y,ac({precomputedPrintTargets:b,latestGoalResults:E,precomputedSymbolTable:n(x),latestSymbolTable:n(F)})),!n(Y).length){o(ue,-1);return}if(f){const _=n(Y).findIndex(k=>k.kind===f.kind&&k.label===f.label&&k.nodeId===f.nodeId);o(ue,_>=0?_:0);return}o(ue,0)},Gr=()=>{if(ke||!n(Z))return;const f=window.VoxResultViewer?.ResultViewer;if(typeof f=="function"){ke=new f(n(Z),{onNavigate:_=>{const k=n(Y)[n(ue)];k?.nodeId&&Kr(k.nodeId,_||"",{variable:k.kind==="variable"?k.label:""})},fetchPage:({nodeId:_,path:k,offset:P,limit:M})=>{const oe=n(Y)[n(ue)],we=oe?.kind==="variable"?oe.label:"";return ai({program:n(u),nodeId:_||oe?.nodeId||"",variable:we,path:k||"",offset:Number(P||0),limit:Number(M||64),enqueue:!0})},onStatusClick:_=>{!_||_.status!=="failed"&&_.status!=="killed"||gn(_,{nodeId:_.node_id||"",path:_.path||""})}});return}ke={setLoading:_=>{tt(Z,n(Z).textContent=_||"Loading...")},setError:_=>{tt(Z,n(Z).textContent=_||"Viewer error")},renderRecord:_=>{tt(Z,n(Z).textContent=JSON.stringify(_||{},null,2))}}},hn=()=>{if(Fe||!n(ze))return;const f=window.VoxDaskQueueViz?.DaskQueueVisualizer;if(typeof f=="function"){Fe=new f(n(ze));return}Fe={render:_=>{const k=_?.counts||{};tt(ze,n(ze).textContent=`queue: queued ${Number(k.queued||0)} | running ${Number(k.running||0)} | completed ${Number(k.completed||0)} | failed ${Number(k.failed||0)}`)}}},Yt=()=>{hn(),Fe&&Fe.render(Fc(n(X),H))},Vn=async f=>{const _=f?.result||{};o(Oe,JSON.stringify(_,null,2)),o(K,_.task_graph||"(no task graph in payload)"),Array.isArray(_.goal_results)&&(E=_.goal_results),_.symbol_table&&typeof _.symbol_table=="object"&&o(F,_.symbol_table);const{raw:k,summaryText:P,rows:M}=zn(f);if(o(Ae,k),o(Te,P),o(Se,M),pr(),n(Y).length&&n(ue)>=0){const oe=n(Y)[n(ue)];await Kr(oe.nodeId,"",{variable:oe.kind==="variable"?oe.label:""})}Yt()},Cs=async()=>{if(i().playground_program_library===!1){o(v,[]),o(h,""),o(m,"Program library endpoint unavailable on this backend.");return}try{const f=await Jl();if(!f.available){o(v,[]),o(h,""),o(m,f.error||"Program library unavailable.");return}if(o(v,f.files||[]),!n(v).length){o(h,""),w=!0,o(m,`${f.load_dir} | 0 files`);return}const _=n(v).find(k=>{const P=String(k?.path||"");return P===l||P.endsWith(`/${l}`)});w?(!n(h)||!n(v).some(k=>k.path===n(h)))&&o(h,_?.path||n(v)[0].path):(o(h,_?.path||n(v)[0].path),w=!0),o(m,`${f.load_dir} | ${n(v).length} file(s)`)}catch(f){o(v,[]),o(h,""),o(m,`Unable to load library: ${f.message}`)}},Un=async()=>{if(n(h))try{const f=await Hl(n(h));o(u,f.content||""),o(m,`${f.path} | ${Qe(Number(f.bytes||0))}`),E=[],o(F,{}),await Ft(),O()}catch(f){o(m,`Unable to load ${n(h)}: ${f.message}`)}},Ft=async()=>{if(i().playground_symbols===!1)return;const f=T+1;if(T=f,!String(n(u)||"").trim()){o(x,{}),b=[],o(y,[]),pr();return}try{const _=await ti(n(u));if(f!==T)return;const k=_?.available!==!1;o(x,k?_.symbol_table||{}:{}),b=k?_.print_targets||[]:[],o(y,_?.diagnostics||[]),pr()}catch(_){if(f!==T)return;o(x,{}),b=[],o(y,[{code:"E_SYMBOLS",message:`Unable to refresh symbols: ${_.message}`}]),pr()}},Ps=()=>{A&&clearTimeout(A),A=setTimeout(()=>{Ft()},260)},Jn=({nodeId:f="",variable:_="",path:k="",enqueue:P=!0})=>si({program:n(u),nodeId:f,variable:_,path:k,enqueue:P}),gn=(f,_)=>{const k=String(f.node_id||_.nodeId||""),P=f.path||_.path||"",oe=String(f.compute_status||f.status||"failed").toLowerCase()==="killed"?"killed":"failed",we=lc(f,_),Xe=String(f.error||"Value inspection failed.");if(ke.renderRecord({available:!1,node_id:k,status:oe,runtime_version:f.runtime_version||"runtime",updated_at:f.updated_at||new Date().toISOString(),path:P,error:Xe,log_tail:f.log_tail||"",execution_errors:oi(f),descriptor:{vox_type:"string",format_version:"voxpod/1",summary:{value:we,length:we.length,truncated:!1},navigation:{path:P||"",pageable:!1,can_descend:!1,default_page_size:64,max_page_size:512}},diagnostics:f.diagnostics||{}}),o(D,`Unable to inspect ${k.slice(0,12)}${P?` @ ${P}`:""}: ${Xe}`),f.log_tail){const{raw:St,summaryText:dt,rows:zt}=zn({log_tail:f.log_tail,result:{execution:{cache_summary:f?.cache_summary||f?.diagnostics?.cache_summary||{}}}});o(Ae,St),o(Te,dt),o(Se,zt);return}o(Ae,""),o(Te,"No execution log available for this failure."),o(Se,[])},Hn=(f,_)=>{const k=String(f.materialization||""),P=String(f.compute_status||""),M=String(f.status||""),oe=String(f.node_id||_.nodeId||""),we=f.path||_.path||"",Xe=f.job_id?String(f.job_id):"",St=f?.descriptor&&typeof f.descriptor=="object"?String(f.descriptor.vox_type||""):"",dt=f?.descriptor&&St&&St!=="unavailable"&&St!=="error";if((k==="cached"||k==="computed"||M==="materialized")&&dt){Ot(),fe="",ke.renderRecord(f),o(D,`Inspecting ${oe.slice(0,12)}${we?` @ ${we}`:""} | ${k||"materialized"} | status=${P||"materialized"}`);return}if(k==="failed"||P==="failed"||P==="killed"||M==="failed"){Ot(),fe="",gn(f,_);return}if(k==="pending"||k==="missing"||P==="queued"||P==="running"||P==="persisting"){const tr=`${oe}|${we||""}`,br=(St==="sequence"||St==="mapping")&&f?.descriptor&&typeof f.descriptor=="object"?f.descriptor:{vox_type:"unavailable",format_version:"voxpod/1",summary:{reason:`status=${P||"pending"}`},navigation:{path:we||"",pageable:!1,can_descend:!1,default_page_size:64,max_page_size:512}},yr={...f,available:!1,node_id:oe,status:P||"running",runtime_version:f.runtime_version||"runtime",updated_at:f.updated_at||new Date().toISOString(),path:we,descriptor:br};fe===tr&&typeof ke.refreshPage=="function"?ke.refreshPage(oe,we):(ke.renderRecord(yr),fe=tr),o(D,`In progress ${oe.slice(0,12)}${we?` @ ${we}`:""} | ${P||"pending"}${Xe?` | job ${Xe.slice(0,12)}`:""}`),Ir({nodeId:oe,variable:_.variable||"",path:we,enqueue:!1});return}Ot();const er=f.error||(k==="missing"?"Value is not materialized yet.":`Unable to inspect value (${k||P||"unknown"}).`);gn({...f,error:er,compute_status:P||"failed",status:f.status||"failed"},_)},Kr=async(f,_="",k={})=>{Gr(),Ot();const P=String(k.variable||"");o(D,`Resolving ${f.slice(0,12)}${_?` @ ${_}`:""}...`);try{const M=await Jn({nodeId:f,variable:P,path:_,enqueue:k.enqueue!==!1});Hn(M,{nodeId:f,variable:P,path:_})}catch(M){Ot(),ke.setError(`Value lookup failed: ${M.message}`),o(D,`Unable to inspect ${f.slice(0,12)}: ${M.message}`)}},_r=async()=>{try{const f=await Gl();o(X,f.jobs||[]),o(V,""),!H&&n(X).length&&(H=n(X)[0]),Yt()}catch(f){o(X,[]),o(V,`Failed to load jobs: ${f.message}`),Yt()}},mn=async f=>{H=f||null,Ge(f?.status),We(f),await Vn(f),o(R,f?.error||""),await _r()},bn=async()=>{if(q)try{const f=await ri(q);H=f||null,Ge(f.status),We(f);const{raw:_,summaryText:k,rows:P}=zn(f);if(o(Ae,_),o(Te,k),o(Se,P),Yt(),f.status==="running")return;Kt(),await mn(f)}catch(f){Kt(),Ge("failed"),o(R,`Polling failed: ${f.message}`)}},yn=async()=>{if(O(),await Ft(),n(y).length){o(R,"Static diagnostics must be fixed before execution can start.");return}try{Ge("running"),Ot(),o(Oe,""),o(K,""),o(Ae,""),o(Se,[]),o(Te,"Execution started. Waiting for log events..."),We(null);const f=await Wl(n(u));q=f.job_id,o(Ee,String(f.job_id||"").slice(0,12)),Kt(),Bn(String(q||""))||(z=setInterval(bn,800),await bn())}catch(f){Ge("failed"),o(R,f.message)}},As=()=>{o(Oe,""),o(K,""),o(R,""),We(null),o(Te,"No execution log yet."),o(Ae,""),o(Se,[]),E=[],o(F,{}),H=null,Ot(),fe="",o(D,"Click inspect on a variable to resolve it on demand."),Gr(),ke.renderRecord(null),pr(),o(ue,n(Y).length?0:-1),Yt()},Ms=async()=>{if(q)try{const f=await ni(q);Kt(),await mn(f)}catch(f){o(R,`Kill failed: ${f.message}`)}},C=async f=>{if(f)try{const _=await ri(f);q=f,H=_||null,Ge(_.status),We(_),await Vn(_),_.status==="running"&&(Kt(),Bn(String(f||""))||(z=setInterval(bn,800)));const k=_?.result?.execution?.errors;(_.status==="failed"||_.status==="killed")&&k&&typeof k=="object"?o(R,[_.error||"Execution failed",li(k)].filter(Boolean).join(`
`)):o(R,_.error||"")}catch(_){o(R,`Unable to open ${f}: ${_.message}`)}},se=async f=>{try{await ni(f),q===f&&(Kt(),Ge("killed")),await _r()}catch(_){o(R,`Unable to kill ${f}: ${_.message}`)}},Ie=async()=>{const f=Number(n(ue));if(!Number.isFinite(f)||(o(ue,f),n(ue)<0||n(ue)>=n(Y).length))return;const _=n(Y)[n(ue)];await Kr(_.nodeId,"",{variable:_.kind==="variable"?_.label:""})},Me=f=>n(x)[f]||n(F)[f]||"",ie=f=>{o(G,f||"")},qe=()=>{W+=1,ae="",ie("Hover a variable to see cached value status, or hover an operator to inspect expression context.")},xt=async f=>{const _=Me(f);if(!_)return;qe();const k=n(Y).findIndex(P=>P.kind==="variable"&&P.label===f);k>=0&&o(ue,k),await Kr(_,"",{variable:f})},jt=async f=>{const _=W+1;W=_,ie(`var ${f}: checking cache...`);try{const k=await Jn({variable:f,enqueue:!1});if(_!==W||ae!==f)return;const P=String(k.materialization||"");if(k.descriptor&&(P==="cached"||P==="computed")){ie(`var ${f}: ${ci(k.descriptor)} (${P})`);return}if(P==="pending"||k.compute_status==="running"||k.compute_status==="queued"||k.compute_status==="persisting"){ie(`var ${f}: running (${k.compute_status}). Click to focus/inspect.`);return}ie(`var ${f}: not materialized yet. Click to compute on demand.`)}catch{if(_!==W||ae!==f)return;ie(`var ${f}: click to compute on demand.`)}},Qt=async f=>{if(!f)return!1;let _=Me(f)?f:"";return _||(await Ft(),_=Me(f)?f:""),_?(ae=_,await xt(_),!0):!1},Dt=f=>{o(u,String(f?.detail?.value??n(u)??"")),o(F,{}),E=[],Ps(),qe()},Or=async f=>{const _=String(f?.detail?.token||"");_&&(ae=_,await jt(_))},Fr=()=>{qe()},hr=async f=>{const _=String(f?.detail?.token||"");_&&(ae=_,await Qt(_))},gr=f=>{const _=String(f?.detail?.token||"");if(!_)return;const k=String(f?.detail?.context||"");ie(k?`operator '${_}' in: ${k}`:`operator '${_}'`)},mr=()=>{qe()},Zt=async f=>{await C(f)},Ls=()=>{le||(le=setInterval(()=>{a()&&(_r(),Ft())},15e3))},wn=()=>{le&&(clearInterval(le),le=null)};async function Wn(f,_=!1){o(u,String(f||"")),o(F,{}),E=[],qe(),await Ft(),_&&await yn()}async function Gn(){await yn()}dr(()=>{Gr(),hn(),Yt(),(async()=>(await Cs(),!p&&n(h)&&(p=!0,await Un()),await Promise.all([_r(),Ft()])))()}),jn(()=>{Kt(),Ot(),wn(),A&&clearTimeout(A),Fe&&typeof Fe.destroy=="function"&&Fe.destroy(),ke&&typeof ke.destroy=="function"&&ke.destroy()}),it(()=>n(y),()=>{o(r,Gt(n(y)))}),it(()=>(n(x),n(F)),()=>{o(s,{...n(x)||{},...n(F)||{}})}),it(()=>pe(a()),()=>{a()?(_r(),Ft(),Ls()):wn()}),it(()=>pe(i()),()=>{i().playground_program_library===!1&&o(m,"Program library endpoint unavailable on this backend.")}),Rr();var Is={loadProgram:Wn,runCurrentProgram:Gn};Lt();var Xt=Xc(),xn=d(Xt),_i=d(xn),hi=d(_i),Mu=g(d(hi),2),Lu=g(d(Mu),2),gi=d(Lu);gi.value=gi.__value="dask";var mi=g(hi,2),Iu=d(mi);ui(Iu,{ariaLabel:"VoxLogicA program editor",get symbols(){return n(s)},get diagnostics(){return n(y)},autocompleteEnabled:!0,completionProvider:Je,get completionBuiltins(){return It},get value(){return n(u)},set value(f){o(u,f)},$$events:{change:Dt,symbolhover:Or,symbolleave:Fr,symbolclick:hr,operatorhover:gr,hoverleave:mr},$$legacy:!0});var bi=g(mi,2),Kn=g(d(bi),2),Ou=d(Kn);{var Fu=f=>{var _=jc(),k=d(_);_.value=_.__value="",ee(()=>$(k,(pe(i()),S(()=>i().playground_program_library===!1?"unavailable":"no .imgql files found")))),I(f,_)},ju=f=>{var _=yt(),k=at(_);ct(k,1,()=>n(v),lt,(P,M)=>{var oe=Dc(),we=d(oe),Xe={};ee(()=>{$(we,(n(M),S(()=>n(M).path))),Xe!==(Xe=(n(M),S(()=>n(M).path)))&&(oe.value=(oe.__value=(n(M),S(()=>n(M).path)))??"")}),I(P,oe)}),I(f,_)};xe(Ou,f=>{n(v),S(()=>!n(v).length)?f(Fu):f(ju,!1)})}var yi=g(Kn,2),wi=g(bi,2),Du=d(wi),xi=g(wi,4),zu=d(xi),Si=g(xi,2);{var qu=f=>{var _=zc(),k=d(_);ee(()=>$(k,n(r))),I(f,_)};xe(Si,f=>{n(r)&&f(qu)})}var ki=g(Si,2),Ei=d(ki),Os=g(Ei,2),Ti=g(Os,2),Bu=g(Ti,2);Rs(Bu,{get value(){return n(j)}});var Vu=g(ki,2);{var Uu=f=>{var _=qc(),k=d(_);ee(()=>$(k,n(R))),I(f,_)};xe(Vu,f=>{n(R)&&f(Uu)})}var Ju=g(_i,2),$i=d(Ju),Hu=g(d($i),2),Ni=g($i,2),Ri=d(Ni),Wu=g(d(Ri)),Gu=d(Wu),Ci=g(Ri,2),Ku=g(d(Ci)),Yu=d(Ku),Pi=g(Ci,2),Qu=g(d(Pi)),Zu=d(Qu),Ai=g(Pi,2),Xu=g(d(Ai)),ef=d(Xu),Mi=g(Ai,2),tf=g(d(Mi)),rf=d(tf),nf=g(Mi,2),sf=g(d(nf)),af=d(sf),Li=g(Ni,4),of=d(Li);{var lf=f=>{var _=Bc(),k=d(_);ee(()=>$(k,n(V))),I(f,_)},cf=f=>{var _=Vc();I(f,_)},uf=f=>{var _=yt(),k=at(_);ct(k,1,()=>n(X),lt,(P,M)=>{const oe=Ke(()=>(n(M),S(()=>String(n(M).status||"unknown")))),we=Ke(()=>n(oe)==="failed"||n(oe)==="killed");var Xe=Wc(),St=d(Xe),dt=d(St),zt=d(dt),er=g(dt,2);{var tr=kt=>{var vt=Uc(),zs=d(vt);ee(()=>{Ye(vt,1,`chip ${n(oe)} chip-clickable`),$(zs,n(oe))}),ne("click",vt,()=>Zt(n(M).job_id)),I(kt,vt)},Yr=kt=>{var vt=Jc(),zs=d(vt);ee(()=>{Ye(vt,1,`chip ${n(oe)}`),$(zs,n(oe))}),I(kt,vt)};xe(er,kt=>{n(we)?kt(tr):kt(Yr,!1)})}var br=g(St,2),yr=d(br),Qn=d(yr),Fs=g(yr,2),js=d(Fs),jr=g(br,2),Dr=d(jr),Ds=d(Dr),$f=g(Dr,2),Bi=d($f),Nf=g(Bi,2);{var Rf=kt=>{var vt=Hc();ne("click",vt,()=>se(n(M).job_id)),I(kt,vt)};xe(Nf,kt=>{n(oe)==="running"&&kt(Rf)})}ee((kt,vt)=>{$(zt,kt),$(Qn,(n(M),S(()=>n(M)?.request?.execution_strategy||"dask"))),$(js,vt),$(Ds,(n(M),S(()=>n(M).created_at||"-")))},[()=>(n(M),S(()=>String(n(M).job_id||"").slice(0,12))),()=>(pe(wt),n(M),S(()=>wt(Number(n(M)?.metrics?.wall_time_s))))]),ne("click",Bi,()=>C(n(M).job_id)),I(P,Xe)}),I(f,_)};xe(of,f=>{n(V)?f(lf):(n(X),S(()=>!n(X).length)?f(cf,1):f(uf,!1))})}var Ii=g(Li,4);Lr(Ii,f=>o(ze,f),()=>n(ze));var Oi=g(Ii,4),Yn=g(d(Oi),2),ff=d(Yn);{var df=f=>{var _=Gc();_.value=_.__value="",I(f,_)},vf=f=>{var _=yt(),k=at(_);ct(k,1,()=>n(Y),lt,(P,M,oe)=>{var we=Kc(),Xe=d(we);we.value=we.__value=oe,ee(()=>$(Xe,(n(M),S(()=>n(M).kind==="print"?`print: ${n(M).label}`:`var: ${n(M).label}`)))),I(P,we)}),I(f,_)};xe(ff,f=>{n(Y),S(()=>!n(Y).length)?f(df):f(vf,!1)})}var Fi=g(Oi,2),pf=d(Fi),ji=g(Fi,2);Lr(ji,f=>o(Z,f),()=>n(Z));var Di=g(ji,4),_f=d(Di),zi=g(Di,2),hf=d(zi);{var gf=f=>{var _=Yc();I(f,_)},mf=f=>{var _=yt(),k=at(_);ct(k,1,()=>n(Se),lt,(P,M)=>{var oe=yt(),we=at(oe);{var Xe=dt=>{var zt=Qc(),er=d(zt),tr=d(er),Yr=d(tr),br=g(tr),yr=g(er,2),Qn=d(yr),Fs=g(Qn);{var js=jr=>{var Dr=gl();ee(Ds=>$(Dr,`| ${Ds??""}`),[()=>(n(M),S(()=>String(n(M).error)))]),I(jr,Dr)};xe(Fs,jr=>{n(M),S(()=>n(M).error)&&jr(js)})}ee((jr,Dr)=>{$(Yr,(n(M),S(()=>n(M).status||"unknown"))),$(br,` ${n(M),S(()=>n(M).operator||"-")??""}`),$(Qn,`node=${jr??""} | source=${n(M),S(()=>n(M).cache_source||"-")??""} |
                  duration=${Dr??""} ms `)},[()=>(n(M),S(()=>String(n(M).node_id||"").slice(0,12))),()=>(n(M),S(()=>(Number(n(M).duration_s||0)*1e3).toFixed(2)))]),I(dt,zt)},St=dt=>{var zt=Zc(),er=d(zt),tr=d(er),Yr=g(er,2),br=d(Yr);ee(yr=>{$(tr,(n(M),S(()=>n(M).event||"event"))),$(br,yr)},[()=>(n(M),S(()=>n(M).message||n(M).error||JSON.stringify(n(M)).slice(0,180)))]),I(dt,zt)};xe(we,dt=>{n(M),S(()=>n(M).event==="playground.node")?dt(Xe):dt(St,!1)})}I(P,oe)}),I(f,_)};xe(hf,f=>{n(Se),S(()=>!n(Se).length)?f(gf):f(mf,!1)})}var bf=g(zi,2),yf=d(bf),wf=g(xn,2),qi=d(wf),xf=g(d(qi),2),Sf=d(xf),kf=g(qi,2),Ef=g(d(kf),2),Tf=d(Ef);return ee(()=>{Ye(Xt,1,`panel ${a()?"active":""}`),Kn.disabled=(n(v),S(()=>!n(v).length)),yi.disabled=(n(v),S(()=>!n(v).length)),$(Du,n(m)),$(zu,n(G)),Os.disabled=n(j)!=="running",$(Gu,n(Q)),$(Yu,n(he)),$(Zu,n(Ce)),$(ef,n(Le)),$(rf,n(Pe)),$(af,n(Ee)),Yn.disabled=(n(Y),S(()=>!n(Y).length)),$(pf,n(D)),$(_f,n(Te)),$(yf,n(Ae)),$(Sf,n(Oe)),$(Tf,n(K))}),On(Kn,()=>n(h),f=>o(h,f)),ne("click",yi,Un),ne("click",Ei,yn),ne("click",Os,Ms),ne("click",Ti,As),ne("click",Hu,_r),On(Yn,()=>n(ue),f=>o(ue,f)),ne("change",Yn,Ie),I(e,Xt),Qa(t,"loadProgram",Wn),Qa(t,"runCurrentProgram",Gn),$t(Is)}var tu=J('<div class="inline-error"> </div>'),ru=J('<div class="muted">No stored results found for current runtime.</div>'),nu=J('<article><div class="job-row"><strong> </strong> <span> </span></div> <div class="job-row"><span> </span> <span> </span></div> <div class="job-row"><span> </span> <button class="btn btn-ghost btn-small" type="button">Inspect</button></div></article>'),su=J('<section id="tab-results"><div class="grid-two"><article class="card"><div class="card-header"><h2>Stored Results</h2> <button id="refreshResultsBtn" class="btn btn-ghost btn-small" type="button">Refresh</button></div> <div class="row gap-s controls"><label class="inline-control" for="resultStatusFilter">Status</label> <select id="resultStatusFilter" class="select"><option>all</option><option>materialized</option><option>failed</option></select> <input id="resultSearchInput" class="input" type="search" placeholder="Filter by node id"/></div> <p id="resultListMeta" class="muted"> </p> <!> <div id="resultList" class="job-list"><!></div></article> <article class="card"><h2>Result Inspector</h2> <p class="muted">View values only from persisted store entries. Server-side save/export is intentionally disabled.</p> <div id="resultInspector" class="result-inspector"></div></article></div></section>');function au(e,t){Tt(t,!1);let r=be(t,"active",8,!1),s=be(t,"capabilities",24,()=>({})),a=N(""),i=N(""),l=N([]),c=N(""),u=N(""),v=N(""),h="",m=N(),p=null,w=null;const y=()=>{if(p)return;const V=window.VoxResultViewer?.ResultViewer;if(typeof V=="function"){p=new V(n(m),{onNavigate:G=>{n(v)&&x(n(v),G||"")},fetchPage:({nodeId:G,path:W,offset:ae,limit:Z})=>Ql({nodeId:G||n(v),path:W||"",offset:Number(ae||0),limit:Number(Z||64)}),onStatusClick:G=>{if(!G||G.status!=="failed"&&G.status!=="killed")return;const W=[`node: ${G.node_id||"-"}`,`path: ${G.path||"/"}`,`status: ${G.status||"failed"}`,G.error?`error: ${G.error}`:""].filter(Boolean);p.setError(W.join(`
`))}});return}p={setLoading:G=>{tt(m,n(m).textContent=G||"Loading...")},setError:G=>{tt(m,n(m).textContent=G||"Viewer error")},renderRecord:G=>{tt(m,n(m).textContent=JSON.stringify(G||{},null,2))}}},x=async(V,G="")=>{y(),o(v,V),h=G,p.setLoading(`Loading ${V}${G||""} ...`);try{const W=await Yl(V,G);p.renderRecord(W),o(u,"")}catch(W){p.setError(`Failed loading result ${V}: ${W.message}`)}},b=async()=>{if(y(),s().store_results_viewer===!1){o(l,[]),o(c,"Store results viewer unavailable on this backend."),o(u,""),p.setError("Store results endpoint unavailable.");return}try{const V=await Kl({limit:200,statusFilter:n(a),nodeFilter:n(i).trim()});if(!V.available){o(l,[]),o(c,V.error||"Store results unavailable."),p.setError(V.error||"Store results unavailable.");return}o(l,V.records||[]);const G=V.summary||{};if(o(c,`${Number(G.total||0)} total | ${Number(G.materialized||0)} materialized | ${Number(G.failed||0)} failed`),o(u,""),n(v)&&n(l).some(W=>W.node_id===n(v))){await x(n(v),h);return}n(l).length?await x(n(l)[0].node_id,""):(o(v,""),h="",p.renderRecord(null))}catch(V){o(l,[]),o(c,`Unable to load results: ${V.message}`),o(u,""),p.setError(`Unable to load result list: ${V.message}`)}},E=()=>{w&&clearTimeout(w),w=setTimeout(()=>{b()},260)},F=V=>{V.key==="Enter"&&b()};dr(()=>(y(),b(),()=>{w&&clearTimeout(w),p&&typeof p.destroy=="function"&&p.destroy()})),it(()=>pe(r()),()=>{r()&&b()}),Rr(),Lt();var T=su(),A=d(T),R=d(A),j=d(R),q=g(d(j),2),H=g(j,2),X=g(d(H),2),Q=d(X);Q.value=Q.__value="";var he=g(Q);he.value=he.__value="materialized";var Ce=g(he);Ce.value=Ce.__value="failed";var Le=g(X,2),Pe=g(H,2),Ee=d(Pe),Oe=g(Pe,2);{var K=V=>{var G=tu(),W=d(G);ee(()=>$(W,n(u))),I(V,G)};xe(Oe,V=>{n(u)&&V(K)})}var D=g(Oe,2),Y=d(D);{var ue=V=>{var G=ru();I(V,G)},Te=V=>{var G=yt(),W=at(G);ct(W,1,()=>n(l),lt,(ae,Z)=>{var ze=nu(),ke=d(ze),Fe=d(ke),z=d(Fe),fe=g(Fe,2),le=d(fe),re=g(ke,2),de=d(re),De=d(de),$e=g(de,2),ye=d($e),Ze=g(re,2),ut=d(Ze),He=d(ut),It=g(ut,2);ee((Gt,Je)=>{Ye(ze,1,(n(v),n(Z),S(()=>`job-item result-item ${n(v)===n(Z).node_id?"active":""}`))),$(z,Gt),Ye(fe,1,(n(Z),S(()=>`chip ${n(Z).status}`))),$(le,(n(Z),S(()=>n(Z).status))),$(De,(n(Z),S(()=>n(Z).runtime_version||"-"))),$(ye,Je),$(He,(n(Z),S(()=>n(Z).updated_at||"-")))},[()=>(n(Z),S(()=>n(Z).node_id.slice(0,16))),()=>(pe(Qe),n(Z),S(()=>Qe(Number(n(Z).payload_bytes||0))))]),ne("click",It,()=>x(n(Z).node_id,"")),I(ae,ze)}),I(V,G)};xe(Y,V=>{n(l),S(()=>!n(l).length)?V(ue):V(Te,!1)})}var Ae=g(R,2),Se=g(d(Ae),4);Lr(Se,V=>o(m,V),()=>n(m)),ee(()=>{Ye(T,1,`panel ${r()?"active":""}`),$(Ee,n(c))}),ne("click",q,b),On(X,()=>n(a),V=>o(a,V)),ne("change",X,b),Ya(Le,()=>n(i),V=>o(i,V)),ne("input",Le,E),ne("keydown",Le,F),I(e,T),$t()}var iu=J("<option> </option>"),ou=J('<div class="muted"> </div>'),lu=J('<div class="muted">No examples for selected module.</div>'),cu=J('<article class="gallery-item"><h3> </h3> <div class="gallery-meta"><span class="mini-chip"> </span> <span class="mini-chip"> </span> <span class="mini-chip"> </span></div> <p class="muted"> </p> <pre class="gallery-code"> </pre> <div class="row gap-s"><button class="btn btn-primary btn-small" type="button">Load</button> <button class="btn btn-ghost btn-small" type="button">Run</button></div></article>'),uu=J('<section id="tab-gallery"><article class="card"><div class="card-header"><h2>Progressive Example Gallery</h2> <div class="row gap-s"><label class="inline-control" for="moduleFilter">Module</label> <select id="moduleFilter" class="select"></select></div></div> <p class="muted">Gallery cards are generated from markdown directives in <code>doc/user/language-gallery.md</code> using <code>&lt;!-- vox:playground ... --&gt;</code> comments.</p> <div id="galleryCards" class="gallery-grid"><!></div></article></section>');function fu(e,t){Tt(t,!1);const r=N();let s=be(t,"active",8,!1);const a=ei();let i=N([]),l=N(["all"]),c=N("all"),u=N("");const v=async()=>{try{const j=await Zl();o(i,j.examples||[]),o(l,["all",...j.modules||[]]),n(l).includes(n(c))||o(c,"all"),o(u,"")}catch(j){o(i,[]),o(l,["all"]),o(u,`Unable to load gallery: ${j.message}`)}},h=j=>{a("load",{code:j.code,run:!1})},m=j=>{a("load",{code:j.code,run:!0})};dr(()=>{v()}),it(()=>(n(i),n(c)),()=>{o(r,n(i).filter(j=>n(c)==="all"||j.module===n(c)))}),it(()=>pe(s()),()=>{s()&&v()}),Rr(),Lt();var p=uu(),w=d(p),y=d(w),x=g(d(y),2),b=g(d(x),2);ct(b,5,()=>n(l),lt,(j,q)=>{var H=iu(),X=d(H),Q={};ee(()=>{$(X,n(q)),Q!==(Q=n(q))&&(H.value=(H.__value=n(q))??"")}),I(j,H)});var E=g(y,4),F=d(E);{var T=j=>{var q=ou(),H=d(q);ee(()=>$(H,n(u))),I(j,q)},A=j=>{var q=lu();I(j,q)},R=j=>{var q=yt(),H=at(q);ct(H,1,()=>n(r),lt,(X,Q)=>{var he=cu(),Ce=d(he),Le=d(Ce),Pe=g(Ce,2),Ee=d(Pe),Oe=d(Ee),K=g(Ee,2),D=d(K),Y=g(K,2),ue=d(Y),Te=g(Pe,2),Ae=d(Te),Se=g(Te,2),V=d(Se),G=g(Se,2),W=d(G),ae=g(W,2);ee(()=>{$(Le,(n(Q),S(()=>n(Q).title))),$(Oe,(n(Q),S(()=>n(Q).module))),$(D,(n(Q),S(()=>n(Q).level))),$(ue,(n(Q),S(()=>n(Q).strategy||"dask"))),$(Ae,(n(Q),S(()=>n(Q).description||""))),$(V,(n(Q),S(()=>n(Q).code)))}),ne("click",W,()=>h(n(Q))),ne("click",ae,()=>m(n(Q))),I(X,he)}),I(j,q)};xe(F,j=>{n(u)?j(T):(n(r),S(()=>!n(r).length)?j(A,1):j(R,!1))})}ee(()=>Ye(p,1,`panel ${s()?"active":""}`)),On(b,()=>n(c),j=>o(c,j)),I(e,p),$t()}var du=J('<div class="muted"> </div>'),vu=J('<div class="bar-row"><div class="meta"><span> </span> <strong> </strong></div> <div class="bar-bg"><div class="bar-fill"></div></div></div>');function qn(e,t){Tt(t,!1);const r=N();let s=be(t,"items",24,()=>[]),a=be(t,"valueField",8,"value"),i=be(t,"labelField",8,"label"),l=be(t,"formatter",8,p=>`${p}`),c=be(t,"emptyMessage",8,"No data yet.");it(()=>(pe(s()),pe(a())),()=>{o(r,Math.max(1,...s().map(p=>Number(p?.[a()]||0))))}),Rr(),Lt();var u=yt(),v=at(u);{var h=p=>{var w=du(),y=d(w);ee(()=>$(y,c())),I(p,w)},m=p=>{var w=yt(),y=at(w);ct(y,1,s,lt,(x,b)=>{const E=Ke(()=>(n(b),pe(a()),S(()=>Number(n(b)?.[a()]||0)))),F=Ke(()=>n(E)/n(r)*100);var T=vu(),A=d(T),R=d(A),j=d(R),q=g(R,2),H=d(q),X=g(A,2),Q=d(X);ee((he,Ce)=>{$(j,(n(b),pe(i()),S(()=>n(b)?.[i()]))),$(H,he),Ss(Q,Ce)},[()=>(pe(l()),pe(n(E)),S(()=>l()(n(E)))),()=>(pe(n(F)),S(()=>`width: ${n(F).toFixed(2)}%`))]),I(x,T)}),I(p,w)};xe(v,p=>{pe(s()),S(()=>!s().length)?p(h):p(m,!1)})}I(e,u),$t()}var pu=J('<img id="perfChart" class="perf-chart" alt="Performance comparison chart"/>'),_u=J('<img id="primitivePerfChart" class="perf-chart" alt="Primitive benchmark histogram"/>'),hu=J('<div class="muted"> </div>'),gu=J('<div class="muted"> </div>'),mu=J('<div class="muted">No test jobs started from UI yet.</div>'),bu=J('<button class="btn btn-danger btn-small" type="button">Kill</button>'),yu=J('<article class="job-item"><div class="job-row"><strong> </strong> <span> </span></div> <div class="job-row"><span> </span> <span> </span></div> <div class="job-row"><span> </span> <!></div></article>'),wu=J('<div class="muted">No junit report loaded.</div>'),xu=J('<article class="table-like-row"><div class="name"> </div> <div class="detail"> </div></article>'),Su=J('<div class="muted">No failures in current report.</div>'),ku=J('<article class="table-like-row"><div class="name"> </div> <div class="detail"> </div></article>'),Eu=J('<section id="tab-quality"><div class="grid-two"><article class="card"><div class="card-header"><h2>Test &amp; Coverage Overview</h2> <div class="row gap-s"><button id="refreshQualityBtn" class="btn btn-ghost btn-small" type="button">Refresh</button> <!></div></div> <div class="row controls"><button id="runQuickTestsBtn" class="btn btn-ghost btn-small" type="button">Run Quick</button> <button id="runFullTestsBtn" class="btn btn-primary btn-small" type="button">Run Full</button> <button id="runPerfTestsBtn" class="btn btn-ghost btn-small" type="button">Run Perf</button> <button id="killTestRunBtn" class="btn btn-danger btn-small" type="button">Kill Test Run</button></div> <div class="stats-grid"><div class="stat"><span class="label">Total Tests</span><strong id="qTotalTests"> </strong></div> <div class="stat"><span class="label">Passed</span><strong id="qPassed"> </strong></div> <div class="stat"><span class="label">Failed</span><strong id="qFailed"> </strong></div> <div class="stat"><span class="label">Skipped</span><strong id="qSkipped"> </strong></div> <div class="stat"><span class="label">Duration</span><strong id="qDuration"> </strong></div> <div class="stat"><span class="label">Line Coverage</span><strong id="qCoverage"> </strong></div></div> <h3 class="subheading">Lowest Coverage Packages</h3> <div id="coverageBars" class="bars"><!></div></article> <article class="card"><h2>VoxLogicA-1 vs VoxLogicA-2 Performance</h2> <!> <div id="perfSummary" class="muted"> </div> <h3 class="subheading">Primitive Benchmark Histogram</h3> <!> <div id="primitivePerfBars" class="bars"><!></div></article></div> <div class="grid-two"><article class="card"><h2>Test Run Logs</h2> <pre id="testRunLog" class="mono-scroll"> </pre> <h3 class="subheading">Recent Test Jobs</h3> <div id="recentTestJobs" class="job-list"><!></div></article> <article class="card"><h2>Test Titles</h2> <div id="testTitles" class="table-like muted"><!></div></article></div> <article class="card"><h2>Failing Test Cases</h2> <div id="failedCases" class="table-like muted"><!></div></article></section>');function Tu(e,t){Tt(t,!1);let r=be(t,"active",8,!1),s=be(t,"capabilities",24,()=>({})),a=N("idle"),i=N(!1),l="",c=N(""),u=N([]),v=N(""),h=N({}),m=N({}),p=N([]),w=N([]),y=N([]),x=N("No performance report yet."),b=N(""),E=N(""),F=N([]),T=N("No primitive benchmark report yet."),A=null,R=null;const j=C=>{o(i,!1),o(a,"unavailable"),o(c,C)},q=async()=>{try{const C=await Xl(),se=C?.junit||{},Ie=C?.coverage||{},Me=C?.performance||{};if(o(h,se.summary||{}),o(m,Ie.summary||{}),o(p,Ie.lowest_modules||[]),o(w,se.failed_cases||[]),o(y,se.test_cases||[]),Me.available){const ie=Number(Me.speed_ratio||0),qe=Number(Me.vox1_median_s||0),xt=Number(Me.vox2_median_s||0),jt=Number(Me.vox1_cpu_median_s||0),Qt=Number(Me.vox2_cpu_median_s||0),Dt=Number(Me.vox1_ru_maxrss_delta_median_bytes||0),Or=Number(Me.vox2_ru_maxrss_delta_median_bytes||0);let Fr="";const hr=Me.test_metrics||{};if(hr.available){const mr=hr.tests||[];Fr=` | perf tests: ${Number(hr.count||mr.length)} | median util: ${fi(Ns(mr.map(Zt=>Number(Zt.cpu_utilization))))} | median heap: ${Qe(Ns(mr.map(Zt=>Number(Zt.python_heap_peak_bytes))))} | median rss delta: ${Qe(Ns(mr.map(Zt=>Number(Zt.ru_maxrss_delta_bytes))))}`}o(x,`vox1 median: ${wt(qe)} (cpu ${wt(jt)}, rss ${Qe(Dt)}) | vox2 median: ${wt(xt)} (cpu ${wt(Qt)}, rss ${Qe(Or)}) | ratio vox1/vox2: ${ie.toFixed(2)}x${Fr}`),o(b,`/api/v1/testing/performance/chart?t=${Date.now()}`);const gr=Me.primitive_benchmarks||{};gr.available?(o(F,gr.cases||[]),o(T,""),o(E,gr.svg_available?`/api/v1/testing/performance/primitive-chart?t=${Date.now()}`:"")):(o(F,[]),o(T,gr.reason||"No primitive benchmark report yet."),o(E,""))}else o(x,"No performance report yet. Run `./tests/run-tests.sh` with perf tests enabled."),o(b,""),o(E,""),o(F,[]),o(T,"No primitive benchmark report yet.")}catch(C){o(x,`Failed loading report: ${C.message}`)}},H=async()=>{try{const C=await ec();o(u,C.jobs||[]),o(v,"")}catch(C){o(u,[]),o(v,`Failed to load test jobs: ${C.message}`)}},X=async()=>{if(l)try{const C=await tc(l);if(o(a,C.status),o(c,C.log_tail||""),C.status==="running")return;o(i,!1),R&&(clearInterval(R),R=null),await Promise.all([q(),H()])}catch(C){o(i,!1),o(a,"failed"),o(c,`Unable to poll test job: ${C.message}`),R&&(clearInterval(R),R=null)}},Q=async(C,se)=>{if(s().testing_jobs===!1){j("Testing jobs API unavailable. Restart `./voxlogica serve` from latest code.");return}try{o(i,!0),o(a,"running"),o(c,"");const Ie=await rc({profile:C,includePerf:se});l=Ie.job_id,o(c,Ie.log_tail||""),R&&clearInterval(R),R=setInterval(X,1200),await Promise.all([X(),H()])}catch(Ie){o(i,!1),o(a,"failed"),o(c,`Unable to start test run: ${Ie.message}`)}},he=async()=>{if(l)try{const C=await ii(l);o(i,!1),o(a,C.status),o(c,C.log_tail||""),R&&(clearInterval(R),R=null),await H()}catch(C){o(c,`Unable to kill current test job: ${C.message}`)}},Ce=async C=>{try{await ii(C),l===C&&(l="",o(i,!1),o(a,"killed")),await H()}catch(se){o(v,`Unable to kill ${C}: ${se.message}`)}},Le=()=>{A&&(clearInterval(A),A=null),A=setInterval(()=>{r()&&(q(),H(),X())},15e3)},Pe=async()=>{await Promise.all([q(),H()])};dr(async()=>{await Pe(),Le()}),jn(()=>{A&&clearInterval(A),R&&clearInterval(R)}),it(()=>pe(r()),()=>{r()&&(Pe(),Le())}),it(()=>pe(s()),()=>{s().testing_jobs===!1&&j("This backend does not expose testing jobs. Restart server from latest commit.")}),Rr(),Lt();var Ee=Eu(),Oe=d(Ee),K=d(Oe),D=d(K),Y=g(d(D),2),ue=d(Y),Te=g(ue,2);Rs(Te,{get value(){return n(a)}});var Ae=g(D,2),Se=d(Ae),V=g(Se,2),G=g(V,2),W=g(G,2),ae=g(Ae,2),Z=d(ae),ze=g(d(Z)),ke=d(ze),Fe=g(Z,2),z=g(d(Fe)),fe=d(z),le=g(Fe,2),re=g(d(le)),de=d(re),De=g(le,2),$e=g(d(De)),ye=d($e),Ze=g(De,2),ut=g(d(Ze)),He=d(ut),It=g(Ze,2),Gt=g(d(It)),Je=d(Gt),We=g(ae,4),Ge=d(We);qn(Ge,{get items(){return n(p)},valueField:"line_percent",labelField:"name",formatter:C=>`${Number(C).toFixed(2)}%`});var O=g(K,2),U=g(d(O),2);{var B=C=>{var se=pu();ee(()=>_n(se,"src",n(b))),I(C,se)};xe(U,C=>{n(b)&&C(B)})}var te=g(U,2),ge=d(te),ft=g(te,4);{var Ir=C=>{var se=_u();ee(()=>_n(se,"src",n(E))),I(C,se)};xe(ft,C=>{n(E)&&C(Ir)})}var vr=g(ft,2),Bn=d(vr);{var Kt=C=>{qn(C,{get items(){return n(F)},valueField:"speed_ratio",labelField:"name",formatter:se=>`${Number(se).toFixed(3)}x`})},Ot=C=>{var se=hu(),Ie=d(se);ee(()=>$(Ie,n(T))),I(C,se)};xe(Bn,C=>{n(F),S(()=>n(F).length)?C(Kt):C(Ot,!1)})}var pr=g(Oe,2),Gr=d(pr),hn=g(d(Gr),2),Yt=d(hn),Vn=g(hn,4),Cs=d(Vn);{var Un=C=>{var se=gu(),Ie=d(se);ee(()=>$(Ie,n(v))),I(C,se)},Ft=C=>{var se=mu();I(C,se)},Ps=C=>{var se=yt(),Ie=at(se);ct(Ie,1,()=>n(u),lt,(Me,ie)=>{var qe=yu(),xt=d(qe),jt=d(xt),Qt=d(jt),Dt=g(jt,2),Or=d(Dt),Fr=g(xt,2),hr=d(Fr),gr=d(hr),mr=g(hr,2),Zt=d(mr),Ls=g(Fr,2),wn=d(Ls),Wn=d(wn),Gn=g(wn,2);{var Is=Xt=>{var xn=bu();ne("click",xn,()=>Ce(n(ie).job_id)),I(Xt,xn)};xe(Gn,Xt=>{n(ie),S(()=>n(ie).status==="running")&&Xt(Is)})}ee(Xt=>{$(Qt,Xt),Ye(Dt,1,(n(ie),S(()=>`chip ${n(ie).status}`))),$(Or,(n(ie),S(()=>n(ie).status))),$(gr,(n(ie),S(()=>n(ie).profile))),$(Zt,(n(ie),S(()=>n(ie).include_perf?"with perf":"no perf"))),$(Wn,(n(ie),S(()=>n(ie).created_at||"-")))},[()=>(n(ie),S(()=>String(n(ie).job_id||"").slice(0,12)))]),I(Me,qe)}),I(C,se)};xe(Cs,C=>{n(v)?C(Un):(n(u),S(()=>!n(u).length)?C(Ft,1):C(Ps,!1))})}var Jn=g(Gr,2),gn=g(d(Jn),2),Hn=d(gn);{var Kr=C=>{var se=wu();I(C,se)},_r=C=>{var se=yt(),Ie=at(se);ct(Ie,1,()=>(n(y),S(()=>n(y).slice(0,200))),lt,(Me,ie)=>{var qe=xu(),xt=d(qe),jt=d(xt),Qt=g(xt,2),Dt=d(Qt);ee(Or=>{$(jt,(n(ie),S(()=>n(ie).id))),$(Dt,`status=${n(ie),S(()=>n(ie).status)??""} | time=${Or??""}`)},[()=>(pe(wt),n(ie),S(()=>wt(Number(n(ie).time_s||0))))]),I(Me,qe)}),I(C,se)};xe(Hn,C=>{n(y),S(()=>!n(y).length)?C(Kr):C(_r,!1)})}var mn=g(pr,2),bn=g(d(mn),2),yn=d(bn);{var As=C=>{var se=Su();I(C,se)},Ms=C=>{var se=yt(),Ie=at(se);ct(Ie,1,()=>n(w),lt,(Me,ie)=>{var qe=ku(),xt=d(qe),jt=d(xt),Qt=g(xt,2),Dt=d(Qt);ee(()=>{$(jt,(n(ie),S(()=>n(ie).id))),$(Dt,(n(ie),S(()=>n(ie).message||"Failure without message")))}),I(Me,qe)}),I(C,se)};xe(yn,C=>{n(w),S(()=>!n(w).length)?C(As):C(Ms,!1)})}ee((C,se,Ie,Me,ie,qe)=>{Ye(Ee,1,`panel ${r()?"active":""}`),Se.disabled=(n(i),pe(s()),S(()=>n(i)||s().testing_jobs===!1)),V.disabled=(n(i),pe(s()),S(()=>n(i)||s().testing_jobs===!1)),G.disabled=(n(i),pe(s()),S(()=>n(i)||s().testing_jobs===!1)),W.disabled=!n(i),$(ke,C),$(fe,se),$(de,Ie),$(ye,Me),$(He,ie),$(Je,`${qe??""}%`),$(ge,n(x)),$(Yt,n(c))},[()=>(n(h),S(()=>Number(n(h).total||0))),()=>(n(h),S(()=>Number(n(h).passed||0))),()=>(n(h),S(()=>Number(n(h).failed||0))),()=>(n(h),S(()=>Number(n(h).skipped||0))),()=>(pe(wt),n(h),S(()=>wt(Number(n(h).duration_s||0)))),()=>(n(m),S(()=>Number(n(m).line_percent||0).toFixed(2)))]),ne("click",ue,Pe),ne("click",Se,()=>Q("quick",!1)),ne("click",V,()=>Q("full",!0)),ne("click",G,()=>Q("perf",!0)),ne("click",W,he),I(e,Ee),$t()}var $u=J('<div class="inline-error"> </div>'),Nu=J('<section id="tab-storage"><div class="grid-two"><article class="card"><div class="card-header"><h2>Cache Footprint</h2> <button id="refreshStorageBtn" class="btn btn-ghost btn-small" type="button">Refresh</button></div> <div class="stats-grid"><div class="stat"><span class="label">Cached Records</span> <strong id="sTotal"> </strong></div> <div class="stat"><span class="label">Materialized</span> <strong id="sMaterialized"> </strong></div> <div class="stat"><span class="label">Failed</span> <strong id="sFailed"> </strong></div> <div class="stat"><span class="label">Average Payload</span> <strong id="sAvgPayload"> </strong></div> <div class="stat"><span class="label">Total Payload</span> <strong id="sTotalPayload"> </strong></div> <div class="stat"><span class="label">Database Size</span> <strong id="sDbSize"> </strong></div></div> <p id="storageMeta" class="muted"> </p> <!></article> <article class="card"><h2>Payload Size Distribution</h2> <div id="payloadBuckets" class="bars"><!></div> <h3 class="subheading">Runtime Versions</h3> <div id="runtimeVersions" class="bars"><!></div></article></div></section>');function Ru(e,t){Tt(t,!1);let r=be(t,"active",8,!1),s=N(null),a=N(null),i=N(null),l=N(""),c=N("");const u=async()=>{try{const W=await nc();if(o(s,W),!W.available){o(c,W.error||"Storage stats unavailable."),o(l,n(c)),o(a,null),o(i,null);return}o(c,""),o(a,W.summary||{}),o(i,W.disk||{}),o(l,`${W.db_path} | last update ${n(a).last_update_at||"-"}`)}catch(W){o(c,`Failed loading storage stats: ${W.message}`),o(l,n(c)),o(a,null),o(i,null)}};dr(()=>{u()}),it(()=>pe(r()),()=>{r()&&u()}),Rr(),Lt();var v=Nu(),h=d(v),m=d(h),p=d(m),w=g(d(p),2),y=g(p,2),x=d(y),b=g(d(x),2),E=d(b),F=g(x,2),T=g(d(F),2),A=d(T),R=g(F,2),j=g(d(R),2),q=d(j),H=g(R,2),X=g(d(H),2),Q=d(X),he=g(H,2),Ce=g(d(he),2),Le=d(Ce),Pe=g(he,2),Ee=g(d(Pe),2),Oe=d(Ee),K=g(y,2),D=d(K),Y=g(K,2);{var ue=W=>{var ae=$u(),Z=d(ae);ee(()=>$(Z,n(c))),I(W,ae)};xe(Y,W=>{n(c)&&W(ue)})}var Te=g(m,2),Ae=g(d(Te),2),Se=d(Ae);{let W=Ke(()=>(n(s),S(()=>n(s)?.payload_buckets||[])));qn(Se,{get items(){return n(W)},valueField:"count",labelField:"bucket",formatter:ae=>`${ae}`})}var V=g(Ae,4),G=d(V);{let W=Ke(()=>(n(s),S(()=>n(s)?.runtime_versions||[])));qn(G,{get items(){return n(W)},valueField:"count",labelField:"runtime_version",formatter:ae=>`${ae}`})}ee((W,ae,Z,ze,ke,Fe)=>{Ye(v,1,`panel ${r()?"active":""}`),$(E,W),$(A,ae),$(q,Z),$(Q,ze),$(Le,ke),$(Oe,Fe),$(D,n(l))},[()=>(n(a),S(()=>n(a)?Number(n(a).total_records||0):"-")),()=>(n(a),S(()=>n(a)?Number(n(a).materialized_records||0):"-")),()=>(n(a),S(()=>n(a)?Number(n(a).failed_records||0):"-")),()=>(n(a),pe(Qe),S(()=>n(a)?Qe(Number(n(a).avg_payload_bytes||0)):"-")),()=>(n(a),pe(Qe),S(()=>n(a)?Qe(Number(n(a).total_payload_bytes||0)):"-")),()=>(n(i),pe(Qe),S(()=>n(i)?Qe(Number(n(i).db_bytes||0)+Number(n(i).wal_bytes||0)):"-"))]),ne("click",w,u),I(e,v),$t()}var Cu=J('<button type="button"> </button>'),Pu=J('<div class="background-layer"></div> <div class="shell"><header class="topbar"><div><p class="eyebrow">VoxLogicA Serve</p> <h1>VoxLogicA Studio Console</h1></div> <div class="topbar-meta"><span id="buildStamp" class="chip"> </span></div></header> <nav class="tabbar" aria-label="Main pages"></nav> <main class="content"><!> <!> <!> <!> <!> <!></main></div>',1);function Au(e,t){Tt(t,!1);const r=[{id:"start",label:"Start"},{id:"playground",label:"Playground"},{id:"results",label:"Results Explorer"},{id:"gallery",label:"Example Gallery"},{id:"quality",label:"Test Intelligence"},{id:"storage",label:"Storage Stats"}];let s=N("start"),a=N({}),i=N("Loading..."),l=!1,c=[],u=null,v=!1;const h=300,m=40;let p=N();const w=K=>K.map(D=>{if(D instanceof Error)return D.stack||D.message||String(D);if(typeof D=="string")return D;try{return JSON.stringify(D)}catch{return String(D)}}).join(" "),y=async()=>{if(v||!c.length)return;v=!0;const K=c.splice(0,m);try{await Ul(K)}catch{c=[...K,...c].slice(-h)}finally{v=!1,c.length&&(u&&clearTimeout(u),u=setTimeout(y,800))}},x=(K,D,Y=null)=>{c.push({level:K,message:w(D),source:"browser-console",url:window.location.href,ts:new Date().toISOString(),user_agent:navigator.userAgent,payload:Y}),c.length>h&&(c=c.slice(-h)),u&&clearTimeout(u),u=setTimeout(y,250)},b=()=>{if(l||typeof window>"u"||typeof window.WebSocket>"u")return;l=!0;const K=["log","info","warn","error","debug"];for(const D of K){const Y=console[D]?console[D].bind(console):console.log.bind(console);console[D]=(...ue)=>{Y(...ue),x(D,ue)}}window.addEventListener("error",D=>{x("error",[D.message||"window error"],{filename:D.filename,lineno:D.lineno,colno:D.colno})}),window.addEventListener("unhandledrejection",D=>{const Y=D.reason;x("error",["unhandledrejection",Y instanceof Error?Y.stack||Y.message:Y],null)})},E=()=>{const K=window.location.protocol==="https:"?"wss":"ws",D=new WebSocket(`${K}://${window.location.host}/livereload`);D.onmessage=Y=>{Y.data==="reload"&&window.location.reload()},D.onclose=()=>{setTimeout(E,2e3)}},F=async K=>{const D=String(K.detail?.code||""),Y=!!K.detail?.run;o(s,"playground"),n(p)&&typeof n(p).loadProgram=="function"&&await n(p).loadProgram(D,Y)};dr(async()=>{b();try{const[K,D]=await Promise.all([Bl(),Vl()]);o(a,K||{}),o(i,`v${D.version||"unknown"}`)}catch{o(i,"version unavailable")}E()}),Lt();var T=Pu(),A=g(at(T),2),R=d(A),j=g(d(R),2),q=d(j),H=d(q),X=g(R,2);ct(X,5,()=>r,lt,(K,D)=>{var Y=Cu(),ue=d(Y);ee(Te=>{Ye(Y,1,Te),$(ue,n(D).label)},[()=>Wa(`tab ${n(s)===n(D).id?"active":""}`.trim())]),ne("click",Y,()=>o(s,n(D).id)),I(K,Y)});var Q=g(X,2),he=d(Q);{let K=Ke(()=>n(s)==="start");Oc(he,{get active(){return n(K)},get capabilities(){return n(a)}})}var Ce=g(he,2);{let K=Ke(()=>n(s)==="playground");Lr(eu(Ce,{get active(){return n(K)},get capabilities(){return n(a)},$$legacy:!0}),D=>o(p,D),()=>n(p))}var Le=g(Ce,2);{let K=Ke(()=>n(s)==="results");au(Le,{get active(){return n(K)},get capabilities(){return n(a)}})}var Pe=g(Le,2);{let K=Ke(()=>n(s)==="gallery");fu(Pe,{get active(){return n(K)},$$events:{load:F}})}var Ee=g(Pe,2);{let K=Ke(()=>n(s)==="quality");Tu(Ee,{get active(){return n(K)},get capabilities(){return n(a)}})}var Oe=g(Ee,2);{let K=Ke(()=>n(s)==="storage");Ru(Oe,{get active(){return n(K)}})}ee(()=>$(H,n(i))),I(e,T),$t()}const pi=document.getElementById("app");if(!(pi instanceof HTMLElement))throw new Error("Missing #app root element.");ml(Au,{target:pi})})();
