#!/bin/bash
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VENV_DIR="$SCRIPT_DIR/.venv"

python3 "$SCRIPT_DIR/bootstrap.py"

if [ -x "$VENV_DIR/bin/python" ]; then
  VENV_PY="$VENV_DIR/bin/python"
elif [ -x "$VENV_DIR/Scripts/python.exe" ]; then
  VENV_PY="$VENV_DIR/Scripts/python.exe"
else
  echo "Virtualenv python not found under $VENV_DIR" >&2
  exit 1
fi

export PYTHONPATH="$SCRIPT_DIR/implementation/python"
exec "$VENV_PY" -m voxlogica.main "$@"
