#!/bin/bash

# VoxLogicA wrapper script
# This script activates the virtual environment and runs the voxlogica command

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Ensure the virtual environment exists
if [ ! -d "$SCRIPT_DIR/.venv" ]; then
	echo "Virtualenv not found, running bootstrap..."
	python3 "$SCRIPT_DIR/bootstrap.py"
fi

# Activate the virtual environment
source "$SCRIPT_DIR/.venv/bin/activate"

# Set implementation/python as PYTHONPATH so the voxlogica package is always found
export PYTHONPATH="$SCRIPT_DIR/implementation/python"

# Run the Python VoxLogicA main module with all passed arguments
exec "$SCRIPT_DIR/.venv/bin/python" -m voxlogica.main "$@"